{"version":3,"file":"app.js","sources":["../../bower_components/lodash/dist/lodash.underscore.js","../../bower_components/backbone/backbone.js","../../bower_components/backbone-forms/distribution/backbone-forms.js","../../_scripts/models/location.js","../../_scripts/models/request.js","../../_scripts/models/role.js","../../_scripts/models/type.js","../../_scripts/models/user.js","../../_scripts/collections/locations.js","../../_scripts/collections/requests.js","../../_scripts/collections/roles.js","../../_scripts/collections/types.js","../../_scripts/views/login.js","../../_scripts/views/monitor.js","../../_scripts/views/profileform.js","../../_scripts/views/request.js","../../_scripts/init.js","../../_scripts/routes.js"],"names":["baseIndexOf","array","value","fromIndex","index","length","compareAscending","a","b","ac","criteria","bc","other","escapeStringChar","match","stringEscapes","slice","start","end","result","Array","lodash","lodashWrapper","chainAll","this","__chain__","__wrapped__","baseBind","bindData","bound","partialArgs","args","push","apply","arguments","thisBinding","baseCreate","func","prototype","isObject","thisArg","nativeCreate","baseCreateCallback","argCount","identity","call","collection","accumulator","bind","baseCreateWrapper","isBind","partialRightArgs","isCurry","arity","bitmask","isCurryBound","isBindKey","key","baseDifference","values","indexOf","getIndexOf","baseFlatten","isShallow","isStrict","isArray","isArguments","valIndex","valLength","resIndex","baseIsEqual","stackA","stackB","type","otherType","objectTypes","className","toString","otherClass","boolClass","dateClass","numberClass","regexpClass","stringClass","String","isArr","arrayClass","aWrapped","bWrapped","objectClass","ctorA","constructor","ctorB","isFunction","size","forIn","hasOwnProperty","indicatorObject","pop","baseRandom","min","max","floor","nativeRandom","baseUniq","isSorted","callback","seen","computed","createAggregator","setter","createCallback","forOwn","createWrapper","isPartial","isPartialRight","TypeError","creater","escapeHtmlChar","htmlEscapes","isNative","reNative","test","unescapeHtmlChar","htmlUnescapes","argsClass","assign","object","argsIndex","argsLength","iterable","clone","defaults","functions","sort","has","invert","props","keys","isBoolean","isDate","isElement","nodeType","isEmpty","isString","isEqual","isFinite","nativeIsFinite","nativeIsNaN","parseFloat","isNaN","isNumber","isNull","isRegExp","isUndefined","omit","pairs","pick","contains","target","every","filter","find","findWhere","properties","where","forEach","forEachRight","invoke","methodName","isFunc","map","Infinity","current","reduce","noaccum","reduceRight","reject","sample","n","guard","undefined","shuffle","nativeMin","nativeMax","rand","some","sortBy","toArray","first","compact","difference","flatten","sortedIndex","initial","intersection","outer","last","lastIndexOf","range","step","ceil","rest","low","high","mid","union","uniq","without","zip","pluck","zipObject","after","bindAll","funcs","compose","debounce","wait","options","maxTimeoutId","stamp","timeoutId","trailingCall","lastCalled","maxWait","trailing","leading","delayed","remaining","now","clearTimeout","isCalled","setTimeout","maxDelayed","leadingCall","defer","delay","memoize","resolver","cache","keyPrefix","once","ran","partial","throttle","wrap","wrapper","property","escape","string","replace","reUnescapedHtml","mixin","noConflict","root","_","oldDash","random","template","text","data","settings","templateSettings","source","variable","reDelimiters","RegExp","reNoMatch","interpolate","evaluate","escapeValue","interpolateValue","evaluateValue","offset","reUnescapedString","Function","e","times","unescape","reEscapedHtml","uniqueId","prefix","id","idCounter","chain","tap","interceptor","wrapperChain","wrapperValueOf","Date","reInterpolate","funcClass","boolean","function","number","\\","'","\n","\r","\t"," "," ","window","freeExports","exports","freeModule","module","moduleExports","freeGlobal","global","arrayRef","objectProto","Object","Math","propertyIsEnumerable","create","nativeIsArray","nativeKeys","support","0","spliceObjects","splice","shimKeys","&","<",">","\"","join","countBy","groupBy","indexBy","getTime","collect","drop","each","extend","methods","select","tail","unique","all","any","detect","foldl","foldr","include","inject","take","head","VERSION","define","amd","factory","$","Backbone","require","jQuery","Zepto","ender","previousBackbone","emulateHTTP","emulateJSON","Events","on","name","context","eventsApi","_events","events","ctx","self","off","_callback","retain","ev","names","i","l","j","k","trigger","allEvents","triggerEvents","stopListening","obj","listeningTo","_listeningTo","remove","_listenId","eventSplitter","action","concat","split","a1","a2","a3","listenMethods","listenTo","listenToOnce","implementation","method","unbind","Model","attributes","attrs","cid","parse","set","changed","initialize","validationError","idAttribute","toJSON","sync","get","attr","val","unset","changes","silent","changing","prev","_validate","_changing","_previousAttributes","_pending","clear","hasChanged","changedAttributes","diff","old","previous","previousAttributes","fetch","model","success","resp","wrapError","save","xhr","validate","serverAttrs","isNew","patch","destroy","url","base","urlError","encodeURIComponent","isValid","error","modelMethods","unshift","Collection","models","comparator","_reset","reset","setOptions","add","merge","addOptions","singular","_byId","_removeReference","existing","at","targetModel","sortable","sortAttr","toAdd","toRemove","modelMap","order","_prepareModel","_addReference","orderedModels","previousModels","shift","Error","_onModelEvent","event","attributeMethods","iterator","View","viewOptions","_ensureElement","delegateEvents","delegateEventSplitter","tagName","selector","$el","render","setElement","element","delegate","undelegateEvents","el","eventName","methodMap","params","dataType","contentType","JSON","stringify","_method","beforeSend","setRequestHeader","processData","noXhrPatch","ActiveXObject","ajax","XMLHttpRequest","dispatchEvent","update","delete","read","Router","routes","_bindRoutes","optionalParam","namedParam","splatParam","escapeRegExp","route","_routeToRegExp","router","history","fragment","_extractParameters","execute","navigate","optional","exec","param","decodeURIComponent","History","handlers","location","routeStripper","rootStripper","isExplorer","trailingSlash","pathStripper","started","interval","atRoot","pathname","getHash","href","getFragment","forcePushState","_hasPushState","_wantsHashChange","decodeURI","search","hashChange","_wantsPushState","pushState","docMode","document","documentMode","oldIE","navigator","userAgent","toLowerCase","frame","iframe","hide","appendTo","contentWindow","checkUrl","_checkUrlInterval","setInterval","loc","hash","replaceState","title","loadUrl","stop","clearInterval","handler","_updateHash","open","close","protoProps","staticProps","child","parent","Surrogate","__super__","Form","schema","Fieldset","Field","NestedField","selectedFields","fields","fieldSchema","createField","fieldsetSchema","fieldsets","itemSchema","createFieldset","form","idPrefix","field","editor","handleEditorEvent","formEvent","hasFocus","focusedField","$form","trim","$container","selection","append","fieldset","addClass","errors","skipModelValidate","modelErrors","getValue","isDictionary","_others","setError","tmpErr","commit","validateOptions","modelError","setValue","prop","getEditor","focus","getFieldAt","blur","editors","validators","errMessages","required","regexp","email","message","err","createSchema","legend","templateData","$fieldset","errorClassName","createEditor","createTitle","createEditorId","constructorFn","str","toUpperCase","help","fieldAttrs","editorAttrs","editorId","Hidden","$field","fieldClass","clearError","msg","hasNestedForm","html","removeClass","empty","Editor","Base","defaultValue","getName","editorClass","formValues","getValidator","validator","config","Text","previousValue","keyup","keypress","determineChange","currentValue","TextArea","Password","Number","change","onKeyPress","delayedDetermineChange","charCode","newVal","fromCharCode","numeric","preventDefault","Checkbox","click","Select","renderOptions","$select","_getOptionsHtml","_arrayToHtml","_collectionToHtml","newOptions","opts","_objectToHtml","label","option","group","Radio","change input[type=radio]","focus input[type=radio]","blur input[type=radio]","checked","itemHtml","Checkboxes","groupNumber","click input[type=checkbox]","focus input[type=checkbox]","blur input[type=checkbox]","originalId","subSchema","NestedForm","nestedForm","_observeFormEvents","NestedModel","nestedModel","modelInstance","fieldTemplate","change select","updateHidden","focus select","blur select","Self","today","monthNames","showMonthNames","yearStart","getFullYear","yearEnd","date","setSeconds","setMilliseconds","datesOptions","monthsOptions","month","yearRange","yearsOptions","year","dates","months","years","$date","$month","$year","$hidden","getDate","getMonth","toISOString","DateTime","DateEditor","minsInterval","dateEditor","pad","hoursOptions","hour","minsOptions","hours","mins","$hour","$min","setHours","setMinutes","getHours","getMinutes","Location","Request","types","Types","locations","Locations","description","urgent","false","true","created","Role","Type","User","username","urlRoot","synced","asapp","redirect","isSynced","login","console","Requests","view","MonitorView","Roles","LoginView","user","submit","ProfileView","log","RequestView","page","pagecontainer","requests","login.html","request.html","monitor.html","settings.html","request","monitor"],"mappings":"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","sourcesContent":["/**\n * @license\n * Lo-Dash 2.4.1 (Custom Build) <http://lodash.com/>\n * Build: `lodash underscore exports=\"amd,commonjs,global,node\" -o ./dist/lodash.underscore.js`\n * Copyright 2012-2013 The Dojo Foundation <http://dojofoundation.org/>\n * Based on Underscore.js 1.5.2 <http://underscorejs.org/LICENSE>\n * Copyright 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n * Available under MIT license <http://lodash.com/license>\n */\n;(function() {\n\n  /** Used as a safe reference for `undefined` in pre ES5 environments */\n  var undefined;\n\n  /** Used to generate unique IDs */\n  var idCounter = 0;\n\n  /** Used internally to indicate various things */\n  var indicatorObject = {};\n\n  /** Used to prefix keys to avoid issues with `__proto__` and properties on `Object.prototype` */\n  var keyPrefix = +new Date + '';\n\n  /** Used to match \"interpolate\" template delimiters */\n  var reInterpolate = /<%=([\\s\\S]+?)%>/g;\n\n  /** Used to ensure capturing order of template delimiters */\n  var reNoMatch = /($^)/;\n\n  /** Used to match unescaped characters in compiled string literals */\n  var reUnescapedString = /['\\n\\r\\t\\u2028\\u2029\\\\]/g;\n\n  /** `Object#toString` result shortcuts */\n  var argsClass = '[object Arguments]',\n      arrayClass = '[object Array]',\n      boolClass = '[object Boolean]',\n      dateClass = '[object Date]',\n      funcClass = '[object Function]',\n      numberClass = '[object Number]',\n      objectClass = '[object Object]',\n      regexpClass = '[object RegExp]',\n      stringClass = '[object String]';\n\n  /** Used to determine if values are of the language type Object */\n  var objectTypes = {\n    'boolean': false,\n    'function': true,\n    'object': true,\n    'number': false,\n    'string': false,\n    'undefined': false\n  };\n\n  /** Used to escape characters for inclusion in compiled string literals */\n  var stringEscapes = {\n    '\\\\': '\\\\',\n    \"'\": \"'\",\n    '\\n': 'n',\n    '\\r': 'r',\n    '\\t': 't',\n    '\\u2028': 'u2028',\n    '\\u2029': 'u2029'\n  };\n\n  /** Used as a reference to the global object */\n  var root = (objectTypes[typeof window] && window) || this;\n\n  /** Detect free variable `exports` */\n  var freeExports = objectTypes[typeof exports] && exports && !exports.nodeType && exports;\n\n  /** Detect free variable `module` */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect the popular CommonJS extension `module.exports` */\n  var moduleExports = freeModule && freeModule.exports === freeExports && freeExports;\n\n  /** Detect free variable `global` from Node.js or Browserified code and use it as `root` */\n  var freeGlobal = objectTypes[typeof global] && global;\n  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal)) {\n    root = freeGlobal;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * The base implementation of `_.indexOf` without support for binary searches\n   * or `fromIndex` constraints.\n   *\n   * @private\n   * @param {Array} array The array to search.\n   * @param {*} value The value to search for.\n   * @param {number} [fromIndex=0] The index to search from.\n   * @returns {number} Returns the index of the matched value or `-1`.\n   */\n  function baseIndexOf(array, value, fromIndex) {\n    var index = (fromIndex || 0) - 1,\n        length = array ? array.length : 0;\n\n    while (++index < length) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Used by `sortBy` to compare transformed `collection` elements, stable sorting\n   * them in ascending order.\n   *\n   * @private\n   * @param {Object} a The object to compare to `b`.\n   * @param {Object} b The object to compare to `a`.\n   * @returns {number} Returns the sort order indicator of `1` or `-1`.\n   */\n  function compareAscending(a, b) {\n    var ac = a.criteria,\n        bc = b.criteria,\n        index = -1,\n        length = ac.length;\n\n    while (++index < length) {\n      var value = ac[index],\n          other = bc[index];\n\n      if (value !== other) {\n        if (value > other || typeof value == 'undefined') {\n          return 1;\n        }\n        if (value < other || typeof other == 'undefined') {\n          return -1;\n        }\n      }\n    }\n    // Fixes an `Array#sort` bug in the JS engine embedded in Adobe applications\n    // that causes it, under certain circumstances, to return the same value for\n    // `a` and `b`. See https://github.com/jashkenas/underscore/pull/1247\n    //\n    // This also ensures a stable sort in V8 and other engines.\n    // See http://code.google.com/p/v8/issues/detail?id=90\n    return a.index - b.index;\n  }\n\n  /**\n   * Used by `template` to escape characters for inclusion in compiled\n   * string literals.\n   *\n   * @private\n   * @param {string} match The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeStringChar(match) {\n    return '\\\\' + stringEscapes[match];\n  }\n\n  /**\n   * Slices the `collection` from the `start` index up to, but not including,\n   * the `end` index.\n   *\n   * Note: This function is used instead of `Array#slice` to support node lists\n   * in IE < 9 and to ensure dense arrays are returned.\n   *\n   * @private\n   * @param {Array|Object|string} collection The collection to slice.\n   * @param {number} start The start index.\n   * @param {number} end The end index.\n   * @returns {Array} Returns the new array.\n   */\n  function slice(array, start, end) {\n    start || (start = 0);\n    if (typeof end == 'undefined') {\n      end = array ? array.length : 0;\n    }\n    var index = -1,\n        length = end - start || 0,\n        result = Array(length < 0 ? 0 : length);\n\n    while (++index < length) {\n      result[index] = array[start + index];\n    }\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Used for `Array` method references.\n   *\n   * Normally `Array.prototype` would suffice, however, using an array literal\n   * avoids issues in Narwhal.\n   */\n  var arrayRef = [];\n\n  /** Used for native method references */\n  var objectProto = Object.prototype;\n\n  /** Used to restore the original `_` reference in `noConflict` */\n  var oldDash = root._;\n\n  /** Used to resolve the internal [[Class]] of values */\n  var toString = objectProto.toString;\n\n  /** Used to detect if a method is native */\n  var reNative = RegExp('^' +\n    String(toString)\n      .replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&')\n      .replace(/toString| for [^\\]]+/g, '.*?') + '$'\n  );\n\n  /** Native method shortcuts */\n  var ceil = Math.ceil,\n      floor = Math.floor,\n      hasOwnProperty = objectProto.hasOwnProperty,\n      push = arrayRef.push,\n      propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n  /* Native method shortcuts for methods with the same name as other `lodash` methods */\n  var nativeCreate = isNative(nativeCreate = Object.create) && nativeCreate,\n      nativeIsArray = isNative(nativeIsArray = Array.isArray) && nativeIsArray,\n      nativeIsFinite = root.isFinite,\n      nativeIsNaN = root.isNaN,\n      nativeKeys = isNative(nativeKeys = Object.keys) && nativeKeys,\n      nativeMax = Math.max,\n      nativeMin = Math.min,\n      nativeRandom = Math.random;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates a `lodash` object which wraps the given value to enable intuitive\n   * method chaining.\n   *\n   * In addition to Lo-Dash methods, wrappers also have the following `Array` methods:\n   * `concat`, `join`, `pop`, `push`, `reverse`, `shift`, `slice`, `sort`, `splice`,\n   * and `unshift`\n   *\n   * Chaining is supported in custom builds as long as the `value` method is\n   * implicitly or explicitly included in the build.\n   *\n   * The chainable wrapper functions are:\n   * `after`, `assign`, `bind`, `bindAll`, `bindKey`, `chain`, `compact`,\n   * `compose`, `concat`, `countBy`, `create`, `createCallback`, `curry`,\n   * `debounce`, `defaults`, `defer`, `delay`, `difference`, `filter`, `flatten`,\n   * `forEach`, `forEachRight`, `forIn`, `forInRight`, `forOwn`, `forOwnRight`,\n   * `functions`, `groupBy`, `indexBy`, `initial`, `intersection`, `invert`,\n   * `invoke`, `keys`, `map`, `max`, `memoize`, `merge`, `min`, `object`, `omit`,\n   * `once`, `pairs`, `partial`, `partialRight`, `pick`, `pluck`, `pull`, `push`,\n   * `range`, `reject`, `remove`, `rest`, `reverse`, `shuffle`, `slice`, `sort`,\n   * `sortBy`, `splice`, `tap`, `throttle`, `times`, `toArray`, `transform`,\n   * `union`, `uniq`, `unshift`, `unzip`, `values`, `where`, `without`, `wrap`,\n   * and `zip`\n   *\n   * The non-chainable wrapper functions are:\n   * `clone`, `cloneDeep`, `contains`, `escape`, `every`, `find`, `findIndex`,\n   * `findKey`, `findLast`, `findLastIndex`, `findLastKey`, `has`, `identity`,\n   * `indexOf`, `isArguments`, `isArray`, `isBoolean`, `isDate`, `isElement`,\n   * `isEmpty`, `isEqual`, `isFinite`, `isFunction`, `isNaN`, `isNull`, `isNumber`,\n   * `isObject`, `isPlainObject`, `isRegExp`, `isString`, `isUndefined`, `join`,\n   * `lastIndexOf`, `mixin`, `noConflict`, `parseInt`, `pop`, `random`, `reduce`,\n   * `reduceRight`, `result`, `shift`, `size`, `some`, `sortedIndex`, `runInContext`,\n   * `template`, `unescape`, `uniqueId`, and `value`\n   *\n   * The wrapper functions `first` and `last` return wrapped values when `n` is\n   * provided, otherwise they return unwrapped values.\n   *\n   * Explicit chaining can be enabled by using the `_.chain` method.\n   *\n   * @name _\n   * @constructor\n   * @category Chaining\n   * @param {*} value The value to wrap in a `lodash` instance.\n   * @returns {Object} Returns a `lodash` instance.\n   * @example\n   *\n   * var wrapped = _([1, 2, 3]);\n   *\n   * // returns an unwrapped value\n   * wrapped.reduce(function(sum, num) {\n   *   return sum + num;\n   * });\n   * // => 6\n   *\n   * // returns a wrapped value\n   * var squares = wrapped.map(function(num) {\n   *   return num * num;\n   * });\n   *\n   * _.isArray(squares);\n   * // => false\n   *\n   * _.isArray(squares.value());\n   * // => true\n   */\n  function lodash(value) {\n    return (value instanceof lodash)\n      ? value\n      : new lodashWrapper(value);\n  }\n\n  /**\n   * A fast path for creating `lodash` wrapper objects.\n   *\n   * @private\n   * @param {*} value The value to wrap in a `lodash` instance.\n   * @param {boolean} chainAll A flag to enable chaining for all methods\n   * @returns {Object} Returns a `lodash` instance.\n   */\n  function lodashWrapper(value, chainAll) {\n    this.__chain__ = !!chainAll;\n    this.__wrapped__ = value;\n  }\n  // ensure `new lodashWrapper` is an instance of `lodash`\n  lodashWrapper.prototype = lodash.prototype;\n\n  /**\n   * An object used to flag environments features.\n   *\n   * @static\n   * @memberOf _\n   * @type Object\n   */\n  var support = {};\n\n  (function() {\n    var object = { '0': 1, 'length': 1 };\n\n    /**\n     * Detect if `Array#shift` and `Array#splice` augment array-like objects correctly.\n     *\n     * Firefox < 10, IE compatibility mode, and IE < 9 have buggy Array `shift()`\n     * and `splice()` functions that fail to remove the last element, `value[0]`,\n     * of array-like objects even though the `length` property is set to `0`.\n     * The `shift()` method is buggy in IE 8 compatibility mode, while `splice()`\n     * is buggy regardless of mode in IE < 9 and buggy in compatibility mode in IE 9.\n     *\n     * @memberOf _.support\n     * @type boolean\n     */\n    support.spliceObjects = (arrayRef.splice.call(object, 0, 1), !object[0]);\n  }(1));\n\n  /**\n   * By default, the template delimiters used by Lo-Dash are similar to those in\n   * embedded Ruby (ERB). Change the following template settings to use alternative\n   * delimiters.\n   *\n   * @static\n   * @memberOf _\n   * @type Object\n   */\n  lodash.templateSettings = {\n\n    /**\n     * Used to detect `data` property values to be HTML-escaped.\n     *\n     * @memberOf _.templateSettings\n     * @type RegExp\n     */\n    'escape': /<%-([\\s\\S]+?)%>/g,\n\n    /**\n     * Used to detect code to be evaluated.\n     *\n     * @memberOf _.templateSettings\n     * @type RegExp\n     */\n    'evaluate': /<%([\\s\\S]+?)%>/g,\n\n    /**\n     * Used to detect `data` property values to inject.\n     *\n     * @memberOf _.templateSettings\n     * @type RegExp\n     */\n    'interpolate': reInterpolate,\n\n    /**\n     * Used to reference the data object in the template text.\n     *\n     * @memberOf _.templateSettings\n     * @type string\n     */\n    'variable': ''\n  };\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * The base implementation of `_.bind` that creates the bound function and\n   * sets its meta data.\n   *\n   * @private\n   * @param {Array} bindData The bind data array.\n   * @returns {Function} Returns the new bound function.\n   */\n  function baseBind(bindData) {\n    var func = bindData[0],\n        partialArgs = bindData[2],\n        thisArg = bindData[4];\n\n    function bound() {\n      // `Function#bind` spec\n      // http://es5.github.io/#x15.3.4.5\n      if (partialArgs) {\n        // avoid `arguments` object deoptimizations by using `slice` instead\n        // of `Array.prototype.slice.call` and not assigning `arguments` to a\n        // variable as a ternary expression\n        var args = slice(partialArgs);\n        push.apply(args, arguments);\n      }\n      // mimic the constructor's `return` behavior\n      // http://es5.github.io/#x13.2.2\n      if (this instanceof bound) {\n        // ensure `new bound` is an instance of `func`\n        var thisBinding = baseCreate(func.prototype),\n            result = func.apply(thisBinding, args || arguments);\n        return isObject(result) ? result : thisBinding;\n      }\n      return func.apply(thisArg, args || arguments);\n    }\n    return bound;\n  }\n\n  /**\n   * The base implementation of `_.create` without support for assigning\n   * properties to the created object.\n   *\n   * @private\n   * @param {Object} prototype The object to inherit from.\n   * @returns {Object} Returns the new object.\n   */\n  function baseCreate(prototype, properties) {\n    return isObject(prototype) ? nativeCreate(prototype) : {};\n  }\n  // fallback for browsers without `Object.create`\n  if (!nativeCreate) {\n    baseCreate = (function() {\n      function Object() {}\n      return function(prototype) {\n        if (isObject(prototype)) {\n          Object.prototype = prototype;\n          var result = new Object;\n          Object.prototype = null;\n        }\n        return result || root.Object();\n      };\n    }());\n  }\n\n  /**\n   * The base implementation of `_.createCallback` without support for creating\n   * \"_.pluck\" or \"_.where\" style callbacks.\n   *\n   * @private\n   * @param {*} [func=identity] The value to convert to a callback.\n   * @param {*} [thisArg] The `this` binding of the created callback.\n   * @param {number} [argCount] The number of arguments the callback accepts.\n   * @returns {Function} Returns a callback function.\n   */\n  function baseCreateCallback(func, thisArg, argCount) {\n    if (typeof func != 'function') {\n      return identity;\n    }\n    // exit early for no `thisArg` or already bound by `Function#bind`\n    if (typeof thisArg == 'undefined' || !('prototype' in func)) {\n      return func;\n    }\n    switch (argCount) {\n      case 1: return function(value) {\n        return func.call(thisArg, value);\n      };\n      case 2: return function(a, b) {\n        return func.call(thisArg, a, b);\n      };\n      case 3: return function(value, index, collection) {\n        return func.call(thisArg, value, index, collection);\n      };\n      case 4: return function(accumulator, value, index, collection) {\n        return func.call(thisArg, accumulator, value, index, collection);\n      };\n    }\n    return bind(func, thisArg);\n  }\n\n  /**\n   * The base implementation of `createWrapper` that creates the wrapper and\n   * sets its meta data.\n   *\n   * @private\n   * @param {Array} bindData The bind data array.\n   * @returns {Function} Returns the new function.\n   */\n  function baseCreateWrapper(bindData) {\n    var func = bindData[0],\n        bitmask = bindData[1],\n        partialArgs = bindData[2],\n        partialRightArgs = bindData[3],\n        thisArg = bindData[4],\n        arity = bindData[5];\n\n    var isBind = bitmask & 1,\n        isBindKey = bitmask & 2,\n        isCurry = bitmask & 4,\n        isCurryBound = bitmask & 8,\n        key = func;\n\n    function bound() {\n      var thisBinding = isBind ? thisArg : this;\n      if (partialArgs) {\n        var args = slice(partialArgs);\n        push.apply(args, arguments);\n      }\n      if (partialRightArgs || isCurry) {\n        args || (args = slice(arguments));\n        if (partialRightArgs) {\n          push.apply(args, partialRightArgs);\n        }\n        if (isCurry && args.length < arity) {\n          bitmask |= 16 & ~32;\n          return baseCreateWrapper([func, (isCurryBound ? bitmask : bitmask & ~3), args, null, thisArg, arity]);\n        }\n      }\n      args || (args = arguments);\n      if (isBindKey) {\n        func = thisBinding[key];\n      }\n      if (this instanceof bound) {\n        thisBinding = baseCreate(func.prototype);\n        var result = func.apply(thisBinding, args);\n        return isObject(result) ? result : thisBinding;\n      }\n      return func.apply(thisBinding, args);\n    }\n    return bound;\n  }\n\n  /**\n   * The base implementation of `_.difference` that accepts a single array\n   * of values to exclude.\n   *\n   * @private\n   * @param {Array} array The array to process.\n   * @param {Array} [values] The array of values to exclude.\n   * @returns {Array} Returns a new array of filtered values.\n   */\n  function baseDifference(array, values) {\n    var index = -1,\n        indexOf = getIndexOf(),\n        length = array ? array.length : 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (indexOf(values, value) < 0) {\n        result.push(value);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.flatten` without support for callback\n   * shorthands or `thisArg` binding.\n   *\n   * @private\n   * @param {Array} array The array to flatten.\n   * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n   * @param {boolean} [isStrict=false] A flag to restrict flattening to arrays and `arguments` objects.\n   * @param {number} [fromIndex=0] The index to start from.\n   * @returns {Array} Returns a new flattened array.\n   */\n  function baseFlatten(array, isShallow, isStrict, fromIndex) {\n    var index = (fromIndex || 0) - 1,\n        length = array ? array.length : 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n\n      if (value && typeof value == 'object' && typeof value.length == 'number'\n          && (isArray(value) || isArguments(value))) {\n        // recursively flatten arrays (susceptible to call stack limits)\n        if (!isShallow) {\n          value = baseFlatten(value, isShallow, isStrict);\n        }\n        var valIndex = -1,\n            valLength = value.length,\n            resIndex = result.length;\n\n        result.length += valLength;\n        while (++valIndex < valLength) {\n          result[resIndex++] = value[valIndex];\n        }\n      } else if (!isStrict) {\n        result.push(value);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.isEqual`, without support for `thisArg` binding,\n   * that allows partial \"_.where\" style comparisons.\n   *\n   * @private\n   * @param {*} a The value to compare.\n   * @param {*} b The other value to compare.\n   * @param {Function} [callback] The function to customize comparing values.\n   * @param {Function} [isWhere=false] A flag to indicate performing partial comparisons.\n   * @param {Array} [stackA=[]] Tracks traversed `a` objects.\n   * @param {Array} [stackB=[]] Tracks traversed `b` objects.\n   * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n   */\n  function baseIsEqual(a, b, stackA, stackB) {\n    if (a === b) {\n      return a !== 0 || (1 / a == 1 / b);\n    }\n    var type = typeof a,\n        otherType = typeof b;\n\n    if (a === a &&\n        !(a && objectTypes[type]) &&\n        !(b && objectTypes[otherType])) {\n      return false;\n    }\n    if (a == null || b == null) {\n      return a === b;\n    }\n    var className = toString.call(a),\n        otherClass = toString.call(b);\n\n    if (className != otherClass) {\n      return false;\n    }\n    switch (className) {\n      case boolClass:\n      case dateClass:\n        return +a == +b;\n\n      case numberClass:\n        return a != +a\n          ? b != +b\n          : (a == 0 ? (1 / a == 1 / b) : a == +b);\n\n      case regexpClass:\n      case stringClass:\n        return a == String(b);\n    }\n    var isArr = className == arrayClass;\n    if (!isArr) {\n      var aWrapped = a instanceof lodash,\n          bWrapped = b instanceof lodash;\n\n      if (aWrapped || bWrapped) {\n        return baseIsEqual(aWrapped ? a.__wrapped__ : a, bWrapped ? b.__wrapped__ : b, stackA, stackB);\n      }\n      if (className != objectClass) {\n        return false;\n      }\n      var ctorA = a.constructor,\n          ctorB = b.constructor;\n\n      if (ctorA != ctorB &&\n            !(isFunction(ctorA) && ctorA instanceof ctorA && isFunction(ctorB) && ctorB instanceof ctorB) &&\n            ('constructor' in a && 'constructor' in b)\n          ) {\n        return false;\n      }\n    }\n    stackA || (stackA = []);\n    stackB || (stackB = []);\n\n    var length = stackA.length;\n    while (length--) {\n      if (stackA[length] == a) {\n        return stackB[length] == b;\n      }\n    }\n    var result = true,\n        size = 0;\n\n    stackA.push(a);\n    stackB.push(b);\n\n    if (isArr) {\n      size = b.length;\n      result = size == a.length;\n\n      if (result) {\n        while (size--) {\n          if (!(result = baseIsEqual(a[size], b[size], stackA, stackB))) {\n            break;\n          }\n        }\n      }\n    }\n    else {\n      forIn(b, function(value, key, b) {\n        if (hasOwnProperty.call(b, key)) {\n          size++;\n          return !(result = hasOwnProperty.call(a, key) && baseIsEqual(a[key], value, stackA, stackB)) && indicatorObject;\n        }\n      });\n\n      if (result) {\n        forIn(a, function(value, key, a) {\n          if (hasOwnProperty.call(a, key)) {\n            return !(result = --size > -1) && indicatorObject;\n          }\n        });\n      }\n    }\n    stackA.pop();\n    stackB.pop();\n    return result;\n  }\n\n  /**\n   * The base implementation of `_.random` without argument juggling or support\n   * for returning floating-point numbers.\n   *\n   * @private\n   * @param {number} min The minimum possible value.\n   * @param {number} max The maximum possible value.\n   * @returns {number} Returns a random number.\n   */\n  function baseRandom(min, max) {\n    return min + floor(nativeRandom() * (max - min + 1));\n  }\n\n  /**\n   * The base implementation of `_.uniq` without support for callback shorthands\n   * or `thisArg` binding.\n   *\n   * @private\n   * @param {Array} array The array to process.\n   * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n   * @param {Function} [callback] The function called per iteration.\n   * @returns {Array} Returns a duplicate-value-free array.\n   */\n  function baseUniq(array, isSorted, callback) {\n    var index = -1,\n        indexOf = getIndexOf(),\n        length = array ? array.length : 0,\n        result = [],\n        seen = callback ? [] : result;\n\n    while (++index < length) {\n      var value = array[index],\n          computed = callback ? callback(value, index, array) : value;\n\n      if (isSorted\n            ? !index || seen[seen.length - 1] !== computed\n            : indexOf(seen, computed) < 0\n          ) {\n        if (callback) {\n          seen.push(computed);\n        }\n        result.push(value);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Creates a function that aggregates a collection, creating an object composed\n   * of keys generated from the results of running each element of the collection\n   * through a callback. The given `setter` function sets the keys and values\n   * of the composed object.\n   *\n   * @private\n   * @param {Function} setter The setter function.\n   * @returns {Function} Returns the new aggregator function.\n   */\n  function createAggregator(setter) {\n    return function(collection, callback, thisArg) {\n      var result = {};\n      callback = createCallback(callback, thisArg, 3);\n\n      var index = -1,\n          length = collection ? collection.length : 0;\n\n      if (typeof length == 'number') {\n        while (++index < length) {\n          var value = collection[index];\n          setter(result, value, callback(value, index, collection), collection);\n        }\n      } else {\n        forOwn(collection, function(value, key, collection) {\n          setter(result, value, callback(value, key, collection), collection);\n        });\n      }\n      return result;\n    };\n  }\n\n  /**\n   * Creates a function that, when called, either curries or invokes `func`\n   * with an optional `this` binding and partially applied arguments.\n   *\n   * @private\n   * @param {Function|string} func The function or method name to reference.\n   * @param {number} bitmask The bitmask of method flags to compose.\n   *  The bitmask may be composed of the following flags:\n   *  1 - `_.bind`\n   *  2 - `_.bindKey`\n   *  4 - `_.curry`\n   *  8 - `_.curry` (bound)\n   *  16 - `_.partial`\n   *  32 - `_.partialRight`\n   * @param {Array} [partialArgs] An array of arguments to prepend to those\n   *  provided to the new function.\n   * @param {Array} [partialRightArgs] An array of arguments to append to those\n   *  provided to the new function.\n   * @param {*} [thisArg] The `this` binding of `func`.\n   * @param {number} [arity] The arity of `func`.\n   * @returns {Function} Returns the new function.\n   */\n  function createWrapper(func, bitmask, partialArgs, partialRightArgs, thisArg, arity) {\n    var isBind = bitmask & 1,\n        isBindKey = bitmask & 2,\n        isCurry = bitmask & 4,\n        isCurryBound = bitmask & 8,\n        isPartial = bitmask & 16,\n        isPartialRight = bitmask & 32;\n\n    if (!isBindKey && !isFunction(func)) {\n      throw new TypeError;\n    }\n    if (isPartial && !partialArgs.length) {\n      bitmask &= ~16;\n      isPartial = partialArgs = false;\n    }\n    if (isPartialRight && !partialRightArgs.length) {\n      bitmask &= ~32;\n      isPartialRight = partialRightArgs = false;\n    }\n    // fast path for `_.bind`\n    var creater = (bitmask == 1 || bitmask === 17) ? baseBind : baseCreateWrapper;\n    return creater([func, bitmask, partialArgs, partialRightArgs, thisArg, arity]);\n  }\n\n  /**\n   * Used by `escape` to convert characters to HTML entities.\n   *\n   * @private\n   * @param {string} match The matched character to escape.\n   * @returns {string} Returns the escaped character.\n   */\n  function escapeHtmlChar(match) {\n    return htmlEscapes[match];\n  }\n\n  /**\n   * Gets the appropriate \"indexOf\" function. If the `_.indexOf` method is\n   * customized, this method returns the custom method, otherwise it returns\n   * the `baseIndexOf` function.\n   *\n   * @private\n   * @returns {Function} Returns the \"indexOf\" function.\n   */\n  function getIndexOf() {\n    var result = (result = lodash.indexOf) === indexOf ? baseIndexOf : result;\n    return result;\n  }\n\n  /**\n   * Checks if `value` is a native function.\n   *\n   * @private\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a native function, else `false`.\n   */\n  function isNative(value) {\n    return typeof value == 'function' && reNative.test(value);\n  }\n\n  /**\n   * Used by `unescape` to convert HTML entities to characters.\n   *\n   * @private\n   * @param {string} match The matched character to unescape.\n   * @returns {string} Returns the unescaped character.\n   */\n  function unescapeHtmlChar(match) {\n    return htmlUnescapes[match];\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Checks if `value` is an `arguments` object.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is an `arguments` object, else `false`.\n   * @example\n   *\n   * (function() { return _.isArguments(arguments); })(1, 2, 3);\n   * // => true\n   *\n   * _.isArguments([1, 2, 3]);\n   * // => false\n   */\n  function isArguments(value) {\n    return value && typeof value == 'object' && typeof value.length == 'number' &&\n      toString.call(value) == argsClass || false;\n  }\n  // fallback for browsers that can't detect `arguments` objects by [[Class]]\n  if (!isArguments(arguments)) {\n    isArguments = function(value) {\n      return value && typeof value == 'object' && typeof value.length == 'number' &&\n        hasOwnProperty.call(value, 'callee') && !propertyIsEnumerable.call(value, 'callee') || false;\n    };\n  }\n\n  /**\n   * Checks if `value` is an array.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is an array, else `false`.\n   * @example\n   *\n   * (function() { return _.isArray(arguments); })();\n   * // => false\n   *\n   * _.isArray([1, 2, 3]);\n   * // => true\n   */\n  var isArray = nativeIsArray || function(value) {\n    return value && typeof value == 'object' && typeof value.length == 'number' &&\n      toString.call(value) == arrayClass || false;\n  };\n\n  /**\n   * A fallback implementation of `Object.keys` which produces an array of the\n   * given object's own enumerable property names.\n   *\n   * @private\n   * @type Function\n   * @param {Object} object The object to inspect.\n   * @returns {Array} Returns an array of property names.\n   */\n  var shimKeys = function(object) {\n    var index, iterable = object, result = [];\n    if (!iterable) return result;\n    if (!(objectTypes[typeof object])) return result;\n      for (index in iterable) {\n        if (hasOwnProperty.call(iterable, index)) {\n          result.push(index);\n        }\n      }\n    return result\n  };\n\n  /**\n   * Creates an array composed of the own enumerable property names of an object.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The object to inspect.\n   * @returns {Array} Returns an array of property names.\n   * @example\n   *\n   * _.keys({ 'one': 1, 'two': 2, 'three': 3 });\n   * // => ['one', 'two', 'three'] (property order is not guaranteed across environments)\n   */\n  var keys = !nativeKeys ? shimKeys : function(object) {\n    if (!isObject(object)) {\n      return [];\n    }\n    return nativeKeys(object);\n  };\n\n  /**\n   * Used to convert characters to HTML entities:\n   *\n   * Though the `>` character is escaped for symmetry, characters like `>` and `/`\n   * don't require escaping in HTML and have no special meaning unless they're part\n   * of a tag or an unquoted attribute value.\n   * http://mathiasbynens.be/notes/ambiguous-ampersands (under \"semi-related fun fact\")\n   */\n  var htmlEscapes = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;'\n  };\n\n  /** Used to convert HTML entities to characters */\n  var htmlUnescapes = invert(htmlEscapes);\n\n  /** Used to match HTML entities and HTML characters */\n  var reEscapedHtml = RegExp('(' + keys(htmlUnescapes).join('|') + ')', 'g'),\n      reUnescapedHtml = RegExp('[' + keys(htmlEscapes).join('') + ']', 'g');\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Assigns own enumerable properties of source object(s) to the destination\n   * object. Subsequent sources will overwrite property assignments of previous\n   * sources. If a callback is provided it will be executed to produce the\n   * assigned values. The callback is bound to `thisArg` and invoked with two\n   * arguments; (objectValue, sourceValue).\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @alias extend\n   * @category Objects\n   * @param {Object} object The destination object.\n   * @param {...Object} [source] The source objects.\n   * @param {Function} [callback] The function to customize assigning values.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns the destination object.\n   * @example\n   *\n   * _.assign({ 'name': 'fred' }, { 'employer': 'slate' });\n   * // => { 'name': 'fred', 'employer': 'slate' }\n   *\n   * var defaults = _.partialRight(_.assign, function(a, b) {\n   *   return typeof a == 'undefined' ? b : a;\n   * });\n   *\n   * var object = { 'name': 'barney' };\n   * defaults(object, { 'name': 'fred', 'employer': 'slate' });\n   * // => { 'name': 'barney', 'employer': 'slate' }\n   */\n  function assign(object) {\n    if (!object) {\n      return object;\n    }\n    for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n      var iterable = arguments[argsIndex];\n      if (iterable) {\n        for (var key in iterable) {\n          object[key] = iterable[key];\n        }\n      }\n    }\n    return object;\n  }\n\n  /**\n   * Creates a clone of `value`. If `isDeep` is `true` nested objects will also\n   * be cloned, otherwise they will be assigned by reference. If a callback\n   * is provided it will be executed to produce the cloned values. If the\n   * callback returns `undefined` cloning will be handled by the method instead.\n   * The callback is bound to `thisArg` and invoked with one argument; (value).\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to clone.\n   * @param {boolean} [isDeep=false] Specify a deep clone.\n   * @param {Function} [callback] The function to customize cloning values.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the cloned value.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * var shallow = _.clone(characters);\n   * shallow[0] === characters[0];\n   * // => true\n   *\n   * var deep = _.clone(characters, true);\n   * deep[0] === characters[0];\n   * // => false\n   *\n   * _.mixin({\n   *   'clone': _.partialRight(_.clone, function(value) {\n   *     return _.isElement(value) ? value.cloneNode(false) : undefined;\n   *   })\n   * });\n   *\n   * var clone = _.clone(document.body);\n   * clone.childNodes.length;\n   * // => 0\n   */\n  function clone(value) {\n    return isObject(value)\n      ? (isArray(value) ? slice(value) : assign({}, value))\n      : value;\n  }\n\n  /**\n   * Assigns own enumerable properties of source object(s) to the destination\n   * object for all destination properties that resolve to `undefined`. Once a\n   * property is set, additional defaults of the same property will be ignored.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Objects\n   * @param {Object} object The destination object.\n   * @param {...Object} [source] The source objects.\n   * @param- {Object} [guard] Allows working with `_.reduce` without using its\n   *  `key` and `object` arguments as sources.\n   * @returns {Object} Returns the destination object.\n   * @example\n   *\n   * var object = { 'name': 'barney' };\n   * _.defaults(object, { 'name': 'fred', 'employer': 'slate' });\n   * // => { 'name': 'barney', 'employer': 'slate' }\n   */\n  function defaults(object) {\n    if (!object) {\n      return object;\n    }\n    for (var argsIndex = 1, argsLength = arguments.length; argsIndex < argsLength; argsIndex++) {\n      var iterable = arguments[argsIndex];\n      if (iterable) {\n        for (var key in iterable) {\n          if (typeof object[key] == 'undefined') {\n            object[key] = iterable[key];\n          }\n        }\n      }\n    }\n    return object;\n  }\n\n  /**\n   * Iterates over own and inherited enumerable properties of an object,\n   * executing the callback for each property. The callback is bound to `thisArg`\n   * and invoked with three arguments; (value, key, object). Callbacks may exit\n   * iteration early by explicitly returning `false`.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Objects\n   * @param {Object} object The object to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns `object`.\n   * @example\n   *\n   * function Shape() {\n   *   this.x = 0;\n   *   this.y = 0;\n   * }\n   *\n   * Shape.prototype.move = function(x, y) {\n   *   this.x += x;\n   *   this.y += y;\n   * };\n   *\n   * _.forIn(new Shape, function(value, key) {\n   *   console.log(key);\n   * });\n   * // => logs 'x', 'y', and 'move' (property order is not guaranteed across environments)\n   */\n  var forIn = function(collection, callback) {\n    var index, iterable = collection, result = iterable;\n    if (!iterable) return result;\n    if (!objectTypes[typeof iterable]) return result;\n      for (index in iterable) {\n        if (callback(iterable[index], index, collection) === indicatorObject) return result;\n      }\n    return result\n  };\n\n  /**\n   * Iterates over own enumerable properties of an object, executing the callback\n   * for each property. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, key, object). Callbacks may exit iteration early by\n   * explicitly returning `false`.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Objects\n   * @param {Object} object The object to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns `object`.\n   * @example\n   *\n   * _.forOwn({ '0': 'zero', '1': 'one', 'length': 2 }, function(num, key) {\n   *   console.log(key);\n   * });\n   * // => logs '0', '1', and 'length' (property order is not guaranteed across environments)\n   */\n  var forOwn = function(collection, callback) {\n    var index, iterable = collection, result = iterable;\n    if (!iterable) return result;\n    if (!objectTypes[typeof iterable]) return result;\n      for (index in iterable) {\n        if (hasOwnProperty.call(iterable, index)) {\n          if (callback(iterable[index], index, collection) === indicatorObject) return result;\n        }\n      }\n    return result\n  };\n\n  /**\n   * Creates a sorted array of property names of all enumerable properties,\n   * own and inherited, of `object` that have function values.\n   *\n   * @static\n   * @memberOf _\n   * @alias methods\n   * @category Objects\n   * @param {Object} object The object to inspect.\n   * @returns {Array} Returns an array of property names that have function values.\n   * @example\n   *\n   * _.functions(_);\n   * // => ['all', 'any', 'bind', 'bindAll', 'clone', 'compact', 'compose', ...]\n   */\n  function functions(object) {\n    var result = [];\n    forIn(object, function(value, key) {\n      if (isFunction(value)) {\n        result.push(key);\n      }\n    });\n    return result.sort();\n  }\n\n  /**\n   * Checks if the specified property name exists as a direct property of `object`,\n   * instead of an inherited property.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The object to inspect.\n   * @param {string} key The name of the property to check.\n   * @returns {boolean} Returns `true` if key is a direct property, else `false`.\n   * @example\n   *\n   * _.has({ 'a': 1, 'b': 2, 'c': 3 }, 'b');\n   * // => true\n   */\n  function has(object, key) {\n    return object ? hasOwnProperty.call(object, key) : false;\n  }\n\n  /**\n   * Creates an object composed of the inverted keys and values of the given object.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The object to invert.\n   * @returns {Object} Returns the created inverted object.\n   * @example\n   *\n   * _.invert({ 'first': 'fred', 'second': 'barney' });\n   * // => { 'fred': 'first', 'barney': 'second' }\n   */\n  function invert(object) {\n    var index = -1,\n        props = keys(object),\n        length = props.length,\n        result = {};\n\n    while (++index < length) {\n      var key = props[index];\n      result[object[key]] = key;\n    }\n    return result;\n  }\n\n  /**\n   * Checks if `value` is a boolean value.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a boolean value, else `false`.\n   * @example\n   *\n   * _.isBoolean(null);\n   * // => false\n   */\n  function isBoolean(value) {\n    return value === true || value === false ||\n      value && typeof value == 'object' && toString.call(value) == boolClass || false;\n  }\n\n  /**\n   * Checks if `value` is a date.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a date, else `false`.\n   * @example\n   *\n   * _.isDate(new Date);\n   * // => true\n   */\n  function isDate(value) {\n    return value && typeof value == 'object' && toString.call(value) == dateClass || false;\n  }\n\n  /**\n   * Checks if `value` is a DOM element.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a DOM element, else `false`.\n   * @example\n   *\n   * _.isElement(document.body);\n   * // => true\n   */\n  function isElement(value) {\n    return value && value.nodeType === 1 || false;\n  }\n\n  /**\n   * Checks if `value` is empty. Arrays, strings, or `arguments` objects with a\n   * length of `0` and objects with no own enumerable properties are considered\n   * \"empty\".\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Array|Object|string} value The value to inspect.\n   * @returns {boolean} Returns `true` if the `value` is empty, else `false`.\n   * @example\n   *\n   * _.isEmpty([1, 2, 3]);\n   * // => false\n   *\n   * _.isEmpty({});\n   * // => true\n   *\n   * _.isEmpty('');\n   * // => true\n   */\n  function isEmpty(value) {\n    if (!value) {\n      return true;\n    }\n    if (isArray(value) || isString(value)) {\n      return !value.length;\n    }\n    for (var key in value) {\n      if (hasOwnProperty.call(value, key)) {\n        return false;\n      }\n    }\n    return true;\n  }\n\n  /**\n   * Performs a deep comparison between two values to determine if they are\n   * equivalent to each other. If a callback is provided it will be executed\n   * to compare values. If the callback returns `undefined` comparisons will\n   * be handled by the method instead. The callback is bound to `thisArg` and\n   * invoked with two arguments; (a, b).\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} a The value to compare.\n   * @param {*} b The other value to compare.\n   * @param {Function} [callback] The function to customize comparing values.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n   * @example\n   *\n   * var object = { 'name': 'fred' };\n   * var copy = { 'name': 'fred' };\n   *\n   * object == copy;\n   * // => false\n   *\n   * _.isEqual(object, copy);\n   * // => true\n   *\n   * var words = ['hello', 'goodbye'];\n   * var otherWords = ['hi', 'goodbye'];\n   *\n   * _.isEqual(words, otherWords, function(a, b) {\n   *   var reGreet = /^(?:hello|hi)$/i,\n   *       aGreet = _.isString(a) && reGreet.test(a),\n   *       bGreet = _.isString(b) && reGreet.test(b);\n   *\n   *   return (aGreet || bGreet) ? (aGreet == bGreet) : undefined;\n   * });\n   * // => true\n   */\n  function isEqual(a, b) {\n    return baseIsEqual(a, b);\n  }\n\n  /**\n   * Checks if `value` is, or can be coerced to, a finite number.\n   *\n   * Note: This is not the same as native `isFinite` which will return true for\n   * booleans and empty strings. See http://es5.github.io/#x15.1.2.5.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is finite, else `false`.\n   * @example\n   *\n   * _.isFinite(-101);\n   * // => true\n   *\n   * _.isFinite('10');\n   * // => true\n   *\n   * _.isFinite(true);\n   * // => false\n   *\n   * _.isFinite('');\n   * // => false\n   *\n   * _.isFinite(Infinity);\n   * // => false\n   */\n  function isFinite(value) {\n    return nativeIsFinite(value) && !nativeIsNaN(parseFloat(value));\n  }\n\n  /**\n   * Checks if `value` is a function.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a function, else `false`.\n   * @example\n   *\n   * _.isFunction(_);\n   * // => true\n   */\n  function isFunction(value) {\n    return typeof value == 'function';\n  }\n  // fallback for older versions of Chrome and Safari\n  if (isFunction(/x/)) {\n    isFunction = function(value) {\n      return typeof value == 'function' && toString.call(value) == funcClass;\n    };\n  }\n\n  /**\n   * Checks if `value` is the language type of Object.\n   * (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is an object, else `false`.\n   * @example\n   *\n   * _.isObject({});\n   * // => true\n   *\n   * _.isObject([1, 2, 3]);\n   * // => true\n   *\n   * _.isObject(1);\n   * // => false\n   */\n  function isObject(value) {\n    // check if the value is the ECMAScript language type of Object\n    // http://es5.github.io/#x8\n    // and avoid a V8 bug\n    // http://code.google.com/p/v8/issues/detail?id=2291\n    return !!(value && objectTypes[typeof value]);\n  }\n\n  /**\n   * Checks if `value` is `NaN`.\n   *\n   * Note: This is not the same as native `isNaN` which will return `true` for\n   * `undefined` and other non-numeric values. See http://es5.github.io/#x15.1.2.4.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is `NaN`, else `false`.\n   * @example\n   *\n   * _.isNaN(NaN);\n   * // => true\n   *\n   * _.isNaN(new Number(NaN));\n   * // => true\n   *\n   * isNaN(undefined);\n   * // => true\n   *\n   * _.isNaN(undefined);\n   * // => false\n   */\n  function isNaN(value) {\n    // `NaN` as a primitive is the only value that is not equal to itself\n    // (perform the [[Class]] check first to avoid errors with some host objects in IE)\n    return isNumber(value) && value != +value;\n  }\n\n  /**\n   * Checks if `value` is `null`.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is `null`, else `false`.\n   * @example\n   *\n   * _.isNull(null);\n   * // => true\n   *\n   * _.isNull(undefined);\n   * // => false\n   */\n  function isNull(value) {\n    return value === null;\n  }\n\n  /**\n   * Checks if `value` is a number.\n   *\n   * Note: `NaN` is considered a number. See http://es5.github.io/#x8.5.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a number, else `false`.\n   * @example\n   *\n   * _.isNumber(8.4 * 5);\n   * // => true\n   */\n  function isNumber(value) {\n    return typeof value == 'number' ||\n      value && typeof value == 'object' && toString.call(value) == numberClass || false;\n  }\n\n  /**\n   * Checks if `value` is a regular expression.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a regular expression, else `false`.\n   * @example\n   *\n   * _.isRegExp(/fred/);\n   * // => true\n   */\n  function isRegExp(value) {\n    return value && objectTypes[typeof value] && toString.call(value) == regexpClass || false;\n  }\n\n  /**\n   * Checks if `value` is a string.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is a string, else `false`.\n   * @example\n   *\n   * _.isString('fred');\n   * // => true\n   */\n  function isString(value) {\n    return typeof value == 'string' ||\n      value && typeof value == 'object' && toString.call(value) == stringClass || false;\n  }\n\n  /**\n   * Checks if `value` is `undefined`.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {*} value The value to check.\n   * @returns {boolean} Returns `true` if the `value` is `undefined`, else `false`.\n   * @example\n   *\n   * _.isUndefined(void 0);\n   * // => true\n   */\n  function isUndefined(value) {\n    return typeof value == 'undefined';\n  }\n\n  /**\n   * Creates a shallow clone of `object` excluding the specified properties.\n   * Property names may be specified as individual arguments or as arrays of\n   * property names. If a callback is provided it will be executed for each\n   * property of `object` omitting the properties the callback returns truey\n   * for. The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, key, object).\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The source object.\n   * @param {Function|...string|string[]} [callback] The properties to omit or the\n   *  function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns an object without the omitted properties.\n   * @example\n   *\n   * _.omit({ 'name': 'fred', 'age': 40 }, 'age');\n   * // => { 'name': 'fred' }\n   *\n   * _.omit({ 'name': 'fred', 'age': 40 }, function(value) {\n   *   return typeof value == 'number';\n   * });\n   * // => { 'name': 'fred' }\n   */\n  function omit(object) {\n    var props = [];\n    forIn(object, function(value, key) {\n      props.push(key);\n    });\n    props = baseDifference(props, baseFlatten(arguments, true, false, 1));\n\n    var index = -1,\n        length = props.length,\n        result = {};\n\n    while (++index < length) {\n      var key = props[index];\n      result[key] = object[key];\n    }\n    return result;\n  }\n\n  /**\n   * Creates a two dimensional array of an object's key-value pairs,\n   * i.e. `[[key1, value1], [key2, value2]]`.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The object to inspect.\n   * @returns {Array} Returns new array of key-value pairs.\n   * @example\n   *\n   * _.pairs({ 'barney': 36, 'fred': 40 });\n   * // => [['barney', 36], ['fred', 40]] (property order is not guaranteed across environments)\n   */\n  function pairs(object) {\n    var index = -1,\n        props = keys(object),\n        length = props.length,\n        result = Array(length);\n\n    while (++index < length) {\n      var key = props[index];\n      result[index] = [key, object[key]];\n    }\n    return result;\n  }\n\n  /**\n   * Creates a shallow clone of `object` composed of the specified properties.\n   * Property names may be specified as individual arguments or as arrays of\n   * property names. If a callback is provided it will be executed for each\n   * property of `object` picking the properties the callback returns truey\n   * for. The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, key, object).\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The source object.\n   * @param {Function|...string|string[]} [callback] The function called per\n   *  iteration or property names to pick, specified as individual property\n   *  names or arrays of property names.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns an object composed of the picked properties.\n   * @example\n   *\n   * _.pick({ 'name': 'fred', '_userid': 'fred1' }, 'name');\n   * // => { 'name': 'fred' }\n   *\n   * _.pick({ 'name': 'fred', '_userid': 'fred1' }, function(value, key) {\n   *   return key.charAt(0) != '_';\n   * });\n   * // => { 'name': 'fred' }\n   */\n  function pick(object) {\n    var index = -1,\n        props = baseFlatten(arguments, true, false, 1),\n        length = props.length,\n        result = {};\n\n    while (++index < length) {\n      var key = props[index];\n      if (key in object) {\n        result[key] = object[key];\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Creates an array composed of the own enumerable property values of `object`.\n   *\n   * @static\n   * @memberOf _\n   * @category Objects\n   * @param {Object} object The object to inspect.\n   * @returns {Array} Returns an array of property values.\n   * @example\n   *\n   * _.values({ 'one': 1, 'two': 2, 'three': 3 });\n   * // => [1, 2, 3] (property order is not guaranteed across environments)\n   */\n  function values(object) {\n    var index = -1,\n        props = keys(object),\n        length = props.length,\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = object[props[index]];\n    }\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Checks if a given value is present in a collection using strict equality\n   * for comparisons, i.e. `===`. If `fromIndex` is negative, it is used as the\n   * offset from the end of the collection.\n   *\n   * @static\n   * @memberOf _\n   * @alias include\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {*} target The value to check for.\n   * @param {number} [fromIndex=0] The index to search from.\n   * @returns {boolean} Returns `true` if the `target` element is found, else `false`.\n   * @example\n   *\n   * _.contains([1, 2, 3], 1);\n   * // => true\n   *\n   * _.contains([1, 2, 3], 1, 2);\n   * // => false\n   *\n   * _.contains({ 'name': 'fred', 'age': 40 }, 'fred');\n   * // => true\n   *\n   * _.contains('pebbles', 'eb');\n   * // => true\n   */\n  function contains(collection, target) {\n    var indexOf = getIndexOf(),\n        length = collection ? collection.length : 0,\n        result = false;\n    if (length && typeof length == 'number') {\n      result = indexOf(collection, target) > -1;\n    } else {\n      forOwn(collection, function(value) {\n        return (result = value === target) && indicatorObject;\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Creates an object composed of keys generated from the results of running\n   * each element of `collection` through the callback. The corresponding value\n   * of each key is the number of times the key was returned by the callback.\n   * The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns the composed aggregate object.\n   * @example\n   *\n   * _.countBy([4.3, 6.1, 6.4], function(num) { return Math.floor(num); });\n   * // => { '4': 1, '6': 2 }\n   *\n   * _.countBy([4.3, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n   * // => { '4': 1, '6': 2 }\n   *\n   * _.countBy(['one', 'two', 'three'], 'length');\n   * // => { '3': 2, '5': 1 }\n   */\n  var countBy = createAggregator(function(result, value, key) {\n    (hasOwnProperty.call(result, key) ? result[key]++ : result[key] = 1);\n  });\n\n  /**\n   * Checks if the given callback returns truey value for **all** elements of\n   * a collection. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias all\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {boolean} Returns `true` if all elements passed the callback check,\n   *  else `false`.\n   * @example\n   *\n   * _.every([true, 1, null, 'yes']);\n   * // => false\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.every(characters, 'age');\n   * // => true\n   *\n   * // using \"_.where\" callback shorthand\n   * _.every(characters, { 'age': 36 });\n   * // => false\n   */\n  function every(collection, callback, thisArg) {\n    var result = true;\n    callback = createCallback(callback, thisArg, 3);\n\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (typeof length == 'number') {\n      while (++index < length) {\n        if (!(result = !!callback(collection[index], index, collection))) {\n          break;\n        }\n      }\n    } else {\n      forOwn(collection, function(value, index, collection) {\n        return !(result = !!callback(value, index, collection)) && indicatorObject;\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Iterates over elements of a collection, returning an array of all elements\n   * the callback returns truey for. The callback is bound to `thisArg` and\n   * invoked with three arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias select\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a new array of elements that passed the callback check.\n   * @example\n   *\n   * var evens = _.filter([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n   * // => [2, 4, 6]\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36, 'blocked': false },\n   *   { 'name': 'fred',   'age': 40, 'blocked': true }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.filter(characters, 'blocked');\n   * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n   *\n   * // using \"_.where\" callback shorthand\n   * _.filter(characters, { 'age': 36 });\n   * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n   */\n  function filter(collection, callback, thisArg) {\n    var result = [];\n    callback = createCallback(callback, thisArg, 3);\n\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (typeof length == 'number') {\n      while (++index < length) {\n        var value = collection[index];\n        if (callback(value, index, collection)) {\n          result.push(value);\n        }\n      }\n    } else {\n      forOwn(collection, function(value, index, collection) {\n        if (callback(value, index, collection)) {\n          result.push(value);\n        }\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Iterates over elements of a collection, returning the first element that\n   * the callback returns truey for. The callback is bound to `thisArg` and\n   * invoked with three arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias detect, findWhere\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the found element, else `undefined`.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'age': 36, 'blocked': false },\n   *   { 'name': 'fred',    'age': 40, 'blocked': true },\n   *   { 'name': 'pebbles', 'age': 1,  'blocked': false }\n   * ];\n   *\n   * _.find(characters, function(chr) {\n   *   return chr.age < 40;\n   * });\n   * // => { 'name': 'barney', 'age': 36, 'blocked': false }\n   *\n   * // using \"_.where\" callback shorthand\n   * _.find(characters, { 'age': 1 });\n   * // =>  { 'name': 'pebbles', 'age': 1, 'blocked': false }\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.find(characters, 'blocked');\n   * // => { 'name': 'fred', 'age': 40, 'blocked': true }\n   */\n  function find(collection, callback, thisArg) {\n    callback = createCallback(callback, thisArg, 3);\n\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (typeof length == 'number') {\n      while (++index < length) {\n        var value = collection[index];\n        if (callback(value, index, collection)) {\n          return value;\n        }\n      }\n    } else {\n      var result;\n      forOwn(collection, function(value, index, collection) {\n        if (callback(value, index, collection)) {\n          result = value;\n          return indicatorObject;\n        }\n      });\n      return result;\n    }\n  }\n\n  /**\n   * Examines each element in a `collection`, returning the first that\n   * has the given properties. When checking `properties`, this method\n   * performs a deep comparison between values to determine if they are\n   * equivalent to each other.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Object} properties The object of property values to filter by.\n   * @returns {*} Returns the found element, else `undefined`.\n   * @example\n   *\n   * var food = [\n   *   { 'name': 'apple',  'organic': false, 'type': 'fruit' },\n   *   { 'name': 'banana', 'organic': true,  'type': 'fruit' },\n   *   { 'name': 'beet',   'organic': false, 'type': 'vegetable' }\n   * ];\n   *\n   * _.findWhere(food, { 'type': 'vegetable' });\n   * // => { 'name': 'beet', 'organic': false, 'type': 'vegetable' }\n   */\n  function findWhere(object, properties) {\n    return where(object, properties, true);\n  }\n\n  /**\n   * Iterates over elements of a collection, executing the callback for each\n   * element. The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, index|key, collection). Callbacks may exit iteration early by\n   * explicitly returning `false`.\n   *\n   * Note: As with other \"Collections\" methods, objects with a `length` property\n   * are iterated like arrays. To avoid this behavior `_.forIn` or `_.forOwn`\n   * may be used for object iteration.\n   *\n   * @static\n   * @memberOf _\n   * @alias each\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array|Object|string} Returns `collection`.\n   * @example\n   *\n   * _([1, 2, 3]).forEach(function(num) { console.log(num); }).join(',');\n   * // => logs each number and returns '1,2,3'\n   *\n   * _.forEach({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { console.log(num); });\n   * // => logs each number and returns the object (property order is not guaranteed across environments)\n   */\n  function forEach(collection, callback, thisArg) {\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    callback = callback && typeof thisArg == 'undefined' ? callback : baseCreateCallback(callback, thisArg, 3);\n    if (typeof length == 'number') {\n      while (++index < length) {\n        if (callback(collection[index], index, collection) === indicatorObject) {\n          break;\n        }\n      }\n    } else {\n      forOwn(collection, callback);\n    }\n  }\n\n  /**\n   * This method is like `_.forEach` except that it iterates over elements\n   * of a `collection` from right to left.\n   *\n   * @static\n   * @memberOf _\n   * @alias eachRight\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array|Object|string} Returns `collection`.\n   * @example\n   *\n   * _([1, 2, 3]).forEachRight(function(num) { console.log(num); }).join(',');\n   * // => logs each number from right to left and returns '3,2,1'\n   */\n  function forEachRight(collection, callback) {\n    var length = collection ? collection.length : 0;\n    if (typeof length == 'number') {\n      while (length--) {\n        if (callback(collection[length], length, collection) === false) {\n          break;\n        }\n      }\n    } else {\n      var props = keys(collection);\n      length = props.length;\n      forOwn(collection, function(value, key, collection) {\n        key = props ? props[--length] : --length;\n        return callback(collection[key], key, collection) === false && indicatorObject;\n      });\n    }\n  }\n\n  /**\n   * Creates an object composed of keys generated from the results of running\n   * each element of a collection through the callback. The corresponding value\n   * of each key is an array of the elements responsible for generating the key.\n   * The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns the composed aggregate object.\n   * @example\n   *\n   * _.groupBy([4.2, 6.1, 6.4], function(num) { return Math.floor(num); });\n   * // => { '4': [4.2], '6': [6.1, 6.4] }\n   *\n   * _.groupBy([4.2, 6.1, 6.4], function(num) { return this.floor(num); }, Math);\n   * // => { '4': [4.2], '6': [6.1, 6.4] }\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.groupBy(['one', 'two', 'three'], 'length');\n   * // => { '3': ['one', 'two'], '5': ['three'] }\n   */\n  var groupBy = createAggregator(function(result, value, key) {\n    (hasOwnProperty.call(result, key) ? result[key] : result[key] = []).push(value);\n  });\n\n  /**\n   * Creates an object composed of keys generated from the results of running\n   * each element of the collection through the given callback. The corresponding\n   * value of each key is the last element responsible for generating the key.\n   * The callback is bound to `thisArg` and invoked with three arguments;\n   * (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Object} Returns the composed aggregate object.\n   * @example\n   *\n   * var keys = [\n   *   { 'dir': 'left', 'code': 97 },\n   *   { 'dir': 'right', 'code': 100 }\n   * ];\n   *\n   * _.indexBy(keys, 'dir');\n   * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n   *\n   * _.indexBy(keys, function(key) { return String.fromCharCode(key.code); });\n   * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n   *\n   * _.indexBy(characters, function(key) { this.fromCharCode(key.code); }, String);\n   * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n   */\n  var indexBy = createAggregator(function(result, value, key) {\n    result[key] = value;\n  });\n\n  /**\n   * Invokes the method named by `methodName` on each element in the `collection`\n   * returning an array of the results of each invoked method. Additional arguments\n   * will be provided to each invoked method. If `methodName` is a function it\n   * will be invoked for, and `this` bound to, each element in the `collection`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|string} methodName The name of the method to invoke or\n   *  the function invoked per iteration.\n   * @param {...*} [arg] Arguments to invoke the method with.\n   * @returns {Array} Returns a new array of the results of each invoked method.\n   * @example\n   *\n   * _.invoke([[5, 1, 7], [3, 2, 1]], 'sort');\n   * // => [[1, 5, 7], [1, 2, 3]]\n   *\n   * _.invoke([123, 456], String.prototype.split, '');\n   * // => [['1', '2', '3'], ['4', '5', '6']]\n   */\n  function invoke(collection, methodName) {\n    var args = slice(arguments, 2),\n        index = -1,\n        isFunc = typeof methodName == 'function',\n        length = collection ? collection.length : 0,\n        result = Array(typeof length == 'number' ? length : 0);\n\n    forEach(collection, function(value) {\n      result[++index] = (isFunc ? methodName : value[methodName]).apply(value, args);\n    });\n    return result;\n  }\n\n  /**\n   * Creates an array of values by running each element in the collection\n   * through the callback. The callback is bound to `thisArg` and invoked with\n   * three arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias collect\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a new array of the results of each `callback` execution.\n   * @example\n   *\n   * _.map([1, 2, 3], function(num) { return num * 3; });\n   * // => [3, 6, 9]\n   *\n   * _.map({ 'one': 1, 'two': 2, 'three': 3 }, function(num) { return num * 3; });\n   * // => [3, 6, 9] (property order is not guaranteed across environments)\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.map(characters, 'name');\n   * // => ['barney', 'fred']\n   */\n  function map(collection, callback, thisArg) {\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    callback = createCallback(callback, thisArg, 3);\n    if (typeof length == 'number') {\n      var result = Array(length);\n      while (++index < length) {\n        result[index] = callback(collection[index], index, collection);\n      }\n    } else {\n      result = [];\n      forOwn(collection, function(value, key, collection) {\n        result[++index] = callback(value, key, collection);\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Retrieves the maximum value of a collection. If the collection is empty or\n   * falsey `-Infinity` is returned. If a callback is provided it will be executed\n   * for each value in the collection to generate the criterion by which the value\n   * is ranked. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, index, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the maximum value.\n   * @example\n   *\n   * _.max([4, 2, 8, 6]);\n   * // => 8\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * _.max(characters, function(chr) { return chr.age; });\n   * // => { 'name': 'fred', 'age': 40 };\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.max(characters, 'age');\n   * // => { 'name': 'fred', 'age': 40 };\n   */\n  function max(collection, callback, thisArg) {\n    var computed = -Infinity,\n        result = computed;\n\n    // allows working with functions like `_.map` without using\n    // their `index` argument as a callback\n    if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n      callback = null;\n    }\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (callback == null && typeof length == 'number') {\n      while (++index < length) {\n        var value = collection[index];\n        if (value > result) {\n          result = value;\n        }\n      }\n    } else {\n      callback = createCallback(callback, thisArg, 3);\n\n      forEach(collection, function(value, index, collection) {\n        var current = callback(value, index, collection);\n        if (current > computed) {\n          computed = current;\n          result = value;\n        }\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Retrieves the minimum value of a collection. If the collection is empty or\n   * falsey `Infinity` is returned. If a callback is provided it will be executed\n   * for each value in the collection to generate the criterion by which the value\n   * is ranked. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, index, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the minimum value.\n   * @example\n   *\n   * _.min([4, 2, 8, 6]);\n   * // => 2\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * _.min(characters, function(chr) { return chr.age; });\n   * // => { 'name': 'barney', 'age': 36 };\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.min(characters, 'age');\n   * // => { 'name': 'barney', 'age': 36 };\n   */\n  function min(collection, callback, thisArg) {\n    var computed = Infinity,\n        result = computed;\n\n    // allows working with functions like `_.map` without using\n    // their `index` argument as a callback\n    if (typeof callback != 'function' && thisArg && thisArg[callback] === collection) {\n      callback = null;\n    }\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (callback == null && typeof length == 'number') {\n      while (++index < length) {\n        var value = collection[index];\n        if (value < result) {\n          result = value;\n        }\n      }\n    } else {\n      callback = createCallback(callback, thisArg, 3);\n\n      forEach(collection, function(value, index, collection) {\n        var current = callback(value, index, collection);\n        if (current < computed) {\n          computed = current;\n          result = value;\n        }\n      });\n    }\n    return result;\n  }\n\n  /**\n   * Retrieves the value of a specified property from all elements in the collection.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {string} property The name of the property to pluck.\n   * @returns {Array} Returns a new array of property values.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * _.pluck(characters, 'name');\n   * // => ['barney', 'fred']\n   */\n  var pluck = map;\n\n  /**\n   * Reduces a collection to a value which is the accumulated result of running\n   * each element in the collection through the callback, where each successive\n   * callback execution consumes the return value of the previous execution. If\n   * `accumulator` is not provided the first element of the collection will be\n   * used as the initial `accumulator` value. The callback is bound to `thisArg`\n   * and invoked with four arguments; (accumulator, value, index|key, collection).\n   *\n   * @static\n   * @memberOf _\n   * @alias foldl, inject\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [accumulator] Initial value of the accumulator.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the accumulated value.\n   * @example\n   *\n   * var sum = _.reduce([1, 2, 3], function(sum, num) {\n   *   return sum + num;\n   * });\n   * // => 6\n   *\n   * var mapped = _.reduce({ 'a': 1, 'b': 2, 'c': 3 }, function(result, num, key) {\n   *   result[key] = num * 3;\n   *   return result;\n   * }, {});\n   * // => { 'a': 3, 'b': 6, 'c': 9 }\n   */\n  function reduce(collection, callback, accumulator, thisArg) {\n    if (!collection) return accumulator;\n    var noaccum = arguments.length < 3;\n    callback = createCallback(callback, thisArg, 4);\n\n    var index = -1,\n        length = collection.length;\n\n    if (typeof length == 'number') {\n      if (noaccum) {\n        accumulator = collection[++index];\n      }\n      while (++index < length) {\n        accumulator = callback(accumulator, collection[index], index, collection);\n      }\n    } else {\n      forOwn(collection, function(value, index, collection) {\n        accumulator = noaccum\n          ? (noaccum = false, value)\n          : callback(accumulator, value, index, collection)\n      });\n    }\n    return accumulator;\n  }\n\n  /**\n   * This method is like `_.reduce` except that it iterates over elements\n   * of a `collection` from right to left.\n   *\n   * @static\n   * @memberOf _\n   * @alias foldr\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function} [callback=identity] The function called per iteration.\n   * @param {*} [accumulator] Initial value of the accumulator.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the accumulated value.\n   * @example\n   *\n   * var list = [[0, 1], [2, 3], [4, 5]];\n   * var flat = _.reduceRight(list, function(a, b) { return a.concat(b); }, []);\n   * // => [4, 5, 2, 3, 0, 1]\n   */\n  function reduceRight(collection, callback, accumulator, thisArg) {\n    var noaccum = arguments.length < 3;\n    callback = createCallback(callback, thisArg, 4);\n    forEachRight(collection, function(value, index, collection) {\n      accumulator = noaccum\n        ? (noaccum = false, value)\n        : callback(accumulator, value, index, collection);\n    });\n    return accumulator;\n  }\n\n  /**\n   * The opposite of `_.filter` this method returns the elements of a\n   * collection that the callback does **not** return truey for.\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a new array of elements that failed the callback check.\n   * @example\n   *\n   * var odds = _.reject([1, 2, 3, 4, 5, 6], function(num) { return num % 2 == 0; });\n   * // => [1, 3, 5]\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36, 'blocked': false },\n   *   { 'name': 'fred',   'age': 40, 'blocked': true }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.reject(characters, 'blocked');\n   * // => [{ 'name': 'barney', 'age': 36, 'blocked': false }]\n   *\n   * // using \"_.where\" callback shorthand\n   * _.reject(characters, { 'age': 36 });\n   * // => [{ 'name': 'fred', 'age': 40, 'blocked': true }]\n   */\n  function reject(collection, callback, thisArg) {\n    callback = createCallback(callback, thisArg, 3);\n    return filter(collection, function(value, index, collection) {\n      return !callback(value, index, collection);\n    });\n  }\n\n  /**\n   * Retrieves a random element or `n` random elements from a collection.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to sample.\n   * @param {number} [n] The number of elements to sample.\n   * @param- {Object} [guard] Allows working with functions like `_.map`\n   *  without using their `index` arguments as `n`.\n   * @returns {Array} Returns the random sample(s) of `collection`.\n   * @example\n   *\n   * _.sample([1, 2, 3, 4]);\n   * // => 2\n   *\n   * _.sample([1, 2, 3, 4], 2);\n   * // => [3, 1]\n   */\n  function sample(collection, n, guard) {\n    if (collection && typeof collection.length != 'number') {\n      collection = values(collection);\n    }\n    if (n == null || guard) {\n      return collection ? collection[baseRandom(0, collection.length - 1)] : undefined;\n    }\n    var result = shuffle(collection);\n    result.length = nativeMin(nativeMax(0, n), result.length);\n    return result;\n  }\n\n  /**\n   * Creates an array of shuffled values, using a version of the Fisher-Yates\n   * shuffle. See http://en.wikipedia.org/wiki/Fisher-Yates_shuffle.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to shuffle.\n   * @returns {Array} Returns a new shuffled collection.\n   * @example\n   *\n   * _.shuffle([1, 2, 3, 4, 5, 6]);\n   * // => [4, 1, 6, 3, 5, 2]\n   */\n  function shuffle(collection) {\n    var index = -1,\n        length = collection ? collection.length : 0,\n        result = Array(typeof length == 'number' ? length : 0);\n\n    forEach(collection, function(value) {\n      var rand = baseRandom(0, ++index);\n      result[index] = result[rand];\n      result[rand] = value;\n    });\n    return result;\n  }\n\n  /**\n   * Gets the size of the `collection` by returning `collection.length` for arrays\n   * and array-like objects or the number of own enumerable properties for objects.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to inspect.\n   * @returns {number} Returns `collection.length` or number of own enumerable properties.\n   * @example\n   *\n   * _.size([1, 2]);\n   * // => 2\n   *\n   * _.size({ 'one': 1, 'two': 2, 'three': 3 });\n   * // => 3\n   *\n   * _.size('pebbles');\n   * // => 7\n   */\n  function size(collection) {\n    var length = collection ? collection.length : 0;\n    return typeof length == 'number' ? length : keys(collection).length;\n  }\n\n  /**\n   * Checks if the callback returns a truey value for **any** element of a\n   * collection. The function returns as soon as it finds a passing value and\n   * does not iterate over the entire collection. The callback is bound to\n   * `thisArg` and invoked with three arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias any\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {boolean} Returns `true` if any element passed the callback check,\n   *  else `false`.\n   * @example\n   *\n   * _.some([null, 0, 'yes', false], Boolean);\n   * // => true\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36, 'blocked': false },\n   *   { 'name': 'fred',   'age': 40, 'blocked': true }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.some(characters, 'blocked');\n   * // => true\n   *\n   * // using \"_.where\" callback shorthand\n   * _.some(characters, { 'age': 1 });\n   * // => false\n   */\n  function some(collection, callback, thisArg) {\n    var result;\n    callback = createCallback(callback, thisArg, 3);\n\n    var index = -1,\n        length = collection ? collection.length : 0;\n\n    if (typeof length == 'number') {\n      while (++index < length) {\n        if ((result = callback(collection[index], index, collection))) {\n          break;\n        }\n      }\n    } else {\n      forOwn(collection, function(value, index, collection) {\n        return (result = callback(value, index, collection)) && indicatorObject;\n      });\n    }\n    return !!result;\n  }\n\n  /**\n   * Creates an array of elements, sorted in ascending order by the results of\n   * running each element in a collection through the callback. This method\n   * performs a stable sort, that is, it will preserve the original sort order\n   * of equal elements. The callback is bound to `thisArg` and invoked with\n   * three arguments; (value, index|key, collection).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an array of property names is provided for `callback` the collection\n   * will be sorted by each property value.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Array|Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a new array of sorted elements.\n   * @example\n   *\n   * _.sortBy([1, 2, 3], function(num) { return Math.sin(num); });\n   * // => [3, 1, 2]\n   *\n   * _.sortBy([1, 2, 3], function(num) { return this.sin(num); }, Math);\n   * // => [3, 1, 2]\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'age': 36 },\n   *   { 'name': 'fred',    'age': 40 },\n   *   { 'name': 'barney',  'age': 26 },\n   *   { 'name': 'fred',    'age': 30 }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.map(_.sortBy(characters, 'age'), _.values);\n   * // => [['barney', 26], ['fred', 30], ['barney', 36], ['fred', 40]]\n   *\n   * // sorting by multiple properties\n   * _.map(_.sortBy(characters, ['name', 'age']), _.values);\n   * // = > [['barney', 26], ['barney', 36], ['fred', 30], ['fred', 40]]\n   */\n  function sortBy(collection, callback, thisArg) {\n    var index = -1,\n        length = collection ? collection.length : 0,\n        result = Array(typeof length == 'number' ? length : 0);\n\n    callback = createCallback(callback, thisArg, 3);\n    forEach(collection, function(value, key, collection) {\n      result[++index] = {\n        'criteria': [callback(value, key, collection)],\n        'index': index,\n        'value': value\n      };\n    });\n\n    length = result.length;\n    result.sort(compareAscending);\n    while (length--) {\n      result[length] = result[length].value;\n    }\n    return result;\n  }\n\n  /**\n   * Converts the `collection` to an array.\n   *\n   * @static\n   * @memberOf _\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to convert.\n   * @returns {Array} Returns the new converted array.\n   * @example\n   *\n   * (function() { return _.toArray(arguments).slice(1); })(1, 2, 3, 4);\n   * // => [2, 3, 4]\n   */\n  function toArray(collection) {\n    if (isArray(collection)) {\n      return slice(collection);\n    }\n    if (collection && typeof collection.length == 'number') {\n      return map(collection);\n    }\n    return values(collection);\n  }\n\n  /**\n   * Performs a deep comparison of each element in a `collection` to the given\n   * `properties` object, returning an array of all elements that have equivalent\n   * property values.\n   *\n   * @static\n   * @memberOf _\n   * @type Function\n   * @category Collections\n   * @param {Array|Object|string} collection The collection to iterate over.\n   * @param {Object} props The object of property values to filter by.\n   * @returns {Array} Returns a new array of elements that have the given properties.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36, 'pets': ['hoppy'] },\n   *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n   * ];\n   *\n   * _.where(characters, { 'age': 36 });\n   * // => [{ 'name': 'barney', 'age': 36, 'pets': ['hoppy'] }]\n   *\n   * _.where(characters, { 'pets': ['dino'] });\n   * // => [{ 'name': 'fred', 'age': 40, 'pets': ['baby puss', 'dino'] }]\n   */\n  function where(collection, properties, first) {\n    return (first && isEmpty(properties))\n      ? undefined\n      : (first ? find : filter)(collection, properties);\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates an array with all falsey values removed. The values `false`, `null`,\n   * `0`, `\"\"`, `undefined`, and `NaN` are all falsey.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to compact.\n   * @returns {Array} Returns a new array of filtered values.\n   * @example\n   *\n   * _.compact([0, 1, false, 2, '', 3]);\n   * // => [1, 2, 3]\n   */\n  function compact(array) {\n    var index = -1,\n        length = array ? array.length : 0,\n        result = [];\n\n    while (++index < length) {\n      var value = array[index];\n      if (value) {\n        result.push(value);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Creates an array excluding all values of the provided arrays using strict\n   * equality for comparisons, i.e. `===`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to process.\n   * @param {...Array} [values] The arrays of values to exclude.\n   * @returns {Array} Returns a new array of filtered values.\n   * @example\n   *\n   * _.difference([1, 2, 3, 4, 5], [5, 2, 10]);\n   * // => [1, 3, 4]\n   */\n  function difference(array) {\n    return baseDifference(array, baseFlatten(arguments, true, true, 1));\n  }\n\n  /**\n   * Gets the first element or first `n` elements of an array. If a callback\n   * is provided elements at the beginning of the array are returned as long\n   * as the callback returns truey. The callback is bound to `thisArg` and\n   * invoked with three arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias head, take\n   * @category Arrays\n   * @param {Array} array The array to query.\n   * @param {Function|Object|number|string} [callback] The function called\n   *  per element or the number of elements to return. If a property name or\n   *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n   *  style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the first element(s) of `array`.\n   * @example\n   *\n   * _.first([1, 2, 3]);\n   * // => 1\n   *\n   * _.first([1, 2, 3], 2);\n   * // => [1, 2]\n   *\n   * _.first([1, 2, 3], function(num) {\n   *   return num < 3;\n   * });\n   * // => [1, 2]\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n   *   { 'name': 'fred',    'blocked': false, 'employer': 'slate' },\n   *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.first(characters, 'blocked');\n   * // => [{ 'name': 'barney', 'blocked': true, 'employer': 'slate' }]\n   *\n   * // using \"_.where\" callback shorthand\n   * _.pluck(_.first(characters, { 'employer': 'slate' }), 'name');\n   * // => ['barney', 'fred']\n   */\n  function first(array, callback, thisArg) {\n    var n = 0,\n        length = array ? array.length : 0;\n\n    if (typeof callback != 'number' && callback != null) {\n      var index = -1;\n      callback = createCallback(callback, thisArg, 3);\n      while (++index < length && callback(array[index], index, array)) {\n        n++;\n      }\n    } else {\n      n = callback;\n      if (n == null || thisArg) {\n        return array ? array[0] : undefined;\n      }\n    }\n    return slice(array, 0, nativeMin(nativeMax(0, n), length));\n  }\n\n  /**\n   * Flattens a nested array (the nesting can be to any depth). If `isShallow`\n   * is truey, the array will only be flattened a single level. If a callback\n   * is provided each element of the array is passed through the callback before\n   * flattening. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to flatten.\n   * @param {boolean} [isShallow=false] A flag to restrict flattening to a single level.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a new flattened array.\n   * @example\n   *\n   * _.flatten([1, [2], [3, [[4]]]]);\n   * // => [1, 2, 3, 4];\n   *\n   * _.flatten([1, [2], [3, [[4]]]], true);\n   * // => [1, 2, 3, [[4]]];\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 30, 'pets': ['hoppy'] },\n   *   { 'name': 'fred',   'age': 40, 'pets': ['baby puss', 'dino'] }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.flatten(characters, 'pets');\n   * // => ['hoppy', 'baby puss', 'dino']\n   */\n  function flatten(array, isShallow) {\n    return baseFlatten(array, isShallow);\n  }\n\n  /**\n   * Gets the index at which the first occurrence of `value` is found using\n   * strict equality for comparisons, i.e. `===`. If the array is already sorted\n   * providing `true` for `fromIndex` will run a faster binary search.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to search.\n   * @param {*} value The value to search for.\n   * @param {boolean|number} [fromIndex=0] The index to search from or `true`\n   *  to perform a binary search on a sorted array.\n   * @returns {number} Returns the index of the matched value or `-1`.\n   * @example\n   *\n   * _.indexOf([1, 2, 3, 1, 2, 3], 2);\n   * // => 1\n   *\n   * _.indexOf([1, 2, 3, 1, 2, 3], 2, 3);\n   * // => 4\n   *\n   * _.indexOf([1, 1, 2, 2, 3, 3], 2, true);\n   * // => 2\n   */\n  function indexOf(array, value, fromIndex) {\n    if (typeof fromIndex == 'number') {\n      var length = array ? array.length : 0;\n      fromIndex = (fromIndex < 0 ? nativeMax(0, length + fromIndex) : fromIndex || 0);\n    } else if (fromIndex) {\n      var index = sortedIndex(array, value);\n      return array[index] === value ? index : -1;\n    }\n    return baseIndexOf(array, value, fromIndex);\n  }\n\n  /**\n   * Gets all but the last element or last `n` elements of an array. If a\n   * callback is provided elements at the end of the array are excluded from\n   * the result as long as the callback returns truey. The callback is bound\n   * to `thisArg` and invoked with three arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to query.\n   * @param {Function|Object|number|string} [callback=1] The function called\n   *  per element or the number of elements to exclude. If a property name or\n   *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n   *  style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a slice of `array`.\n   * @example\n   *\n   * _.initial([1, 2, 3]);\n   * // => [1, 2]\n   *\n   * _.initial([1, 2, 3], 2);\n   * // => [1]\n   *\n   * _.initial([1, 2, 3], function(num) {\n   *   return num > 1;\n   * });\n   * // => [1]\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n   *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n   *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.initial(characters, 'blocked');\n   * // => [{ 'name': 'barney',  'blocked': false, 'employer': 'slate' }]\n   *\n   * // using \"_.where\" callback shorthand\n   * _.pluck(_.initial(characters, { 'employer': 'na' }), 'name');\n   * // => ['barney', 'fred']\n   */\n  function initial(array, callback, thisArg) {\n    var n = 0,\n        length = array ? array.length : 0;\n\n    if (typeof callback != 'number' && callback != null) {\n      var index = length;\n      callback = createCallback(callback, thisArg, 3);\n      while (index-- && callback(array[index], index, array)) {\n        n++;\n      }\n    } else {\n      n = (callback == null || thisArg) ? 1 : callback || n;\n    }\n    return slice(array, 0, nativeMin(nativeMax(0, length - n), length));\n  }\n\n  /**\n   * Creates an array of unique values present in all provided arrays using\n   * strict equality for comparisons, i.e. `===`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {...Array} [array] The arrays to inspect.\n   * @returns {Array} Returns an array of shared values.\n   * @example\n   *\n   * _.intersection([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n   * // => [1, 2]\n   */\n  function intersection() {\n    var args = [],\n        argsIndex = -1,\n        argsLength = arguments.length;\n\n    while (++argsIndex < argsLength) {\n      var value = arguments[argsIndex];\n       if (isArray(value) || isArguments(value)) {\n         args.push(value);\n       }\n    }\n    var array = args[0],\n        index = -1,\n        indexOf = getIndexOf(),\n        length = array ? array.length : 0,\n        result = [];\n\n    outer:\n    while (++index < length) {\n      value = array[index];\n      if (indexOf(result, value) < 0) {\n        var argsIndex = argsLength;\n        while (--argsIndex) {\n          if (indexOf(args[argsIndex], value) < 0) {\n            continue outer;\n          }\n        }\n        result.push(value);\n      }\n    }\n    return result;\n  }\n\n  /**\n   * Gets the last element or last `n` elements of an array. If a callback is\n   * provided elements at the end of the array are returned as long as the\n   * callback returns truey. The callback is bound to `thisArg` and invoked\n   * with three arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to query.\n   * @param {Function|Object|number|string} [callback] The function called\n   *  per element or the number of elements to return. If a property name or\n   *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n   *  style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {*} Returns the last element(s) of `array`.\n   * @example\n   *\n   * _.last([1, 2, 3]);\n   * // => 3\n   *\n   * _.last([1, 2, 3], 2);\n   * // => [2, 3]\n   *\n   * _.last([1, 2, 3], function(num) {\n   *   return num > 1;\n   * });\n   * // => [2, 3]\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'blocked': false, 'employer': 'slate' },\n   *   { 'name': 'fred',    'blocked': true,  'employer': 'slate' },\n   *   { 'name': 'pebbles', 'blocked': true,  'employer': 'na' }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.pluck(_.last(characters, 'blocked'), 'name');\n   * // => ['fred', 'pebbles']\n   *\n   * // using \"_.where\" callback shorthand\n   * _.last(characters, { 'employer': 'na' });\n   * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n   */\n  function last(array, callback, thisArg) {\n    var n = 0,\n        length = array ? array.length : 0;\n\n    if (typeof callback != 'number' && callback != null) {\n      var index = length;\n      callback = createCallback(callback, thisArg, 3);\n      while (index-- && callback(array[index], index, array)) {\n        n++;\n      }\n    } else {\n      n = callback;\n      if (n == null || thisArg) {\n        return array ? array[length - 1] : undefined;\n      }\n    }\n    return slice(array, nativeMax(0, length - n));\n  }\n\n  /**\n   * Gets the index at which the last occurrence of `value` is found using strict\n   * equality for comparisons, i.e. `===`. If `fromIndex` is negative, it is used\n   * as the offset from the end of the collection.\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to search.\n   * @param {*} value The value to search for.\n   * @param {number} [fromIndex=array.length-1] The index to search from.\n   * @returns {number} Returns the index of the matched value or `-1`.\n   * @example\n   *\n   * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2);\n   * // => 4\n   *\n   * _.lastIndexOf([1, 2, 3, 1, 2, 3], 2, 3);\n   * // => 1\n   */\n  function lastIndexOf(array, value, fromIndex) {\n    var index = array ? array.length : 0;\n    if (typeof fromIndex == 'number') {\n      index = (fromIndex < 0 ? nativeMax(0, index + fromIndex) : nativeMin(fromIndex, index - 1)) + 1;\n    }\n    while (index--) {\n      if (array[index] === value) {\n        return index;\n      }\n    }\n    return -1;\n  }\n\n  /**\n   * Creates an array of numbers (positive and/or negative) progressing from\n   * `start` up to but not including `end`. If `start` is less than `stop` a\n   * zero-length range is created unless a negative `step` is specified.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {number} [start=0] The start of the range.\n   * @param {number} end The end of the range.\n   * @param {number} [step=1] The value to increment or decrement by.\n   * @returns {Array} Returns a new range array.\n   * @example\n   *\n   * _.range(4);\n   * // => [0, 1, 2, 3]\n   *\n   * _.range(1, 5);\n   * // => [1, 2, 3, 4]\n   *\n   * _.range(0, 20, 5);\n   * // => [0, 5, 10, 15]\n   *\n   * _.range(0, -4, -1);\n   * // => [0, -1, -2, -3]\n   *\n   * _.range(1, 4, 0);\n   * // => [1, 1, 1]\n   *\n   * _.range(0);\n   * // => []\n   */\n  function range(start, end, step) {\n    start = +start || 0;\n    step =  (+step || 1);\n\n    if (end == null) {\n      end = start;\n      start = 0;\n    }\n    // use `Array(length)` so engines like Chakra and V8 avoid slower modes\n    // http://youtu.be/XAqIpGU8ZZk#t=17m25s\n    var index = -1,\n        length = nativeMax(0, ceil((end - start) / step)),\n        result = Array(length);\n\n    while (++index < length) {\n      result[index] = start;\n      start += step;\n    }\n    return result;\n  }\n\n  /**\n   * The opposite of `_.initial` this method gets all but the first element or\n   * first `n` elements of an array. If a callback function is provided elements\n   * at the beginning of the array are excluded from the result as long as the\n   * callback returns truey. The callback is bound to `thisArg` and invoked\n   * with three arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias drop, tail\n   * @category Arrays\n   * @param {Array} array The array to query.\n   * @param {Function|Object|number|string} [callback=1] The function called\n   *  per element or the number of elements to exclude. If a property name or\n   *  object is provided it will be used to create a \"_.pluck\" or \"_.where\"\n   *  style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a slice of `array`.\n   * @example\n   *\n   * _.rest([1, 2, 3]);\n   * // => [2, 3]\n   *\n   * _.rest([1, 2, 3], 2);\n   * // => [3]\n   *\n   * _.rest([1, 2, 3], function(num) {\n   *   return num < 3;\n   * });\n   * // => [3]\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'blocked': true,  'employer': 'slate' },\n   *   { 'name': 'fred',    'blocked': false,  'employer': 'slate' },\n   *   { 'name': 'pebbles', 'blocked': true, 'employer': 'na' }\n   * ];\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.pluck(_.rest(characters, 'blocked'), 'name');\n   * // => ['fred', 'pebbles']\n   *\n   * // using \"_.where\" callback shorthand\n   * _.rest(characters, { 'employer': 'slate' });\n   * // => [{ 'name': 'pebbles', 'blocked': true, 'employer': 'na' }]\n   */\n  function rest(array, callback, thisArg) {\n    if (typeof callback != 'number' && callback != null) {\n      var n = 0,\n          index = -1,\n          length = array ? array.length : 0;\n\n      callback = createCallback(callback, thisArg, 3);\n      while (++index < length && callback(array[index], index, array)) {\n        n++;\n      }\n    } else {\n      n = (callback == null || thisArg) ? 1 : nativeMax(0, callback);\n    }\n    return slice(array, n);\n  }\n\n  /**\n   * Uses a binary search to determine the smallest index at which a value\n   * should be inserted into a given sorted array in order to maintain the sort\n   * order of the array. If a callback is provided it will be executed for\n   * `value` and each element of `array` to compute their sort ranking. The\n   * callback is bound to `thisArg` and invoked with one argument; (value).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to inspect.\n   * @param {*} value The value to evaluate.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {number} Returns the index at which `value` should be inserted\n   *  into `array`.\n   * @example\n   *\n   * _.sortedIndex([20, 30, 50], 40);\n   * // => 2\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.sortedIndex([{ 'x': 20 }, { 'x': 30 }, { 'x': 50 }], { 'x': 40 }, 'x');\n   * // => 2\n   *\n   * var dict = {\n   *   'wordToNumber': { 'twenty': 20, 'thirty': 30, 'fourty': 40, 'fifty': 50 }\n   * };\n   *\n   * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n   *   return dict.wordToNumber[word];\n   * });\n   * // => 2\n   *\n   * _.sortedIndex(['twenty', 'thirty', 'fifty'], 'fourty', function(word) {\n   *   return this.wordToNumber[word];\n   * }, dict);\n   * // => 2\n   */\n  function sortedIndex(array, value, callback, thisArg) {\n    var low = 0,\n        high = array ? array.length : low;\n\n    // explicitly reference `identity` for better inlining in Firefox\n    callback = callback ? createCallback(callback, thisArg, 1) : identity;\n    value = callback(value);\n\n    while (low < high) {\n      var mid = (low + high) >>> 1;\n      (callback(array[mid]) < value)\n        ? low = mid + 1\n        : high = mid;\n    }\n    return low;\n  }\n\n  /**\n   * Creates an array of unique values, in order, of the provided arrays using\n   * strict equality for comparisons, i.e. `===`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {...Array} [array] The arrays to inspect.\n   * @returns {Array} Returns an array of combined values.\n   * @example\n   *\n   * _.union([1, 2, 3], [5, 2, 1, 4], [2, 1]);\n   * // => [1, 2, 3, 5, 4]\n   */\n  function union() {\n    return baseUniq(baseFlatten(arguments, true, true));\n  }\n\n  /**\n   * Creates a duplicate-value-free version of an array using strict equality\n   * for comparisons, i.e. `===`. If the array is sorted, providing\n   * `true` for `isSorted` will use a faster algorithm. If a callback is provided\n   * each element of `array` is passed through the callback before uniqueness\n   * is computed. The callback is bound to `thisArg` and invoked with three\n   * arguments; (value, index, array).\n   *\n   * If a property name is provided for `callback` the created \"_.pluck\" style\n   * callback will return the property value of the given element.\n   *\n   * If an object is provided for `callback` the created \"_.where\" style callback\n   * will return `true` for elements that have the properties of the given object,\n   * else `false`.\n   *\n   * @static\n   * @memberOf _\n   * @alias unique\n   * @category Arrays\n   * @param {Array} array The array to process.\n   * @param {boolean} [isSorted=false] A flag to indicate that `array` is sorted.\n   * @param {Function|Object|string} [callback=identity] The function called\n   *  per iteration. If a property name or object is provided it will be used\n   *  to create a \"_.pluck\" or \"_.where\" style callback, respectively.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns a duplicate-value-free array.\n   * @example\n   *\n   * _.uniq([1, 2, 1, 3, 1]);\n   * // => [1, 2, 3]\n   *\n   * _.uniq([1, 1, 2, 2, 3], true);\n   * // => [1, 2, 3]\n   *\n   * _.uniq(['A', 'b', 'C', 'a', 'B', 'c'], function(letter) { return letter.toLowerCase(); });\n   * // => ['A', 'b', 'C']\n   *\n   * _.uniq([1, 2.5, 3, 1.5, 2, 3.5], function(num) { return this.floor(num); }, Math);\n   * // => [1, 2.5, 3]\n   *\n   * // using \"_.pluck\" callback shorthand\n   * _.uniq([{ 'x': 1 }, { 'x': 2 }, { 'x': 1 }], 'x');\n   * // => [{ 'x': 1 }, { 'x': 2 }]\n   */\n  function uniq(array, isSorted, callback, thisArg) {\n    // juggle arguments\n    if (typeof isSorted != 'boolean' && isSorted != null) {\n      thisArg = callback;\n      callback = (typeof isSorted != 'function' && thisArg && thisArg[isSorted] === array) ? null : isSorted;\n      isSorted = false;\n    }\n    if (callback != null) {\n      callback = createCallback(callback, thisArg, 3);\n    }\n    return baseUniq(array, isSorted, callback);\n  }\n\n  /**\n   * Creates an array excluding all provided values using strict equality for\n   * comparisons, i.e. `===`.\n   *\n   * @static\n   * @memberOf _\n   * @category Arrays\n   * @param {Array} array The array to filter.\n   * @param {...*} [value] The values to exclude.\n   * @returns {Array} Returns a new array of filtered values.\n   * @example\n   *\n   * _.without([1, 2, 1, 0, 3, 1, 4], 0, 1);\n   * // => [2, 3, 4]\n   */\n  function without(array) {\n    return baseDifference(array, slice(arguments, 1));\n  }\n\n  /**\n   * Creates an array of grouped elements, the first of which contains the first\n   * elements of the given arrays, the second of which contains the second\n   * elements of the given arrays, and so on.\n   *\n   * @static\n   * @memberOf _\n   * @alias unzip\n   * @category Arrays\n   * @param {...Array} [array] Arrays to process.\n   * @returns {Array} Returns a new array of grouped elements.\n   * @example\n   *\n   * _.zip(['fred', 'barney'], [30, 40], [true, false]);\n   * // => [['fred', 30, true], ['barney', 40, false]]\n   */\n  function zip() {\n    var index = -1,\n        length = max(pluck(arguments, 'length')),\n        result = Array(length < 0 ? 0 : length);\n\n    while (++index < length) {\n      result[index] = pluck(arguments, index);\n    }\n    return result;\n  }\n\n  /**\n   * Creates an object composed from arrays of `keys` and `values`. Provide\n   * either a single two dimensional array, i.e. `[[key1, value1], [key2, value2]]`\n   * or two arrays, one of `keys` and one of corresponding `values`.\n   *\n   * @static\n   * @memberOf _\n   * @alias object\n   * @category Arrays\n   * @param {Array} keys The array of keys.\n   * @param {Array} [values=[]] The array of values.\n   * @returns {Object} Returns an object composed of the given keys and\n   *  corresponding values.\n   * @example\n   *\n   * _.zipObject(['fred', 'barney'], [30, 40]);\n   * // => { 'fred': 30, 'barney': 40 }\n   */\n  function zipObject(keys, values) {\n    var index = -1,\n        length = keys ? keys.length : 0,\n        result = {};\n\n    if (!values && length && !isArray(keys[0])) {\n      values = [];\n    }\n    while (++index < length) {\n      var key = keys[index];\n      if (values) {\n        result[key] = values[index];\n      } else if (key) {\n        result[key[0]] = key[1];\n      }\n    }\n    return result;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates a function that executes `func`, with  the `this` binding and\n   * arguments of the created function, only after being called `n` times.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {number} n The number of times the function must be called before\n   *  `func` is executed.\n   * @param {Function} func The function to restrict.\n   * @returns {Function} Returns the new restricted function.\n   * @example\n   *\n   * var saves = ['profile', 'settings'];\n   *\n   * var done = _.after(saves.length, function() {\n   *   console.log('Done saving!');\n   * });\n   *\n   * _.forEach(saves, function(type) {\n   *   asyncSave({ 'type': type, 'complete': done });\n   * });\n   * // => logs 'Done saving!', after all saves have completed\n   */\n  function after(n, func) {\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    return function() {\n      if (--n < 1) {\n        return func.apply(this, arguments);\n      }\n    };\n  }\n\n  /**\n   * Creates a function that, when called, invokes `func` with the `this`\n   * binding of `thisArg` and prepends any additional `bind` arguments to those\n   * provided to the bound function.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to bind.\n   * @param {*} [thisArg] The `this` binding of `func`.\n   * @param {...*} [arg] Arguments to be partially applied.\n   * @returns {Function} Returns the new bound function.\n   * @example\n   *\n   * var func = function(greeting) {\n   *   return greeting + ' ' + this.name;\n   * };\n   *\n   * func = _.bind(func, { 'name': 'fred' }, 'hi');\n   * func();\n   * // => 'hi fred'\n   */\n  function bind(func, thisArg) {\n    return arguments.length > 2\n      ? createWrapper(func, 17, slice(arguments, 2), null, thisArg)\n      : createWrapper(func, 1, null, null, thisArg);\n  }\n\n  /**\n   * Binds methods of an object to the object itself, overwriting the existing\n   * method. Method names may be specified as individual arguments or as arrays\n   * of method names. If no method names are provided all the function properties\n   * of `object` will be bound.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Object} object The object to bind and assign the bound methods to.\n   * @param {...string} [methodName] The object method names to\n   *  bind, specified as individual method names or arrays of method names.\n   * @returns {Object} Returns `object`.\n   * @example\n   *\n   * var view = {\n   *   'label': 'docs',\n   *   'onClick': function() { console.log('clicked ' + this.label); }\n   * };\n   *\n   * _.bindAll(view);\n   * jQuery('#docs').on('click', view.onClick);\n   * // => logs 'clicked docs', when the button is clicked\n   */\n  function bindAll(object) {\n    var funcs = arguments.length > 1 ? baseFlatten(arguments, true, false, 1) : functions(object),\n        index = -1,\n        length = funcs.length;\n\n    while (++index < length) {\n      var key = funcs[index];\n      object[key] = createWrapper(object[key], 1, null, null, object);\n    }\n    return object;\n  }\n\n  /**\n   * Creates a function that is the composition of the provided functions,\n   * where each function consumes the return value of the function that follows.\n   * For example, composing the functions `f()`, `g()`, and `h()` produces `f(g(h()))`.\n   * Each function is executed with the `this` binding of the composed function.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {...Function} [func] Functions to compose.\n   * @returns {Function} Returns the new composed function.\n   * @example\n   *\n   * var realNameMap = {\n   *   'pebbles': 'penelope'\n   * };\n   *\n   * var format = function(name) {\n   *   name = realNameMap[name.toLowerCase()] || name;\n   *   return name.charAt(0).toUpperCase() + name.slice(1).toLowerCase();\n   * };\n   *\n   * var greet = function(formatted) {\n   *   return 'Hiya ' + formatted + '!';\n   * };\n   *\n   * var welcome = _.compose(greet, format);\n   * welcome('pebbles');\n   * // => 'Hiya Penelope!'\n   */\n  function compose() {\n    var funcs = arguments,\n        length = funcs.length;\n\n    while (length--) {\n      if (!isFunction(funcs[length])) {\n        throw new TypeError;\n      }\n    }\n    return function() {\n      var args = arguments,\n          length = funcs.length;\n\n      while (length--) {\n        args = [funcs[length].apply(this, args)];\n      }\n      return args[0];\n    };\n  }\n\n  /**\n   * Creates a function that will delay the execution of `func` until after\n   * `wait` milliseconds have elapsed since the last time it was invoked.\n   * Provide an options object to indicate that `func` should be invoked on\n   * the leading and/or trailing edge of the `wait` timeout. Subsequent calls\n   * to the debounced function will return the result of the last `func` call.\n   *\n   * Note: If `leading` and `trailing` options are `true` `func` will be called\n   * on the trailing edge of the timeout only if the the debounced function is\n   * invoked more than once during the `wait` timeout.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to debounce.\n   * @param {number} wait The number of milliseconds to delay.\n   * @param {Object} [options] The options object.\n   * @param {boolean} [options.leading=false] Specify execution on the leading edge of the timeout.\n   * @param {number} [options.maxWait] The maximum time `func` is allowed to be delayed before it's called.\n   * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n   * @returns {Function} Returns the new debounced function.\n   * @example\n   *\n   * // avoid costly calculations while the window size is in flux\n   * var lazyLayout = _.debounce(calculateLayout, 150);\n   * jQuery(window).on('resize', lazyLayout);\n   *\n   * // execute `sendMail` when the click event is fired, debouncing subsequent calls\n   * jQuery('#postbox').on('click', _.debounce(sendMail, 300, {\n   *   'leading': true,\n   *   'trailing': false\n   * });\n   *\n   * // ensure `batchLog` is executed once after 1 second of debounced calls\n   * var source = new EventSource('/stream');\n   * source.addEventListener('message', _.debounce(batchLog, 250, {\n   *   'maxWait': 1000\n   * }, false);\n   */\n  function debounce(func, wait, options) {\n    var args,\n        maxTimeoutId,\n        result,\n        stamp,\n        thisArg,\n        timeoutId,\n        trailingCall,\n        lastCalled = 0,\n        maxWait = false,\n        trailing = true;\n\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    wait = nativeMax(0, wait) || 0;\n    if (options === true) {\n      var leading = true;\n      trailing = false;\n    } else if (isObject(options)) {\n      leading = options.leading;\n      maxWait = 'maxWait' in options && (nativeMax(wait, options.maxWait) || 0);\n      trailing = 'trailing' in options ? options.trailing : trailing;\n    }\n    var delayed = function() {\n      var remaining = wait - (now() - stamp);\n      if (remaining <= 0) {\n        if (maxTimeoutId) {\n          clearTimeout(maxTimeoutId);\n        }\n        var isCalled = trailingCall;\n        maxTimeoutId = timeoutId = trailingCall = undefined;\n        if (isCalled) {\n          lastCalled = now();\n          result = func.apply(thisArg, args);\n          if (!timeoutId && !maxTimeoutId) {\n            args = thisArg = null;\n          }\n        }\n      } else {\n        timeoutId = setTimeout(delayed, remaining);\n      }\n    };\n\n    var maxDelayed = function() {\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n      }\n      maxTimeoutId = timeoutId = trailingCall = undefined;\n      if (trailing || (maxWait !== wait)) {\n        lastCalled = now();\n        result = func.apply(thisArg, args);\n        if (!timeoutId && !maxTimeoutId) {\n          args = thisArg = null;\n        }\n      }\n    };\n\n    return function() {\n      args = arguments;\n      stamp = now();\n      thisArg = this;\n      trailingCall = trailing && (timeoutId || !leading);\n\n      if (maxWait === false) {\n        var leadingCall = leading && !timeoutId;\n      } else {\n        if (!maxTimeoutId && !leading) {\n          lastCalled = stamp;\n        }\n        var remaining = maxWait - (stamp - lastCalled),\n            isCalled = remaining <= 0;\n\n        if (isCalled) {\n          if (maxTimeoutId) {\n            maxTimeoutId = clearTimeout(maxTimeoutId);\n          }\n          lastCalled = stamp;\n          result = func.apply(thisArg, args);\n        }\n        else if (!maxTimeoutId) {\n          maxTimeoutId = setTimeout(maxDelayed, remaining);\n        }\n      }\n      if (isCalled && timeoutId) {\n        timeoutId = clearTimeout(timeoutId);\n      }\n      else if (!timeoutId && wait !== maxWait) {\n        timeoutId = setTimeout(delayed, wait);\n      }\n      if (leadingCall) {\n        isCalled = true;\n        result = func.apply(thisArg, args);\n      }\n      if (isCalled && !timeoutId && !maxTimeoutId) {\n        args = thisArg = null;\n      }\n      return result;\n    };\n  }\n\n  /**\n   * Defers executing the `func` function until the current call stack has cleared.\n   * Additional arguments will be provided to `func` when it is invoked.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to defer.\n   * @param {...*} [arg] Arguments to invoke the function with.\n   * @returns {number} Returns the timer id.\n   * @example\n   *\n   * _.defer(function(text) { console.log(text); }, 'deferred');\n   * // logs 'deferred' after one or more milliseconds\n   */\n  function defer(func) {\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    var args = slice(arguments, 1);\n    return setTimeout(function() { func.apply(undefined, args); }, 1);\n  }\n\n  /**\n   * Executes the `func` function after `wait` milliseconds. Additional arguments\n   * will be provided to `func` when it is invoked.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to delay.\n   * @param {number} wait The number of milliseconds to delay execution.\n   * @param {...*} [arg] Arguments to invoke the function with.\n   * @returns {number} Returns the timer id.\n   * @example\n   *\n   * _.delay(function(text) { console.log(text); }, 1000, 'later');\n   * // => logs 'later' after one second\n   */\n  function delay(func, wait) {\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    var args = slice(arguments, 2);\n    return setTimeout(function() { func.apply(undefined, args); }, wait);\n  }\n\n  /**\n   * Creates a function that memoizes the result of `func`. If `resolver` is\n   * provided it will be used to determine the cache key for storing the result\n   * based on the arguments provided to the memoized function. By default, the\n   * first argument provided to the memoized function is used as the cache key.\n   * The `func` is executed with the `this` binding of the memoized function.\n   * The result cache is exposed as the `cache` property on the memoized function.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to have its output memoized.\n   * @param {Function} [resolver] A function used to resolve the cache key.\n   * @returns {Function} Returns the new memoizing function.\n   * @example\n   *\n   * var fibonacci = _.memoize(function(n) {\n   *   return n < 2 ? n : fibonacci(n - 1) + fibonacci(n - 2);\n   * });\n   *\n   * fibonacci(9)\n   * // => 34\n   *\n   * var data = {\n   *   'fred': { 'name': 'fred', 'age': 40 },\n   *   'pebbles': { 'name': 'pebbles', 'age': 1 }\n   * };\n   *\n   * // modifying the result cache\n   * var get = _.memoize(function(name) { return data[name]; }, _.identity);\n   * get('pebbles');\n   * // => { 'name': 'pebbles', 'age': 1 }\n   *\n   * get.cache.pebbles.name = 'penelope';\n   * get('pebbles');\n   * // => { 'name': 'penelope', 'age': 1 }\n   */\n  function memoize(func, resolver) {\n    var cache = {};\n    return function() {\n      var key = resolver ? resolver.apply(this, arguments) : keyPrefix + arguments[0];\n      return hasOwnProperty.call(cache, key)\n        ? cache[key]\n        : (cache[key] = func.apply(this, arguments));\n    };\n  }\n\n  /**\n   * Creates a function that is restricted to execute `func` once. Repeat calls to\n   * the function will return the value of the first call. The `func` is executed\n   * with the `this` binding of the created function.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to restrict.\n   * @returns {Function} Returns the new restricted function.\n   * @example\n   *\n   * var initialize = _.once(createApplication);\n   * initialize();\n   * initialize();\n   * // `initialize` executes `createApplication` once\n   */\n  function once(func) {\n    var ran,\n        result;\n\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    return function() {\n      if (ran) {\n        return result;\n      }\n      ran = true;\n      result = func.apply(this, arguments);\n\n      // clear the `func` variable so the function may be garbage collected\n      func = null;\n      return result;\n    };\n  }\n\n  /**\n   * Creates a function that, when called, invokes `func` with any additional\n   * `partial` arguments prepended to those provided to the new function. This\n   * method is similar to `_.bind` except it does **not** alter the `this` binding.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to partially apply arguments to.\n   * @param {...*} [arg] Arguments to be partially applied.\n   * @returns {Function} Returns the new partially applied function.\n   * @example\n   *\n   * var greet = function(greeting, name) { return greeting + ' ' + name; };\n   * var hi = _.partial(greet, 'hi');\n   * hi('fred');\n   * // => 'hi fred'\n   */\n  function partial(func) {\n    return createWrapper(func, 16, slice(arguments, 1));\n  }\n\n  /**\n   * Creates a function that, when executed, will only call the `func` function\n   * at most once per every `wait` milliseconds. Provide an options object to\n   * indicate that `func` should be invoked on the leading and/or trailing edge\n   * of the `wait` timeout. Subsequent calls to the throttled function will\n   * return the result of the last `func` call.\n   *\n   * Note: If `leading` and `trailing` options are `true` `func` will be called\n   * on the trailing edge of the timeout only if the the throttled function is\n   * invoked more than once during the `wait` timeout.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {Function} func The function to throttle.\n   * @param {number} wait The number of milliseconds to throttle executions to.\n   * @param {Object} [options] The options object.\n   * @param {boolean} [options.leading=true] Specify execution on the leading edge of the timeout.\n   * @param {boolean} [options.trailing=true] Specify execution on the trailing edge of the timeout.\n   * @returns {Function} Returns the new throttled function.\n   * @example\n   *\n   * // avoid excessively updating the position while scrolling\n   * var throttled = _.throttle(updatePosition, 100);\n   * jQuery(window).on('scroll', throttled);\n   *\n   * // execute `renewToken` when the click event is fired, but not more than once every 5 minutes\n   * jQuery('.interactive').on('click', _.throttle(renewToken, 300000, {\n   *   'trailing': false\n   * }));\n   */\n  function throttle(func, wait, options) {\n    var leading = true,\n        trailing = true;\n\n    if (!isFunction(func)) {\n      throw new TypeError;\n    }\n    if (options === false) {\n      leading = false;\n    } else if (isObject(options)) {\n      leading = 'leading' in options ? options.leading : leading;\n      trailing = 'trailing' in options ? options.trailing : trailing;\n    }\n    options = {};\n    options.leading = leading;\n    options.maxWait = wait;\n    options.trailing = trailing;\n\n    return debounce(func, wait, options);\n  }\n\n  /**\n   * Creates a function that provides `value` to the wrapper function as its\n   * first argument. Additional arguments provided to the function are appended\n   * to those provided to the wrapper function. The wrapper is executed with\n   * the `this` binding of the created function.\n   *\n   * @static\n   * @memberOf _\n   * @category Functions\n   * @param {*} value The value to wrap.\n   * @param {Function} wrapper The wrapper function.\n   * @returns {Function} Returns the new function.\n   * @example\n   *\n   * var p = _.wrap(_.escape, function(func, text) {\n   *   return '<p>' + func(text) + '</p>';\n   * });\n   *\n   * p('Fred, Wilma, & Pebbles');\n   * // => '<p>Fred, Wilma, &amp; Pebbles</p>'\n   */\n  function wrap(value, wrapper) {\n    return createWrapper(wrapper, 16, [value]);\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Produces a callback bound to an optional `thisArg`. If `func` is a property\n   * name the created callback will return the property value for a given element.\n   * If `func` is an object the created callback will return `true` for elements\n   * that contain the equivalent object properties, otherwise it will return `false`.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {*} [func=identity] The value to convert to a callback.\n   * @param {*} [thisArg] The `this` binding of the created callback.\n   * @param {number} [argCount] The number of arguments the callback accepts.\n   * @returns {Function} Returns a callback function.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * // wrap to create custom callback shorthands\n   * _.createCallback = _.wrap(_.createCallback, function(func, callback, thisArg) {\n   *   var match = /^(.+?)__([gl]t)(.+)$/.exec(callback);\n   *   return !match ? func(callback, thisArg) : function(object) {\n   *     return match[2] == 'gt' ? object[match[1]] > match[3] : object[match[1]] < match[3];\n   *   };\n   * });\n   *\n   * _.filter(characters, 'age__gt38');\n   * // => [{ 'name': 'fred', 'age': 40 }]\n   */\n  function createCallback(func, thisArg, argCount) {\n    var type = typeof func;\n    if (func == null || type == 'function') {\n      return baseCreateCallback(func, thisArg, argCount);\n    }\n    // handle \"_.pluck\" style callback shorthands\n    if (type != 'object') {\n      return property(func);\n    }\n    var props = keys(func);\n    return function(object) {\n      var length = props.length,\n          result = false;\n\n      while (length--) {\n        if (!(result = object[props[length]] === func[props[length]])) {\n          break;\n        }\n      }\n      return result;\n    };\n  }\n\n  /**\n   * Converts the characters `&`, `<`, `>`, `\"`, and `'` in `string` to their\n   * corresponding HTML entities.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {string} string The string to escape.\n   * @returns {string} Returns the escaped string.\n   * @example\n   *\n   * _.escape('Fred, Wilma, & Pebbles');\n   * // => 'Fred, Wilma, &amp; Pebbles'\n   */\n  function escape(string) {\n    return string == null ? '' : String(string).replace(reUnescapedHtml, escapeHtmlChar);\n  }\n\n  /**\n   * This method returns the first argument provided to it.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {*} value Any value.\n   * @returns {*} Returns `value`.\n   * @example\n   *\n   * var object = { 'name': 'fred' };\n   * _.identity(object) === object;\n   * // => true\n   */\n  function identity(value) {\n    return value;\n  }\n\n  /**\n   * Adds function properties of a source object to the destination object.\n   * If `object` is a function methods will be added to its prototype as well.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {Function|Object} [object=lodash] object The destination object.\n   * @param {Object} source The object of functions to add.\n   * @param {Object} [options] The options object.\n   * @param {boolean} [options.chain=true] Specify whether the functions added are chainable.\n   * @example\n   *\n   * function capitalize(string) {\n   *   return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n   * }\n   *\n   * _.mixin({ 'capitalize': capitalize });\n   * _.capitalize('fred');\n   * // => 'Fred'\n   *\n   * _('fred').capitalize().value();\n   * // => 'Fred'\n   *\n   * _.mixin({ 'capitalize': capitalize }, { 'chain': false });\n   * _('fred').capitalize();\n   * // => 'Fred'\n   */\n  function mixin(object) {\n    forEach(functions(object), function(methodName) {\n      var func = lodash[methodName] = object[methodName];\n\n      lodash.prototype[methodName] = function() {\n        var args = [this.__wrapped__];\n        push.apply(args, arguments);\n\n        var result = func.apply(lodash, args);\n        return this.__chain__\n          ? new lodashWrapper(result, true)\n          : result;\n      };\n    });\n  }\n\n  /**\n   * Reverts the '_' variable to its previous value and returns a reference to\n   * the `lodash` function.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @returns {Function} Returns the `lodash` function.\n   * @example\n   *\n   * var lodash = _.noConflict();\n   */\n  function noConflict() {\n    root._ = oldDash;\n    return this;\n  }\n\n  /**\n   * A no-operation function.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @example\n   *\n   * var object = { 'name': 'fred' };\n   * _.noop(object) === undefined;\n   * // => true\n   */\n  function noop() {\n    // no operation performed\n  }\n\n  /**\n   * Gets the number of milliseconds that have elapsed since the Unix epoch\n   * (1 January 1970 00:00:00 UTC).\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @example\n   *\n   * var stamp = _.now();\n   * _.defer(function() { console.log(_.now() - stamp); });\n   * // => logs the number of milliseconds it took for the deferred function to be called\n   */\n  var now = isNative(now = Date.now) && now || function() {\n    return new Date().getTime();\n  };\n\n  /**\n   * Creates a \"_.pluck\" style function, which returns the `key` value of a\n   * given object.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {string} key The name of the property to retrieve.\n   * @returns {Function} Returns the new function.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'fred',   'age': 40 },\n   *   { 'name': 'barney', 'age': 36 }\n   * ];\n   *\n   * var getName = _.property('name');\n   *\n   * _.map(characters, getName);\n   * // => ['barney', 'fred']\n   *\n   * _.sortBy(characters, getName);\n   * // => [{ 'name': 'barney', 'age': 36 }, { 'name': 'fred',   'age': 40 }]\n   */\n  function property(key) {\n    return function(object) {\n      return object[key];\n    };\n  }\n\n  /**\n   * Produces a random number between `min` and `max` (inclusive). If only one\n   * argument is provided a number between `0` and the given number will be\n   * returned. If `floating` is truey or either `min` or `max` are floats a\n   * floating-point number will be returned instead of an integer.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {number} [min=0] The minimum possible value.\n   * @param {number} [max=1] The maximum possible value.\n   * @param {boolean} [floating=false] Specify returning a floating-point number.\n   * @returns {number} Returns a random number.\n   * @example\n   *\n   * _.random(0, 5);\n   * // => an integer between 0 and 5\n   *\n   * _.random(5);\n   * // => also an integer between 0 and 5\n   *\n   * _.random(5, true);\n   * // => a floating-point number between 0 and 5\n   *\n   * _.random(1.2, 5.2);\n   * // => a floating-point number between 1.2 and 5.2\n   */\n  function random(min, max) {\n    if (min == null && max == null) {\n      max = 1;\n    }\n    min = +min || 0;\n    if (max == null) {\n      max = min;\n      min = 0;\n    } else {\n      max = +max || 0;\n    }\n    return min + floor(nativeRandom() * (max - min + 1));\n  }\n\n  /**\n   * Resolves the value of property `key` on `object`. If `key` is a function\n   * it will be invoked with the `this` binding of `object` and its result returned,\n   * else the property value is returned. If `object` is falsey then `undefined`\n   * is returned.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {Object} object The object to inspect.\n   * @param {string} key The name of the property to resolve.\n   * @returns {*} Returns the resolved value.\n   * @example\n   *\n   * var object = {\n   *   'cheese': 'crumpets',\n   *   'stuff': function() {\n   *     return 'nonsense';\n   *   }\n   * };\n   *\n   * _.result(object, 'cheese');\n   * // => 'crumpets'\n   *\n   * _.result(object, 'stuff');\n   * // => 'nonsense'\n   */\n  function result(object, key) {\n    if (object) {\n      var value = object[key];\n      return isFunction(value) ? object[key]() : value;\n    }\n  }\n\n  /**\n   * A micro-templating method that handles arbitrary delimiters, preserves\n   * whitespace, and correctly escapes quotes within interpolated code.\n   *\n   * Note: In the development build, `_.template` utilizes sourceURLs for easier\n   * debugging. See http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/#toc-sourceurl\n   *\n   * For more information on precompiling templates see:\n   * http://lodash.com/custom-builds\n   *\n   * For more information on Chrome extension sandboxes see:\n   * http://developer.chrome.com/stable/extensions/sandboxingEval.html\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {string} text The template text.\n   * @param {Object} data The data object used to populate the text.\n   * @param {Object} [options] The options object.\n   * @param {RegExp} [options.escape] The \"escape\" delimiter.\n   * @param {RegExp} [options.evaluate] The \"evaluate\" delimiter.\n   * @param {Object} [options.imports] An object to import into the template as local variables.\n   * @param {RegExp} [options.interpolate] The \"interpolate\" delimiter.\n   * @param {string} [sourceURL] The sourceURL of the template's compiled source.\n   * @param {string} [variable] The data object variable name.\n   * @returns {Function|string} Returns a compiled function when no `data` object\n   *  is given, else it returns the interpolated text.\n   * @example\n   *\n   * // using the \"interpolate\" delimiter to create a compiled template\n   * var compiled = _.template('hello <%= name %>');\n   * compiled({ 'name': 'fred' });\n   * // => 'hello fred'\n   *\n   * // using the \"escape\" delimiter to escape HTML in data property values\n   * _.template('<b><%- value %></b>', { 'value': '<script>' });\n   * // => '<b>&lt;script&gt;</b>'\n   *\n   * // using the \"evaluate\" delimiter to generate HTML\n   * var list = '<% _.forEach(people, function(name) { %><li><%- name %></li><% }); %>';\n   * _.template(list, { 'people': ['fred', 'barney'] });\n   * // => '<li>fred</li><li>barney</li>'\n   *\n   * // using the ES6 delimiter as an alternative to the default \"interpolate\" delimiter\n   * _.template('hello ${ name }', { 'name': 'pebbles' });\n   * // => 'hello pebbles'\n   *\n   * // using the internal `print` function in \"evaluate\" delimiters\n   * _.template('<% print(\"hello \" + name); %>!', { 'name': 'barney' });\n   * // => 'hello barney!'\n   *\n   * // using a custom template delimiters\n   * _.templateSettings = {\n   *   'interpolate': /{{([\\s\\S]+?)}}/g\n   * };\n   *\n   * _.template('hello {{ name }}!', { 'name': 'mustache' });\n   * // => 'hello mustache!'\n   *\n   * // using the `imports` option to import jQuery\n   * var list = '<% jq.each(people, function(name) { %><li><%- name %></li><% }); %>';\n   * _.template(list, { 'people': ['fred', 'barney'] }, { 'imports': { 'jq': jQuery } });\n   * // => '<li>fred</li><li>barney</li>'\n   *\n   * // using the `sourceURL` option to specify a custom sourceURL for the template\n   * var compiled = _.template('hello <%= name %>', null, { 'sourceURL': '/basic/greeting.jst' });\n   * compiled(data);\n   * // => find the source of \"greeting.jst\" under the Sources tab or Resources panel of the web inspector\n   *\n   * // using the `variable` option to ensure a with-statement isn't used in the compiled template\n   * var compiled = _.template('hi <%= data.name %>!', null, { 'variable': 'data' });\n   * compiled.source;\n   * // => function(data) {\n   *   var __t, __p = '', __e = _.escape;\n   *   __p += 'hi ' + ((__t = ( data.name )) == null ? '' : __t) + '!';\n   *   return __p;\n   * }\n   *\n   * // using the `source` property to inline compiled templates for meaningful\n   * // line numbers in error messages and a stack trace\n   * fs.writeFileSync(path.join(cwd, 'jst.js'), '\\\n   *   var JST = {\\\n   *     \"main\": ' + _.template(mainText).source + '\\\n   *   };\\\n   * ');\n   */\n  function template(text, data, options) {\n    var _ = lodash,\n        settings = _.templateSettings;\n\n    text = String(text || '');\n    options = defaults({}, options, settings);\n\n    var index = 0,\n        source = \"__p += '\",\n        variable = options.variable;\n\n    var reDelimiters = RegExp(\n      (options.escape || reNoMatch).source + '|' +\n      (options.interpolate || reNoMatch).source + '|' +\n      (options.evaluate || reNoMatch).source + '|$'\n    , 'g');\n\n    text.replace(reDelimiters, function(match, escapeValue, interpolateValue, evaluateValue, offset) {\n      source += text.slice(index, offset).replace(reUnescapedString, escapeStringChar);\n      if (escapeValue) {\n        source += \"' +\\n_.escape(\" + escapeValue + \") +\\n'\";\n      }\n      if (evaluateValue) {\n        source += \"';\\n\" + evaluateValue + \";\\n__p += '\";\n      }\n      if (interpolateValue) {\n        source += \"' +\\n((__t = (\" + interpolateValue + \")) == null ? '' : __t) +\\n'\";\n      }\n      index = offset + match.length;\n      return match;\n    });\n\n    source += \"';\\n\";\n    if (!variable) {\n      variable = 'obj';\n      source = 'with (' + variable + ' || {}) {\\n' + source + '\\n}\\n';\n    }\n    source = 'function(' + variable + ') {\\n' +\n      \"var __t, __p = '', __j = Array.prototype.join;\\n\" +\n      \"function print() { __p += __j.call(arguments, '') }\\n\" +\n      source +\n      'return __p\\n}';\n\n    try {\n      var result = Function('_', 'return ' + source)(_);\n    } catch(e) {\n      e.source = source;\n      throw e;\n    }\n    if (data) {\n      return result(data);\n    }\n    result.source = source;\n    return result;\n  }\n\n  /**\n   * Executes the callback `n` times, returning an array of the results\n   * of each callback execution. The callback is bound to `thisArg` and invoked\n   * with one argument; (index).\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {number} n The number of times to execute the callback.\n   * @param {Function} callback The function called per iteration.\n   * @param {*} [thisArg] The `this` binding of `callback`.\n   * @returns {Array} Returns an array of the results of each `callback` execution.\n   * @example\n   *\n   * var diceRolls = _.times(3, _.partial(_.random, 1, 6));\n   * // => [3, 6, 4]\n   *\n   * _.times(3, function(n) { mage.castSpell(n); });\n   * // => calls `mage.castSpell(n)` three times, passing `n` of `0`, `1`, and `2` respectively\n   *\n   * _.times(3, function(n) { this.cast(n); }, mage);\n   * // => also calls `mage.castSpell(n)` three times\n   */\n  function times(n, callback, thisArg) {\n    n = (n = +n) > -1 ? n : 0;\n    var index = -1,\n        result = Array(n);\n\n    callback = baseCreateCallback(callback, thisArg, 1);\n    while (++index < n) {\n      result[index] = callback(index);\n    }\n    return result;\n  }\n\n  /**\n   * The inverse of `_.escape` this method converts the HTML entities\n   * `&amp;`, `&lt;`, `&gt;`, `&quot;`, and `&#39;` in `string` to their\n   * corresponding characters.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {string} string The string to unescape.\n   * @returns {string} Returns the unescaped string.\n   * @example\n   *\n   * _.unescape('Fred, Barney &amp; Pebbles');\n   * // => 'Fred, Barney & Pebbles'\n   */\n  function unescape(string) {\n    return string == null ? '' : String(string).replace(reEscapedHtml, unescapeHtmlChar);\n  }\n\n  /**\n   * Generates a unique ID. If `prefix` is provided the ID will be appended to it.\n   *\n   * @static\n   * @memberOf _\n   * @category Utilities\n   * @param {string} [prefix] The value to prefix the ID with.\n   * @returns {string} Returns the unique ID.\n   * @example\n   *\n   * _.uniqueId('contact_');\n   * // => 'contact_104'\n   *\n   * _.uniqueId();\n   * // => '105'\n   */\n  function uniqueId(prefix) {\n    var id = ++idCounter + '';\n    return prefix ? prefix + id : id;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates a `lodash` object that wraps the given value with explicit\n   * method chaining enabled.\n   *\n   * @static\n   * @memberOf _\n   * @category Chaining\n   * @param {*} value The value to wrap.\n   * @returns {Object} Returns the wrapper object.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney',  'age': 36 },\n   *   { 'name': 'fred',    'age': 40 },\n   *   { 'name': 'pebbles', 'age': 1 }\n   * ];\n   *\n   * var youngest = _.chain(characters)\n   *     .sortBy('age')\n   *     .map(function(chr) { return chr.name + ' is ' + chr.age; })\n   *     .first()\n   *     .value();\n   * // => 'pebbles is 1'\n   */\n  function chain(value) {\n    value = new lodashWrapper(value);\n    value.__chain__ = true;\n    return value;\n  }\n\n  /**\n   * Invokes `interceptor` with the `value` as the first argument and then\n   * returns `value`. The purpose of this method is to \"tap into\" a method\n   * chain in order to perform operations on intermediate results within\n   * the chain.\n   *\n   * @static\n   * @memberOf _\n   * @category Chaining\n   * @param {*} value The value to provide to `interceptor`.\n   * @param {Function} interceptor The function to invoke.\n   * @returns {*} Returns `value`.\n   * @example\n   *\n   * _([1, 2, 3, 4])\n   *  .tap(function(array) { array.pop(); })\n   *  .reverse()\n   *  .value();\n   * // => [3, 2, 1]\n   */\n  function tap(value, interceptor) {\n    interceptor(value);\n    return value;\n  }\n\n  /**\n   * Enables explicit method chaining on the wrapper object.\n   *\n   * @name chain\n   * @memberOf _\n   * @category Chaining\n   * @returns {*} Returns the wrapper object.\n   * @example\n   *\n   * var characters = [\n   *   { 'name': 'barney', 'age': 36 },\n   *   { 'name': 'fred',   'age': 40 }\n   * ];\n   *\n   * // without explicit chaining\n   * _(characters).first();\n   * // => { 'name': 'barney', 'age': 36 }\n   *\n   * // with explicit chaining\n   * _(characters).chain()\n   *   .first()\n   *   .pick('age')\n   *   .value();\n   * // => { 'age': 36 }\n   */\n  function wrapperChain() {\n    this.__chain__ = true;\n    return this;\n  }\n\n  /**\n   * Extracts the wrapped value.\n   *\n   * @name valueOf\n   * @memberOf _\n   * @alias value\n   * @category Chaining\n   * @returns {*} Returns the wrapped value.\n   * @example\n   *\n   * _([1, 2, 3]).valueOf();\n   * // => [1, 2, 3]\n   */\n  function wrapperValueOf() {\n    return this.__wrapped__;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  // add functions that return wrapped values when chaining\n  lodash.after = after;\n  lodash.bind = bind;\n  lodash.bindAll = bindAll;\n  lodash.chain = chain;\n  lodash.compact = compact;\n  lodash.compose = compose;\n  lodash.countBy = countBy;\n  lodash.debounce = debounce;\n  lodash.defaults = defaults;\n  lodash.defer = defer;\n  lodash.delay = delay;\n  lodash.difference = difference;\n  lodash.filter = filter;\n  lodash.flatten = flatten;\n  lodash.forEach = forEach;\n  lodash.functions = functions;\n  lodash.groupBy = groupBy;\n  lodash.indexBy = indexBy;\n  lodash.initial = initial;\n  lodash.intersection = intersection;\n  lodash.invert = invert;\n  lodash.invoke = invoke;\n  lodash.keys = keys;\n  lodash.map = map;\n  lodash.max = max;\n  lodash.memoize = memoize;\n  lodash.min = min;\n  lodash.omit = omit;\n  lodash.once = once;\n  lodash.pairs = pairs;\n  lodash.partial = partial;\n  lodash.pick = pick;\n  lodash.pluck = pluck;\n  lodash.range = range;\n  lodash.reject = reject;\n  lodash.rest = rest;\n  lodash.shuffle = shuffle;\n  lodash.sortBy = sortBy;\n  lodash.tap = tap;\n  lodash.throttle = throttle;\n  lodash.times = times;\n  lodash.toArray = toArray;\n  lodash.union = union;\n  lodash.uniq = uniq;\n  lodash.values = values;\n  lodash.where = where;\n  lodash.without = without;\n  lodash.wrap = wrap;\n  lodash.zip = zip;\n\n  // add aliases\n  lodash.collect = map;\n  lodash.drop = rest;\n  lodash.each = forEach;\n  lodash.extend = assign;\n  lodash.methods = functions;\n  lodash.object = zipObject;\n  lodash.select = filter;\n  lodash.tail = rest;\n  lodash.unique = uniq;\n\n  /*--------------------------------------------------------------------------*/\n\n  // add functions that return unwrapped values when chaining\n  lodash.clone = clone;\n  lodash.contains = contains;\n  lodash.escape = escape;\n  lodash.every = every;\n  lodash.find = find;\n  lodash.has = has;\n  lodash.identity = identity;\n  lodash.indexOf = indexOf;\n  lodash.isArguments = isArguments;\n  lodash.isArray = isArray;\n  lodash.isBoolean = isBoolean;\n  lodash.isDate = isDate;\n  lodash.isElement = isElement;\n  lodash.isEmpty = isEmpty;\n  lodash.isEqual = isEqual;\n  lodash.isFinite = isFinite;\n  lodash.isFunction = isFunction;\n  lodash.isNaN = isNaN;\n  lodash.isNull = isNull;\n  lodash.isNumber = isNumber;\n  lodash.isObject = isObject;\n  lodash.isRegExp = isRegExp;\n  lodash.isString = isString;\n  lodash.isUndefined = isUndefined;\n  lodash.lastIndexOf = lastIndexOf;\n  lodash.mixin = mixin;\n  lodash.noConflict = noConflict;\n  lodash.random = random;\n  lodash.reduce = reduce;\n  lodash.reduceRight = reduceRight;\n  lodash.result = result;\n  lodash.size = size;\n  lodash.some = some;\n  lodash.sortedIndex = sortedIndex;\n  lodash.template = template;\n  lodash.unescape = unescape;\n  lodash.uniqueId = uniqueId;\n\n  // add aliases\n  lodash.all = every;\n  lodash.any = some;\n  lodash.detect = find;\n  lodash.findWhere = findWhere;\n  lodash.foldl = reduce;\n  lodash.foldr = reduceRight;\n  lodash.include = contains;\n  lodash.inject = reduce;\n\n  /*--------------------------------------------------------------------------*/\n\n  // add functions capable of returning wrapped and unwrapped values when chaining\n  lodash.first = first;\n  lodash.last = last;\n  lodash.sample = sample;\n\n  // add aliases\n  lodash.take = first;\n  lodash.head = first;\n\n  /*--------------------------------------------------------------------------*/\n\n  // add functions to `lodash.prototype`\n  mixin(lodash);\n\n  /**\n   * The semantic version number.\n   *\n   * @static\n   * @memberOf _\n   * @type string\n   */\n  lodash.VERSION = '2.4.1';\n\n  // add \"Chaining\" functions to the wrapper\n  lodash.prototype.chain = wrapperChain;\n  lodash.prototype.value = wrapperValueOf;\n\n    // add `Array` mutator functions to the wrapper\n    forEach(['pop', 'push', 'reverse', 'shift', 'sort', 'splice', 'unshift'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__;\n        func.apply(value, arguments);\n\n        // avoid array-like object bugs with `Array#shift` and `Array#splice`\n        // in Firefox < 10 and IE < 9\n        if (!support.spliceObjects && value.length === 0) {\n          delete value[0];\n        }\n        return this;\n      };\n    });\n\n    // add `Array` accessor functions to the wrapper\n    forEach(['concat', 'join', 'slice'], function(methodName) {\n      var func = arrayRef[methodName];\n      lodash.prototype[methodName] = function() {\n        var value = this.__wrapped__,\n            result = func.apply(value, arguments);\n\n        if (this.__chain__) {\n          result = new lodashWrapper(result);\n          result.__chain__ = true;\n        }\n        return result;\n      };\n    });\n\n  /*--------------------------------------------------------------------------*/\n\n  // some AMD build optimizers like r.js check for condition patterns like the following:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose Lo-Dash to the global object even when an AMD loader is present in\n    // case Lo-Dash is loaded with a RequireJS shim config.\n    // See http://requirejs.org/docs/api.html#config-shim\n    root._ = lodash;\n\n    // define as an anonymous module so, through path mapping, it can be\n    // referenced as the \"underscore\" module\n    define(function() {\n      return lodash;\n    });\n  }\n  // check for `exports` after `define` in case a build optimizer adds an `exports` object\n  else if (freeExports && freeModule) {\n    // in Node.js or RingoJS\n    if (moduleExports) {\n      (freeModule.exports = lodash)._ = lodash;\n    }\n    // in Narwhal or Rhino -require\n    else {\n      freeExports._ = lodash;\n    }\n  }\n  else {\n    // in a browser or Rhino\n    root._ = lodash;\n  }\n}.call(this));\n","//     Backbone.js 1.1.2\n\n//     (c) 2010-2014 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n//     Backbone may be freely distributed under the MIT license.\n//     For all details and documentation:\n//     http://backbonejs.org\n\n(function(root, factory) {\n\n  // Set up Backbone appropriately for the environment. Start with AMD.\n  if (typeof define === 'function' && define.amd) {\n    define(['underscore', 'jquery', 'exports'], function(_, $, exports) {\n      // Export global even in AMD case in case this script is loaded with\n      // others that may still expect a global Backbone.\n      root.Backbone = factory(root, exports, _, $);\n    });\n\n  // Next for Node.js or CommonJS. jQuery may not be needed as a module.\n  } else if (typeof exports !== 'undefined') {\n    var _ = require('underscore');\n    factory(root, exports, _);\n\n  // Finally, as a browser global.\n  } else {\n    root.Backbone = factory(root, {}, root._, (root.jQuery || root.Zepto || root.ender || root.$));\n  }\n\n}(this, function(root, Backbone, _, $) {\n\n  // Initial Setup\n  // -------------\n\n  // Save the previous value of the `Backbone` variable, so that it can be\n  // restored later on, if `noConflict` is used.\n  var previousBackbone = root.Backbone;\n\n  // Create local references to array methods we'll want to use later.\n  var array = [];\n  var push = array.push;\n  var slice = array.slice;\n  var splice = array.splice;\n\n  // Current version of the library. Keep in sync with `package.json`.\n  Backbone.VERSION = '1.1.2';\n\n  // For Backbone's purposes, jQuery, Zepto, Ender, or My Library (kidding) owns\n  // the `$` variable.\n  Backbone.$ = $;\n\n  // Runs Backbone.js in *noConflict* mode, returning the `Backbone` variable\n  // to its previous owner. Returns a reference to this Backbone object.\n  Backbone.noConflict = function() {\n    root.Backbone = previousBackbone;\n    return this;\n  };\n\n  // Turn on `emulateHTTP` to support legacy HTTP servers. Setting this option\n  // will fake `\"PATCH\"`, `\"PUT\"` and `\"DELETE\"` requests via the `_method` parameter and\n  // set a `X-Http-Method-Override` header.\n  Backbone.emulateHTTP = false;\n\n  // Turn on `emulateJSON` to support legacy servers that can't deal with direct\n  // `application/json` requests ... will encode the body as\n  // `application/x-www-form-urlencoded` instead and will send the model in a\n  // form param named `model`.\n  Backbone.emulateJSON = false;\n\n  // Backbone.Events\n  // ---------------\n\n  // A module that can be mixed in to *any object* in order to provide it with\n  // custom events. You may bind with `on` or remove with `off` callback\n  // functions to an event; `trigger`-ing an event fires all callbacks in\n  // succession.\n  //\n  //     var object = {};\n  //     _.extend(object, Backbone.Events);\n  //     object.on('expand', function(){ alert('expanded'); });\n  //     object.trigger('expand');\n  //\n  var Events = Backbone.Events = {\n\n    // Bind an event to a `callback` function. Passing `\"all\"` will bind\n    // the callback to all events fired.\n    on: function(name, callback, context) {\n      if (!eventsApi(this, 'on', name, [callback, context]) || !callback) return this;\n      this._events || (this._events = {});\n      var events = this._events[name] || (this._events[name] = []);\n      events.push({callback: callback, context: context, ctx: context || this});\n      return this;\n    },\n\n    // Bind an event to only be triggered a single time. After the first time\n    // the callback is invoked, it will be removed.\n    once: function(name, callback, context) {\n      if (!eventsApi(this, 'once', name, [callback, context]) || !callback) return this;\n      var self = this;\n      var once = _.once(function() {\n        self.off(name, once);\n        callback.apply(this, arguments);\n      });\n      once._callback = callback;\n      return this.on(name, once, context);\n    },\n\n    // Remove one or many callbacks. If `context` is null, removes all\n    // callbacks with that function. If `callback` is null, removes all\n    // callbacks for the event. If `name` is null, removes all bound\n    // callbacks for all events.\n    off: function(name, callback, context) {\n      var retain, ev, events, names, i, l, j, k;\n      if (!this._events || !eventsApi(this, 'off', name, [callback, context])) return this;\n      if (!name && !callback && !context) {\n        this._events = void 0;\n        return this;\n      }\n      names = name ? [name] : _.keys(this._events);\n      for (i = 0, l = names.length; i < l; i++) {\n        name = names[i];\n        if (events = this._events[name]) {\n          this._events[name] = retain = [];\n          if (callback || context) {\n            for (j = 0, k = events.length; j < k; j++) {\n              ev = events[j];\n              if ((callback && callback !== ev.callback && callback !== ev.callback._callback) ||\n                  (context && context !== ev.context)) {\n                retain.push(ev);\n              }\n            }\n          }\n          if (!retain.length) delete this._events[name];\n        }\n      }\n\n      return this;\n    },\n\n    // Trigger one or many events, firing all bound callbacks. Callbacks are\n    // passed the same arguments as `trigger` is, apart from the event name\n    // (unless you're listening on `\"all\"`, which will cause your callback to\n    // receive the true name of the event as the first argument).\n    trigger: function(name) {\n      if (!this._events) return this;\n      var args = slice.call(arguments, 1);\n      if (!eventsApi(this, 'trigger', name, args)) return this;\n      var events = this._events[name];\n      var allEvents = this._events.all;\n      if (events) triggerEvents(events, args);\n      if (allEvents) triggerEvents(allEvents, arguments);\n      return this;\n    },\n\n    // Tell this object to stop listening to either specific events ... or\n    // to every object it's currently listening to.\n    stopListening: function(obj, name, callback) {\n      var listeningTo = this._listeningTo;\n      if (!listeningTo) return this;\n      var remove = !name && !callback;\n      if (!callback && typeof name === 'object') callback = this;\n      if (obj) (listeningTo = {})[obj._listenId] = obj;\n      for (var id in listeningTo) {\n        obj = listeningTo[id];\n        obj.off(name, callback, this);\n        if (remove || _.isEmpty(obj._events)) delete this._listeningTo[id];\n      }\n      return this;\n    }\n\n  };\n\n  // Regular expression used to split event strings.\n  var eventSplitter = /\\s+/;\n\n  // Implement fancy features of the Events API such as multiple event\n  // names `\"change blur\"` and jQuery-style event maps `{change: action}`\n  // in terms of the existing API.\n  var eventsApi = function(obj, action, name, rest) {\n    if (!name) return true;\n\n    // Handle event maps.\n    if (typeof name === 'object') {\n      for (var key in name) {\n        obj[action].apply(obj, [key, name[key]].concat(rest));\n      }\n      return false;\n    }\n\n    // Handle space separated event names.\n    if (eventSplitter.test(name)) {\n      var names = name.split(eventSplitter);\n      for (var i = 0, l = names.length; i < l; i++) {\n        obj[action].apply(obj, [names[i]].concat(rest));\n      }\n      return false;\n    }\n\n    return true;\n  };\n\n  // A difficult-to-believe, but optimized internal dispatch function for\n  // triggering events. Tries to keep the usual cases speedy (most internal\n  // Backbone events have 3 arguments).\n  var triggerEvents = function(events, args) {\n    var ev, i = -1, l = events.length, a1 = args[0], a2 = args[1], a3 = args[2];\n    switch (args.length) {\n      case 0: while (++i < l) (ev = events[i]).callback.call(ev.ctx); return;\n      case 1: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1); return;\n      case 2: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2); return;\n      case 3: while (++i < l) (ev = events[i]).callback.call(ev.ctx, a1, a2, a3); return;\n      default: while (++i < l) (ev = events[i]).callback.apply(ev.ctx, args); return;\n    }\n  };\n\n  var listenMethods = {listenTo: 'on', listenToOnce: 'once'};\n\n  // Inversion-of-control versions of `on` and `once`. Tell *this* object to\n  // listen to an event in another object ... keeping track of what it's\n  // listening to.\n  _.each(listenMethods, function(implementation, method) {\n    Events[method] = function(obj, name, callback) {\n      var listeningTo = this._listeningTo || (this._listeningTo = {});\n      var id = obj._listenId || (obj._listenId = _.uniqueId('l'));\n      listeningTo[id] = obj;\n      if (!callback && typeof name === 'object') callback = this;\n      obj[implementation](name, callback, this);\n      return this;\n    };\n  });\n\n  // Aliases for backwards compatibility.\n  Events.bind   = Events.on;\n  Events.unbind = Events.off;\n\n  // Allow the `Backbone` object to serve as a global event bus, for folks who\n  // want global \"pubsub\" in a convenient place.\n  _.extend(Backbone, Events);\n\n  // Backbone.Model\n  // --------------\n\n  // Backbone **Models** are the basic data object in the framework --\n  // frequently representing a row in a table in a database on your server.\n  // A discrete chunk of data and a bunch of useful, related methods for\n  // performing computations and transformations on that data.\n\n  // Create a new model with the specified attributes. A client id (`cid`)\n  // is automatically generated and assigned for you.\n  var Model = Backbone.Model = function(attributes, options) {\n    var attrs = attributes || {};\n    options || (options = {});\n    this.cid = _.uniqueId('c');\n    this.attributes = {};\n    if (options.collection) this.collection = options.collection;\n    if (options.parse) attrs = this.parse(attrs, options) || {};\n    attrs = _.defaults({}, attrs, _.result(this, 'defaults'));\n    this.set(attrs, options);\n    this.changed = {};\n    this.initialize.apply(this, arguments);\n  };\n\n  // Attach all inheritable methods to the Model prototype.\n  _.extend(Model.prototype, Events, {\n\n    // A hash of attributes whose current and previous value differ.\n    changed: null,\n\n    // The value returned during the last failed validation.\n    validationError: null,\n\n    // The default name for the JSON `id` attribute is `\"id\"`. MongoDB and\n    // CouchDB users may want to set this to `\"_id\"`.\n    idAttribute: 'id',\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // Return a copy of the model's `attributes` object.\n    toJSON: function(options) {\n      return _.clone(this.attributes);\n    },\n\n    // Proxy `Backbone.sync` by default -- but override this if you need\n    // custom syncing semantics for *this* particular model.\n    sync: function() {\n      return Backbone.sync.apply(this, arguments);\n    },\n\n    // Get the value of an attribute.\n    get: function(attr) {\n      return this.attributes[attr];\n    },\n\n    // Get the HTML-escaped value of an attribute.\n    escape: function(attr) {\n      return _.escape(this.get(attr));\n    },\n\n    // Returns `true` if the attribute contains a value that is not null\n    // or undefined.\n    has: function(attr) {\n      return this.get(attr) != null;\n    },\n\n    // Set a hash of model attributes on the object, firing `\"change\"`. This is\n    // the core primitive operation of a model, updating the data and notifying\n    // anyone who needs to know about the change in state. The heart of the beast.\n    set: function(key, val, options) {\n      var attr, attrs, unset, changes, silent, changing, prev, current;\n      if (key == null) return this;\n\n      // Handle both `\"key\", value` and `{key: value}` -style arguments.\n      if (typeof key === 'object') {\n        attrs = key;\n        options = val;\n      } else {\n        (attrs = {})[key] = val;\n      }\n\n      options || (options = {});\n\n      // Run validation.\n      if (!this._validate(attrs, options)) return false;\n\n      // Extract attributes and options.\n      unset           = options.unset;\n      silent          = options.silent;\n      changes         = [];\n      changing        = this._changing;\n      this._changing  = true;\n\n      if (!changing) {\n        this._previousAttributes = _.clone(this.attributes);\n        this.changed = {};\n      }\n      current = this.attributes, prev = this._previousAttributes;\n\n      // Check for changes of `id`.\n      if (this.idAttribute in attrs) this.id = attrs[this.idAttribute];\n\n      // For each `set` attribute, update or delete the current value.\n      for (attr in attrs) {\n        val = attrs[attr];\n        if (!_.isEqual(current[attr], val)) changes.push(attr);\n        if (!_.isEqual(prev[attr], val)) {\n          this.changed[attr] = val;\n        } else {\n          delete this.changed[attr];\n        }\n        unset ? delete current[attr] : current[attr] = val;\n      }\n\n      // Trigger all relevant attribute changes.\n      if (!silent) {\n        if (changes.length) this._pending = options;\n        for (var i = 0, l = changes.length; i < l; i++) {\n          this.trigger('change:' + changes[i], this, current[changes[i]], options);\n        }\n      }\n\n      // You might be wondering why there's a `while` loop here. Changes can\n      // be recursively nested within `\"change\"` events.\n      if (changing) return this;\n      if (!silent) {\n        while (this._pending) {\n          options = this._pending;\n          this._pending = false;\n          this.trigger('change', this, options);\n        }\n      }\n      this._pending = false;\n      this._changing = false;\n      return this;\n    },\n\n    // Remove an attribute from the model, firing `\"change\"`. `unset` is a noop\n    // if the attribute doesn't exist.\n    unset: function(attr, options) {\n      return this.set(attr, void 0, _.extend({}, options, {unset: true}));\n    },\n\n    // Clear all attributes on the model, firing `\"change\"`.\n    clear: function(options) {\n      var attrs = {};\n      for (var key in this.attributes) attrs[key] = void 0;\n      return this.set(attrs, _.extend({}, options, {unset: true}));\n    },\n\n    // Determine if the model has changed since the last `\"change\"` event.\n    // If you specify an attribute name, determine if that attribute has changed.\n    hasChanged: function(attr) {\n      if (attr == null) return !_.isEmpty(this.changed);\n      return _.has(this.changed, attr);\n    },\n\n    // Return an object containing all the attributes that have changed, or\n    // false if there are no changed attributes. Useful for determining what\n    // parts of a view need to be updated and/or what attributes need to be\n    // persisted to the server. Unset attributes will be set to undefined.\n    // You can also pass an attributes object to diff against the model,\n    // determining if there *would be* a change.\n    changedAttributes: function(diff) {\n      if (!diff) return this.hasChanged() ? _.clone(this.changed) : false;\n      var val, changed = false;\n      var old = this._changing ? this._previousAttributes : this.attributes;\n      for (var attr in diff) {\n        if (_.isEqual(old[attr], (val = diff[attr]))) continue;\n        (changed || (changed = {}))[attr] = val;\n      }\n      return changed;\n    },\n\n    // Get the previous value of an attribute, recorded at the time the last\n    // `\"change\"` event was fired.\n    previous: function(attr) {\n      if (attr == null || !this._previousAttributes) return null;\n      return this._previousAttributes[attr];\n    },\n\n    // Get all of the attributes of the model at the time of the previous\n    // `\"change\"` event.\n    previousAttributes: function() {\n      return _.clone(this._previousAttributes);\n    },\n\n    // Fetch the model from the server. If the server's representation of the\n    // model differs from its current attributes, they will be overridden,\n    // triggering a `\"change\"` event.\n    fetch: function(options) {\n      options = options ? _.clone(options) : {};\n      if (options.parse === void 0) options.parse = true;\n      var model = this;\n      var success = options.success;\n      options.success = function(resp) {\n        if (!model.set(model.parse(resp, options), options)) return false;\n        if (success) success(model, resp, options);\n        model.trigger('sync', model, resp, options);\n      };\n      wrapError(this, options);\n      return this.sync('read', this, options);\n    },\n\n    // Set a hash of model attributes, and sync the model to the server.\n    // If the server returns an attributes hash that differs, the model's\n    // state will be `set` again.\n    save: function(key, val, options) {\n      var attrs, method, xhr, attributes = this.attributes;\n\n      // Handle both `\"key\", value` and `{key: value}` -style arguments.\n      if (key == null || typeof key === 'object') {\n        attrs = key;\n        options = val;\n      } else {\n        (attrs = {})[key] = val;\n      }\n\n      options = _.extend({validate: true}, options);\n\n      // If we're not waiting and attributes exist, save acts as\n      // `set(attr).save(null, opts)` with validation. Otherwise, check if\n      // the model will be valid when the attributes, if any, are set.\n      if (attrs && !options.wait) {\n        if (!this.set(attrs, options)) return false;\n      } else {\n        if (!this._validate(attrs, options)) return false;\n      }\n\n      // Set temporary attributes if `{wait: true}`.\n      if (attrs && options.wait) {\n        this.attributes = _.extend({}, attributes, attrs);\n      }\n\n      // After a successful server-side save, the client is (optionally)\n      // updated with the server-side state.\n      if (options.parse === void 0) options.parse = true;\n      var model = this;\n      var success = options.success;\n      options.success = function(resp) {\n        // Ensure attributes are restored during synchronous saves.\n        model.attributes = attributes;\n        var serverAttrs = model.parse(resp, options);\n        if (options.wait) serverAttrs = _.extend(attrs || {}, serverAttrs);\n        if (_.isObject(serverAttrs) && !model.set(serverAttrs, options)) {\n          return false;\n        }\n        if (success) success(model, resp, options);\n        model.trigger('sync', model, resp, options);\n      };\n      wrapError(this, options);\n\n      method = this.isNew() ? 'create' : (options.patch ? 'patch' : 'update');\n      if (method === 'patch') options.attrs = attrs;\n      xhr = this.sync(method, this, options);\n\n      // Restore attributes.\n      if (attrs && options.wait) this.attributes = attributes;\n\n      return xhr;\n    },\n\n    // Destroy this model on the server if it was already persisted.\n    // Optimistically removes the model from its collection, if it has one.\n    // If `wait: true` is passed, waits for the server to respond before removal.\n    destroy: function(options) {\n      options = options ? _.clone(options) : {};\n      var model = this;\n      var success = options.success;\n\n      var destroy = function() {\n        model.trigger('destroy', model, model.collection, options);\n      };\n\n      options.success = function(resp) {\n        if (options.wait || model.isNew()) destroy();\n        if (success) success(model, resp, options);\n        if (!model.isNew()) model.trigger('sync', model, resp, options);\n      };\n\n      if (this.isNew()) {\n        options.success();\n        return false;\n      }\n      wrapError(this, options);\n\n      var xhr = this.sync('delete', this, options);\n      if (!options.wait) destroy();\n      return xhr;\n    },\n\n    // Default URL for the model's representation on the server -- if you're\n    // using Backbone's restful methods, override this to change the endpoint\n    // that will be called.\n    url: function() {\n      var base =\n        _.result(this, 'urlRoot') ||\n        _.result(this.collection, 'url') ||\n        urlError();\n      if (this.isNew()) return base;\n      return base.replace(/([^\\/])$/, '$1/') + encodeURIComponent(this.id);\n    },\n\n    // **parse** converts a response into the hash of attributes to be `set` on\n    // the model. The default implementation is just to pass the response along.\n    parse: function(resp, options) {\n      return resp;\n    },\n\n    // Create a new model with identical attributes to this one.\n    clone: function() {\n      return new this.constructor(this.attributes);\n    },\n\n    // A model is new if it has never been saved to the server, and lacks an id.\n    isNew: function() {\n      return !this.has(this.idAttribute);\n    },\n\n    // Check if the model is currently in a valid state.\n    isValid: function(options) {\n      return this._validate({}, _.extend(options || {}, { validate: true }));\n    },\n\n    // Run validation against the next complete set of model attributes,\n    // returning `true` if all is well. Otherwise, fire an `\"invalid\"` event.\n    _validate: function(attrs, options) {\n      if (!options.validate || !this.validate) return true;\n      attrs = _.extend({}, this.attributes, attrs);\n      var error = this.validationError = this.validate(attrs, options) || null;\n      if (!error) return true;\n      this.trigger('invalid', this, error, _.extend(options, {validationError: error}));\n      return false;\n    }\n\n  });\n\n  // Underscore methods that we want to implement on the Model.\n  var modelMethods = ['keys', 'values', 'pairs', 'invert', 'pick', 'omit'];\n\n  // Mix in each Underscore method as a proxy to `Model#attributes`.\n  _.each(modelMethods, function(method) {\n    Model.prototype[method] = function() {\n      var args = slice.call(arguments);\n      args.unshift(this.attributes);\n      return _[method].apply(_, args);\n    };\n  });\n\n  // Backbone.Collection\n  // -------------------\n\n  // If models tend to represent a single row of data, a Backbone Collection is\n  // more analagous to a table full of data ... or a small slice or page of that\n  // table, or a collection of rows that belong together for a particular reason\n  // -- all of the messages in this particular folder, all of the documents\n  // belonging to this particular author, and so on. Collections maintain\n  // indexes of their models, both in order, and for lookup by `id`.\n\n  // Create a new **Collection**, perhaps to contain a specific type of `model`.\n  // If a `comparator` is specified, the Collection will maintain\n  // its models in sort order, as they're added and removed.\n  var Collection = Backbone.Collection = function(models, options) {\n    options || (options = {});\n    if (options.model) this.model = options.model;\n    if (options.comparator !== void 0) this.comparator = options.comparator;\n    this._reset();\n    this.initialize.apply(this, arguments);\n    if (models) this.reset(models, _.extend({silent: true}, options));\n  };\n\n  // Default options for `Collection#set`.\n  var setOptions = {add: true, remove: true, merge: true};\n  var addOptions = {add: true, remove: false};\n\n  // Define the Collection's inheritable methods.\n  _.extend(Collection.prototype, Events, {\n\n    // The default model for a collection is just a **Backbone.Model**.\n    // This should be overridden in most cases.\n    model: Model,\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // The JSON representation of a Collection is an array of the\n    // models' attributes.\n    toJSON: function(options) {\n      return this.map(function(model){ return model.toJSON(options); });\n    },\n\n    // Proxy `Backbone.sync` by default.\n    sync: function() {\n      return Backbone.sync.apply(this, arguments);\n    },\n\n    // Add a model, or list of models to the set.\n    add: function(models, options) {\n      return this.set(models, _.extend({merge: false}, options, addOptions));\n    },\n\n    // Remove a model, or a list of models from the set.\n    remove: function(models, options) {\n      var singular = !_.isArray(models);\n      models = singular ? [models] : _.clone(models);\n      options || (options = {});\n      var i, l, index, model;\n      for (i = 0, l = models.length; i < l; i++) {\n        model = models[i] = this.get(models[i]);\n        if (!model) continue;\n        delete this._byId[model.id];\n        delete this._byId[model.cid];\n        index = this.indexOf(model);\n        this.models.splice(index, 1);\n        this.length--;\n        if (!options.silent) {\n          options.index = index;\n          model.trigger('remove', model, this, options);\n        }\n        this._removeReference(model, options);\n      }\n      return singular ? models[0] : models;\n    },\n\n    // Update a collection by `set`-ing a new list of models, adding new ones,\n    // removing models that are no longer present, and merging models that\n    // already exist in the collection, as necessary. Similar to **Model#set**,\n    // the core operation for updating the data contained by the collection.\n    set: function(models, options) {\n      options = _.defaults({}, options, setOptions);\n      if (options.parse) models = this.parse(models, options);\n      var singular = !_.isArray(models);\n      models = singular ? (models ? [models] : []) : _.clone(models);\n      var i, l, id, model, attrs, existing, sort;\n      var at = options.at;\n      var targetModel = this.model;\n      var sortable = this.comparator && (at == null) && options.sort !== false;\n      var sortAttr = _.isString(this.comparator) ? this.comparator : null;\n      var toAdd = [], toRemove = [], modelMap = {};\n      var add = options.add, merge = options.merge, remove = options.remove;\n      var order = !sortable && add && remove ? [] : false;\n\n      // Turn bare objects into model references, and prevent invalid models\n      // from being added.\n      for (i = 0, l = models.length; i < l; i++) {\n        attrs = models[i] || {};\n        if (attrs instanceof Model) {\n          id = model = attrs;\n        } else {\n          id = attrs[targetModel.prototype.idAttribute || 'id'];\n        }\n\n        // If a duplicate is found, prevent it from being added and\n        // optionally merge it into the existing model.\n        if (existing = this.get(id)) {\n          if (remove) modelMap[existing.cid] = true;\n          if (merge) {\n            attrs = attrs === model ? model.attributes : attrs;\n            if (options.parse) attrs = existing.parse(attrs, options);\n            existing.set(attrs, options);\n            if (sortable && !sort && existing.hasChanged(sortAttr)) sort = true;\n          }\n          models[i] = existing;\n\n        // If this is a new, valid model, push it to the `toAdd` list.\n        } else if (add) {\n          model = models[i] = this._prepareModel(attrs, options);\n          if (!model) continue;\n          toAdd.push(model);\n          this._addReference(model, options);\n        }\n\n        // Do not add multiple models with the same `id`.\n        model = existing || model;\n        if (order && (model.isNew() || !modelMap[model.id])) order.push(model);\n        modelMap[model.id] = true;\n      }\n\n      // Remove nonexistent models if appropriate.\n      if (remove) {\n        for (i = 0, l = this.length; i < l; ++i) {\n          if (!modelMap[(model = this.models[i]).cid]) toRemove.push(model);\n        }\n        if (toRemove.length) this.remove(toRemove, options);\n      }\n\n      // See if sorting is needed, update `length` and splice in new models.\n      if (toAdd.length || (order && order.length)) {\n        if (sortable) sort = true;\n        this.length += toAdd.length;\n        if (at != null) {\n          for (i = 0, l = toAdd.length; i < l; i++) {\n            this.models.splice(at + i, 0, toAdd[i]);\n          }\n        } else {\n          if (order) this.models.length = 0;\n          var orderedModels = order || toAdd;\n          for (i = 0, l = orderedModels.length; i < l; i++) {\n            this.models.push(orderedModels[i]);\n          }\n        }\n      }\n\n      // Silently sort the collection if appropriate.\n      if (sort) this.sort({silent: true});\n\n      // Unless silenced, it's time to fire all appropriate add/sort events.\n      if (!options.silent) {\n        for (i = 0, l = toAdd.length; i < l; i++) {\n          (model = toAdd[i]).trigger('add', model, this, options);\n        }\n        if (sort || (order && order.length)) this.trigger('sort', this, options);\n      }\n\n      // Return the added (or merged) model (or models).\n      return singular ? models[0] : models;\n    },\n\n    // When you have more items than you want to add or remove individually,\n    // you can reset the entire set with a new list of models, without firing\n    // any granular `add` or `remove` events. Fires `reset` when finished.\n    // Useful for bulk operations and optimizations.\n    reset: function(models, options) {\n      options || (options = {});\n      for (var i = 0, l = this.models.length; i < l; i++) {\n        this._removeReference(this.models[i], options);\n      }\n      options.previousModels = this.models;\n      this._reset();\n      models = this.add(models, _.extend({silent: true}, options));\n      if (!options.silent) this.trigger('reset', this, options);\n      return models;\n    },\n\n    // Add a model to the end of the collection.\n    push: function(model, options) {\n      return this.add(model, _.extend({at: this.length}, options));\n    },\n\n    // Remove a model from the end of the collection.\n    pop: function(options) {\n      var model = this.at(this.length - 1);\n      this.remove(model, options);\n      return model;\n    },\n\n    // Add a model to the beginning of the collection.\n    unshift: function(model, options) {\n      return this.add(model, _.extend({at: 0}, options));\n    },\n\n    // Remove a model from the beginning of the collection.\n    shift: function(options) {\n      var model = this.at(0);\n      this.remove(model, options);\n      return model;\n    },\n\n    // Slice out a sub-array of models from the collection.\n    slice: function() {\n      return slice.apply(this.models, arguments);\n    },\n\n    // Get a model from the set by id.\n    get: function(obj) {\n      if (obj == null) return void 0;\n      return this._byId[obj] || this._byId[obj.id] || this._byId[obj.cid];\n    },\n\n    // Get the model at the given index.\n    at: function(index) {\n      return this.models[index];\n    },\n\n    // Return models with matching attributes. Useful for simple cases of\n    // `filter`.\n    where: function(attrs, first) {\n      if (_.isEmpty(attrs)) return first ? void 0 : [];\n      return this[first ? 'find' : 'filter'](function(model) {\n        for (var key in attrs) {\n          if (attrs[key] !== model.get(key)) return false;\n        }\n        return true;\n      });\n    },\n\n    // Return the first model with matching attributes. Useful for simple cases\n    // of `find`.\n    findWhere: function(attrs) {\n      return this.where(attrs, true);\n    },\n\n    // Force the collection to re-sort itself. You don't need to call this under\n    // normal circumstances, as the set will maintain sort order as each item\n    // is added.\n    sort: function(options) {\n      if (!this.comparator) throw new Error('Cannot sort a set without a comparator');\n      options || (options = {});\n\n      // Run sort based on type of `comparator`.\n      if (_.isString(this.comparator) || this.comparator.length === 1) {\n        this.models = this.sortBy(this.comparator, this);\n      } else {\n        this.models.sort(_.bind(this.comparator, this));\n      }\n\n      if (!options.silent) this.trigger('sort', this, options);\n      return this;\n    },\n\n    // Pluck an attribute from each model in the collection.\n    pluck: function(attr) {\n      return _.invoke(this.models, 'get', attr);\n    },\n\n    // Fetch the default set of models for this collection, resetting the\n    // collection when they arrive. If `reset: true` is passed, the response\n    // data will be passed through the `reset` method instead of `set`.\n    fetch: function(options) {\n      options = options ? _.clone(options) : {};\n      if (options.parse === void 0) options.parse = true;\n      var success = options.success;\n      var collection = this;\n      options.success = function(resp) {\n        var method = options.reset ? 'reset' : 'set';\n        collection[method](resp, options);\n        if (success) success(collection, resp, options);\n        collection.trigger('sync', collection, resp, options);\n      };\n      wrapError(this, options);\n      return this.sync('read', this, options);\n    },\n\n    // Create a new instance of a model in this collection. Add the model to the\n    // collection immediately, unless `wait: true` is passed, in which case we\n    // wait for the server to agree.\n    create: function(model, options) {\n      options = options ? _.clone(options) : {};\n      if (!(model = this._prepareModel(model, options))) return false;\n      if (!options.wait) this.add(model, options);\n      var collection = this;\n      var success = options.success;\n      options.success = function(model, resp) {\n        if (options.wait) collection.add(model, options);\n        if (success) success(model, resp, options);\n      };\n      model.save(null, options);\n      return model;\n    },\n\n    // **parse** converts a response into a list of models to be added to the\n    // collection. The default implementation is just to pass it through.\n    parse: function(resp, options) {\n      return resp;\n    },\n\n    // Create a new collection with an identical list of models as this one.\n    clone: function() {\n      return new this.constructor(this.models);\n    },\n\n    // Private method to reset all internal state. Called when the collection\n    // is first initialized or reset.\n    _reset: function() {\n      this.length = 0;\n      this.models = [];\n      this._byId  = {};\n    },\n\n    // Prepare a hash of attributes (or other model) to be added to this\n    // collection.\n    _prepareModel: function(attrs, options) {\n      if (attrs instanceof Model) return attrs;\n      options = options ? _.clone(options) : {};\n      options.collection = this;\n      var model = new this.model(attrs, options);\n      if (!model.validationError) return model;\n      this.trigger('invalid', this, model.validationError, options);\n      return false;\n    },\n\n    // Internal method to create a model's ties to a collection.\n    _addReference: function(model, options) {\n      this._byId[model.cid] = model;\n      if (model.id != null) this._byId[model.id] = model;\n      if (!model.collection) model.collection = this;\n      model.on('all', this._onModelEvent, this);\n    },\n\n    // Internal method to sever a model's ties to a collection.\n    _removeReference: function(model, options) {\n      if (this === model.collection) delete model.collection;\n      model.off('all', this._onModelEvent, this);\n    },\n\n    // Internal method called every time a model in the set fires an event.\n    // Sets need to update their indexes when models change ids. All other\n    // events simply proxy through. \"add\" and \"remove\" events that originate\n    // in other collections are ignored.\n    _onModelEvent: function(event, model, collection, options) {\n      if ((event === 'add' || event === 'remove') && collection !== this) return;\n      if (event === 'destroy') this.remove(model, options);\n      if (model && event === 'change:' + model.idAttribute) {\n        delete this._byId[model.previous(model.idAttribute)];\n        if (model.id != null) this._byId[model.id] = model;\n      }\n      this.trigger.apply(this, arguments);\n    }\n\n  });\n\n  // Underscore methods that we want to implement on the Collection.\n  // 90% of the core usefulness of Backbone Collections is actually implemented\n  // right here:\n  var methods = ['forEach', 'each', 'map', 'collect', 'reduce', 'foldl',\n    'inject', 'reduceRight', 'foldr', 'find', 'detect', 'filter', 'select',\n    'reject', 'every', 'all', 'some', 'any', 'include', 'contains', 'invoke',\n    'max', 'min', 'toArray', 'size', 'first', 'head', 'take', 'initial', 'rest',\n    'tail', 'drop', 'last', 'without', 'difference', 'indexOf', 'shuffle',\n    'lastIndexOf', 'isEmpty', 'chain', 'sample'];\n\n  // Mix in each Underscore method as a proxy to `Collection#models`.\n  _.each(methods, function(method) {\n    Collection.prototype[method] = function() {\n      var args = slice.call(arguments);\n      args.unshift(this.models);\n      return _[method].apply(_, args);\n    };\n  });\n\n  // Underscore methods that take a property name as an argument.\n  var attributeMethods = ['groupBy', 'countBy', 'sortBy', 'indexBy'];\n\n  // Use attributes instead of properties.\n  _.each(attributeMethods, function(method) {\n    Collection.prototype[method] = function(value, context) {\n      var iterator = _.isFunction(value) ? value : function(model) {\n        return model.get(value);\n      };\n      return _[method](this.models, iterator, context);\n    };\n  });\n\n  // Backbone.View\n  // -------------\n\n  // Backbone Views are almost more convention than they are actual code. A View\n  // is simply a JavaScript object that represents a logical chunk of UI in the\n  // DOM. This might be a single item, an entire list, a sidebar or panel, or\n  // even the surrounding frame which wraps your whole app. Defining a chunk of\n  // UI as a **View** allows you to define your DOM events declaratively, without\n  // having to worry about render order ... and makes it easy for the view to\n  // react to specific changes in the state of your models.\n\n  // Creating a Backbone.View creates its initial element outside of the DOM,\n  // if an existing element is not provided...\n  var View = Backbone.View = function(options) {\n    this.cid = _.uniqueId('view');\n    options || (options = {});\n    _.extend(this, _.pick(options, viewOptions));\n    this._ensureElement();\n    this.initialize.apply(this, arguments);\n    this.delegateEvents();\n  };\n\n  // Cached regex to split keys for `delegate`.\n  var delegateEventSplitter = /^(\\S+)\\s*(.*)$/;\n\n  // List of view options to be merged as properties.\n  var viewOptions = ['model', 'collection', 'el', 'id', 'attributes', 'className', 'tagName', 'events'];\n\n  // Set up all inheritable **Backbone.View** properties and methods.\n  _.extend(View.prototype, Events, {\n\n    // The default `tagName` of a View's element is `\"div\"`.\n    tagName: 'div',\n\n    // jQuery delegate for element lookup, scoped to DOM elements within the\n    // current view. This should be preferred to global lookups where possible.\n    $: function(selector) {\n      return this.$el.find(selector);\n    },\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // **render** is the core function that your view should override, in order\n    // to populate its element (`this.el`), with the appropriate HTML. The\n    // convention is for **render** to always return `this`.\n    render: function() {\n      return this;\n    },\n\n    // Remove this view by taking the element out of the DOM, and removing any\n    // applicable Backbone.Events listeners.\n    remove: function() {\n      this.$el.remove();\n      this.stopListening();\n      return this;\n    },\n\n    // Change the view's element (`this.el` property), including event\n    // re-delegation.\n    setElement: function(element, delegate) {\n      if (this.$el) this.undelegateEvents();\n      this.$el = element instanceof Backbone.$ ? element : Backbone.$(element);\n      this.el = this.$el[0];\n      if (delegate !== false) this.delegateEvents();\n      return this;\n    },\n\n    // Set callbacks, where `this.events` is a hash of\n    //\n    // *{\"event selector\": \"callback\"}*\n    //\n    //     {\n    //       'mousedown .title':  'edit',\n    //       'click .button':     'save',\n    //       'click .open':       function(e) { ... }\n    //     }\n    //\n    // pairs. Callbacks will be bound to the view, with `this` set properly.\n    // Uses event delegation for efficiency.\n    // Omitting the selector binds the event to `this.el`.\n    // This only works for delegate-able events: not `focus`, `blur`, and\n    // not `change`, `submit`, and `reset` in Internet Explorer.\n    delegateEvents: function(events) {\n      if (!(events || (events = _.result(this, 'events')))) return this;\n      this.undelegateEvents();\n      for (var key in events) {\n        var method = events[key];\n        if (!_.isFunction(method)) method = this[events[key]];\n        if (!method) continue;\n\n        var match = key.match(delegateEventSplitter);\n        var eventName = match[1], selector = match[2];\n        method = _.bind(method, this);\n        eventName += '.delegateEvents' + this.cid;\n        if (selector === '') {\n          this.$el.on(eventName, method);\n        } else {\n          this.$el.on(eventName, selector, method);\n        }\n      }\n      return this;\n    },\n\n    // Clears all callbacks previously bound to the view with `delegateEvents`.\n    // You usually don't need to use this, but may wish to if you have multiple\n    // Backbone views attached to the same DOM element.\n    undelegateEvents: function() {\n      this.$el.off('.delegateEvents' + this.cid);\n      return this;\n    },\n\n    // Ensure that the View has a DOM element to render into.\n    // If `this.el` is a string, pass it through `$()`, take the first\n    // matching element, and re-assign it to `el`. Otherwise, create\n    // an element from the `id`, `className` and `tagName` properties.\n    _ensureElement: function() {\n      if (!this.el) {\n        var attrs = _.extend({}, _.result(this, 'attributes'));\n        if (this.id) attrs.id = _.result(this, 'id');\n        if (this.className) attrs['class'] = _.result(this, 'className');\n        var $el = Backbone.$('<' + _.result(this, 'tagName') + '>').attr(attrs);\n        this.setElement($el, false);\n      } else {\n        this.setElement(_.result(this, 'el'), false);\n      }\n    }\n\n  });\n\n  // Backbone.sync\n  // -------------\n\n  // Override this function to change the manner in which Backbone persists\n  // models to the server. You will be passed the type of request, and the\n  // model in question. By default, makes a RESTful Ajax request\n  // to the model's `url()`. Some possible customizations could be:\n  //\n  // * Use `setTimeout` to batch rapid-fire updates into a single request.\n  // * Send up the models as XML instead of JSON.\n  // * Persist models via WebSockets instead of Ajax.\n  //\n  // Turn on `Backbone.emulateHTTP` in order to send `PUT` and `DELETE` requests\n  // as `POST`, with a `_method` parameter containing the true HTTP method,\n  // as well as all requests with the body as `application/x-www-form-urlencoded`\n  // instead of `application/json` with the model in a param named `model`.\n  // Useful when interfacing with server-side languages like **PHP** that make\n  // it difficult to read the body of `PUT` requests.\n  Backbone.sync = function(method, model, options) {\n    var type = methodMap[method];\n\n    // Default options, unless specified.\n    _.defaults(options || (options = {}), {\n      emulateHTTP: Backbone.emulateHTTP,\n      emulateJSON: Backbone.emulateJSON\n    });\n\n    // Default JSON-request options.\n    var params = {type: type, dataType: 'json'};\n\n    // Ensure that we have a URL.\n    if (!options.url) {\n      params.url = _.result(model, 'url') || urlError();\n    }\n\n    // Ensure that we have the appropriate request data.\n    if (options.data == null && model && (method === 'create' || method === 'update' || method === 'patch')) {\n      params.contentType = 'application/json';\n      params.data = JSON.stringify(options.attrs || model.toJSON(options));\n    }\n\n    // For older servers, emulate JSON by encoding the request into an HTML-form.\n    if (options.emulateJSON) {\n      params.contentType = 'application/x-www-form-urlencoded';\n      params.data = params.data ? {model: params.data} : {};\n    }\n\n    // For older servers, emulate HTTP by mimicking the HTTP method with `_method`\n    // And an `X-HTTP-Method-Override` header.\n    if (options.emulateHTTP && (type === 'PUT' || type === 'DELETE' || type === 'PATCH')) {\n      params.type = 'POST';\n      if (options.emulateJSON) params.data._method = type;\n      var beforeSend = options.beforeSend;\n      options.beforeSend = function(xhr) {\n        xhr.setRequestHeader('X-HTTP-Method-Override', type);\n        if (beforeSend) return beforeSend.apply(this, arguments);\n      };\n    }\n\n    // Don't process data on a non-GET request.\n    if (params.type !== 'GET' && !options.emulateJSON) {\n      params.processData = false;\n    }\n\n    // If we're sending a `PATCH` request, and we're in an old Internet Explorer\n    // that still has ActiveX enabled by default, override jQuery to use that\n    // for XHR instead. Remove this line when jQuery supports `PATCH` on IE8.\n    if (params.type === 'PATCH' && noXhrPatch) {\n      params.xhr = function() {\n        return new ActiveXObject(\"Microsoft.XMLHTTP\");\n      };\n    }\n\n    // Make the request, allowing the user to override any Ajax options.\n    var xhr = options.xhr = Backbone.ajax(_.extend(params, options));\n    model.trigger('request', model, xhr, options);\n    return xhr;\n  };\n\n  var noXhrPatch =\n    typeof window !== 'undefined' && !!window.ActiveXObject &&\n      !(window.XMLHttpRequest && (new XMLHttpRequest).dispatchEvent);\n\n  // Map from CRUD to HTTP for our default `Backbone.sync` implementation.\n  var methodMap = {\n    'create': 'POST',\n    'update': 'PUT',\n    'patch':  'PATCH',\n    'delete': 'DELETE',\n    'read':   'GET'\n  };\n\n  // Set the default implementation of `Backbone.ajax` to proxy through to `$`.\n  // Override this if you'd like to use a different library.\n  Backbone.ajax = function() {\n    return Backbone.$.ajax.apply(Backbone.$, arguments);\n  };\n\n  // Backbone.Router\n  // ---------------\n\n  // Routers map faux-URLs to actions, and fire events when routes are\n  // matched. Creating a new one sets its `routes` hash, if not set statically.\n  var Router = Backbone.Router = function(options) {\n    options || (options = {});\n    if (options.routes) this.routes = options.routes;\n    this._bindRoutes();\n    this.initialize.apply(this, arguments);\n  };\n\n  // Cached regular expressions for matching named param parts and splatted\n  // parts of route strings.\n  var optionalParam = /\\((.*?)\\)/g;\n  var namedParam    = /(\\(\\?)?:\\w+/g;\n  var splatParam    = /\\*\\w+/g;\n  var escapeRegExp  = /[\\-{}\\[\\]+?.,\\\\\\^$|#\\s]/g;\n\n  // Set up all inheritable **Backbone.Router** properties and methods.\n  _.extend(Router.prototype, Events, {\n\n    // Initialize is an empty function by default. Override it with your own\n    // initialization logic.\n    initialize: function(){},\n\n    // Manually bind a single named route to a callback. For example:\n    //\n    //     this.route('search/:query/p:num', 'search', function(query, num) {\n    //       ...\n    //     });\n    //\n    route: function(route, name, callback) {\n      if (!_.isRegExp(route)) route = this._routeToRegExp(route);\n      if (_.isFunction(name)) {\n        callback = name;\n        name = '';\n      }\n      if (!callback) callback = this[name];\n      var router = this;\n      Backbone.history.route(route, function(fragment) {\n        var args = router._extractParameters(route, fragment);\n        router.execute(callback, args);\n        router.trigger.apply(router, ['route:' + name].concat(args));\n        router.trigger('route', name, args);\n        Backbone.history.trigger('route', router, name, args);\n      });\n      return this;\n    },\n\n    // Execute a route handler with the provided parameters.  This is an\n    // excellent place to do pre-route setup or post-route cleanup.\n    execute: function(callback, args) {\n      if (callback) callback.apply(this, args);\n    },\n\n    // Simple proxy to `Backbone.history` to save a fragment into the history.\n    navigate: function(fragment, options) {\n      Backbone.history.navigate(fragment, options);\n      return this;\n    },\n\n    // Bind all defined routes to `Backbone.history`. We have to reverse the\n    // order of the routes here to support behavior where the most general\n    // routes can be defined at the bottom of the route map.\n    _bindRoutes: function() {\n      if (!this.routes) return;\n      this.routes = _.result(this, 'routes');\n      var route, routes = _.keys(this.routes);\n      while ((route = routes.pop()) != null) {\n        this.route(route, this.routes[route]);\n      }\n    },\n\n    // Convert a route string into a regular expression, suitable for matching\n    // against the current location hash.\n    _routeToRegExp: function(route) {\n      route = route.replace(escapeRegExp, '\\\\$&')\n                   .replace(optionalParam, '(?:$1)?')\n                   .replace(namedParam, function(match, optional) {\n                     return optional ? match : '([^/?]+)';\n                   })\n                   .replace(splatParam, '([^?]*?)');\n      return new RegExp('^' + route + '(?:\\\\?([\\\\s\\\\S]*))?$');\n    },\n\n    // Given a route, and a URL fragment that it matches, return the array of\n    // extracted decoded parameters. Empty or unmatched parameters will be\n    // treated as `null` to normalize cross-browser behavior.\n    _extractParameters: function(route, fragment) {\n      var params = route.exec(fragment).slice(1);\n      return _.map(params, function(param, i) {\n        // Don't decode the search params.\n        if (i === params.length - 1) return param || null;\n        return param ? decodeURIComponent(param) : null;\n      });\n    }\n\n  });\n\n  // Backbone.History\n  // ----------------\n\n  // Handles cross-browser history management, based on either\n  // [pushState](http://diveintohtml5.info/history.html) and real URLs, or\n  // [onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange)\n  // and URL fragments. If the browser supports neither (old IE, natch),\n  // falls back to polling.\n  var History = Backbone.History = function() {\n    this.handlers = [];\n    _.bindAll(this, 'checkUrl');\n\n    // Ensure that `History` can be used outside of the browser.\n    if (typeof window !== 'undefined') {\n      this.location = window.location;\n      this.history = window.history;\n    }\n  };\n\n  // Cached regex for stripping a leading hash/slash and trailing space.\n  var routeStripper = /^[#\\/]|\\s+$/g;\n\n  // Cached regex for stripping leading and trailing slashes.\n  var rootStripper = /^\\/+|\\/+$/g;\n\n  // Cached regex for detecting MSIE.\n  var isExplorer = /msie [\\w.]+/;\n\n  // Cached regex for removing a trailing slash.\n  var trailingSlash = /\\/$/;\n\n  // Cached regex for stripping urls of hash.\n  var pathStripper = /#.*$/;\n\n  // Has the history handling already been started?\n  History.started = false;\n\n  // Set up all inheritable **Backbone.History** properties and methods.\n  _.extend(History.prototype, Events, {\n\n    // The default interval to poll for hash changes, if necessary, is\n    // twenty times a second.\n    interval: 50,\n\n    // Are we at the app root?\n    atRoot: function() {\n      return this.location.pathname.replace(/[^\\/]$/, '$&/') === this.root;\n    },\n\n    // Gets the true hash value. Cannot use location.hash directly due to bug\n    // in Firefox where location.hash will always be decoded.\n    getHash: function(window) {\n      var match = (window || this).location.href.match(/#(.*)$/);\n      return match ? match[1] : '';\n    },\n\n    // Get the cross-browser normalized URL fragment, either from the URL,\n    // the hash, or the override.\n    getFragment: function(fragment, forcePushState) {\n      if (fragment == null) {\n        if (this._hasPushState || !this._wantsHashChange || forcePushState) {\n          fragment = decodeURI(this.location.pathname + this.location.search);\n          var root = this.root.replace(trailingSlash, '');\n          if (!fragment.indexOf(root)) fragment = fragment.slice(root.length);\n        } else {\n          fragment = this.getHash();\n        }\n      }\n      return fragment.replace(routeStripper, '');\n    },\n\n    // Start the hash change handling, returning `true` if the current URL matches\n    // an existing route, and `false` otherwise.\n    start: function(options) {\n      if (History.started) throw new Error(\"Backbone.history has already been started\");\n      History.started = true;\n\n      // Figure out the initial configuration. Do we need an iframe?\n      // Is pushState desired ... is it available?\n      this.options          = _.extend({root: '/'}, this.options, options);\n      this.root             = this.options.root;\n      this._wantsHashChange = this.options.hashChange !== false;\n      this._wantsPushState  = !!this.options.pushState;\n      this._hasPushState    = !!(this.options.pushState && this.history && this.history.pushState);\n      var fragment          = this.getFragment();\n      var docMode           = document.documentMode;\n      var oldIE             = (isExplorer.exec(navigator.userAgent.toLowerCase()) && (!docMode || docMode <= 7));\n\n      // Normalize root to always include a leading and trailing slash.\n      this.root = ('/' + this.root + '/').replace(rootStripper, '/');\n\n      if (oldIE && this._wantsHashChange) {\n        var frame = Backbone.$('<iframe src=\"javascript:0\" tabindex=\"-1\">');\n        this.iframe = frame.hide().appendTo('body')[0].contentWindow;\n        this.navigate(fragment);\n      }\n\n      // Depending on whether we're using pushState or hashes, and whether\n      // 'onhashchange' is supported, determine how we check the URL state.\n      if (this._hasPushState) {\n        Backbone.$(window).on('popstate', this.checkUrl);\n      } else if (this._wantsHashChange && ('onhashchange' in window) && !oldIE) {\n        Backbone.$(window).on('hashchange', this.checkUrl);\n      } else if (this._wantsHashChange) {\n        this._checkUrlInterval = setInterval(this.checkUrl, this.interval);\n      }\n\n      // Determine if we need to change the base url, for a pushState link\n      // opened by a non-pushState browser.\n      this.fragment = fragment;\n      var loc = this.location;\n\n      // Transition from hashChange to pushState or vice versa if both are\n      // requested.\n      if (this._wantsHashChange && this._wantsPushState) {\n\n        // If we've started off with a route from a `pushState`-enabled\n        // browser, but we're currently in a browser that doesn't support it...\n        if (!this._hasPushState && !this.atRoot()) {\n          this.fragment = this.getFragment(null, true);\n          this.location.replace(this.root + '#' + this.fragment);\n          // Return immediately as browser will do redirect to new url\n          return true;\n\n        // Or if we've started out with a hash-based route, but we're currently\n        // in a browser where it could be `pushState`-based instead...\n        } else if (this._hasPushState && this.atRoot() && loc.hash) {\n          this.fragment = this.getHash().replace(routeStripper, '');\n          this.history.replaceState({}, document.title, this.root + this.fragment);\n        }\n\n      }\n\n      if (!this.options.silent) return this.loadUrl();\n    },\n\n    // Disable Backbone.history, perhaps temporarily. Not useful in a real app,\n    // but possibly useful for unit testing Routers.\n    stop: function() {\n      Backbone.$(window).off('popstate', this.checkUrl).off('hashchange', this.checkUrl);\n      if (this._checkUrlInterval) clearInterval(this._checkUrlInterval);\n      History.started = false;\n    },\n\n    // Add a route to be tested when the fragment changes. Routes added later\n    // may override previous routes.\n    route: function(route, callback) {\n      this.handlers.unshift({route: route, callback: callback});\n    },\n\n    // Checks the current URL to see if it has changed, and if it has,\n    // calls `loadUrl`, normalizing across the hidden iframe.\n    checkUrl: function(e) {\n      var current = this.getFragment();\n      if (current === this.fragment && this.iframe) {\n        current = this.getFragment(this.getHash(this.iframe));\n      }\n      if (current === this.fragment) return false;\n      if (this.iframe) this.navigate(current);\n      this.loadUrl();\n    },\n\n    // Attempt to load the current URL fragment. If a route succeeds with a\n    // match, returns `true`. If no defined routes matches the fragment,\n    // returns `false`.\n    loadUrl: function(fragment) {\n      fragment = this.fragment = this.getFragment(fragment);\n      return _.any(this.handlers, function(handler) {\n        if (handler.route.test(fragment)) {\n          handler.callback(fragment);\n          return true;\n        }\n      });\n    },\n\n    // Save a fragment into the hash history, or replace the URL state if the\n    // 'replace' option is passed. You are responsible for properly URL-encoding\n    // the fragment in advance.\n    //\n    // The options object can contain `trigger: true` if you wish to have the\n    // route callback be fired (not usually desirable), or `replace: true`, if\n    // you wish to modify the current URL without adding an entry to the history.\n    navigate: function(fragment, options) {\n      if (!History.started) return false;\n      if (!options || options === true) options = {trigger: !!options};\n\n      var url = this.root + (fragment = this.getFragment(fragment || ''));\n\n      // Strip the hash for matching.\n      fragment = fragment.replace(pathStripper, '');\n\n      if (this.fragment === fragment) return;\n      this.fragment = fragment;\n\n      // Don't include a trailing slash on the root.\n      if (fragment === '' && url !== '/') url = url.slice(0, -1);\n\n      // If pushState is available, we use it to set the fragment as a real URL.\n      if (this._hasPushState) {\n        this.history[options.replace ? 'replaceState' : 'pushState']({}, document.title, url);\n\n      // If hash changes haven't been explicitly disabled, update the hash\n      // fragment to store history.\n      } else if (this._wantsHashChange) {\n        this._updateHash(this.location, fragment, options.replace);\n        if (this.iframe && (fragment !== this.getFragment(this.getHash(this.iframe)))) {\n          // Opening and closing the iframe tricks IE7 and earlier to push a\n          // history entry on hash-tag change.  When replace is true, we don't\n          // want this.\n          if(!options.replace) this.iframe.document.open().close();\n          this._updateHash(this.iframe.location, fragment, options.replace);\n        }\n\n      // If you've told us that you explicitly don't want fallback hashchange-\n      // based history, then `navigate` becomes a page refresh.\n      } else {\n        return this.location.assign(url);\n      }\n      if (options.trigger) return this.loadUrl(fragment);\n    },\n\n    // Update the hash location, either replacing the current entry, or adding\n    // a new one to the browser history.\n    _updateHash: function(location, fragment, replace) {\n      if (replace) {\n        var href = location.href.replace(/(javascript:|#).*$/, '');\n        location.replace(href + '#' + fragment);\n      } else {\n        // Some browsers require that `hash` contains a leading #.\n        location.hash = '#' + fragment;\n      }\n    }\n\n  });\n\n  // Create the default Backbone.history.\n  Backbone.history = new History;\n\n  // Helpers\n  // -------\n\n  // Helper function to correctly set up the prototype chain, for subclasses.\n  // Similar to `goog.inherits`, but uses a hash of prototype properties and\n  // class properties to be extended.\n  var extend = function(protoProps, staticProps) {\n    var parent = this;\n    var child;\n\n    // The constructor function for the new subclass is either defined by you\n    // (the \"constructor\" property in your `extend` definition), or defaulted\n    // by us to simply call the parent's constructor.\n    if (protoProps && _.has(protoProps, 'constructor')) {\n      child = protoProps.constructor;\n    } else {\n      child = function(){ return parent.apply(this, arguments); };\n    }\n\n    // Add static properties to the constructor function, if supplied.\n    _.extend(child, parent, staticProps);\n\n    // Set the prototype chain to inherit from `parent`, without calling\n    // `parent`'s constructor function.\n    var Surrogate = function(){ this.constructor = child; };\n    Surrogate.prototype = parent.prototype;\n    child.prototype = new Surrogate;\n\n    // Add prototype properties (instance properties) to the subclass,\n    // if supplied.\n    if (protoProps) _.extend(child.prototype, protoProps);\n\n    // Set a convenience property in case the parent's prototype is needed\n    // later.\n    child.__super__ = parent.prototype;\n\n    return child;\n  };\n\n  // Set up inheritance for the model, collection, router, view and history.\n  Model.extend = Collection.extend = Router.extend = View.extend = History.extend = extend;\n\n  // Throw an error when a URL is needed, and none is supplied.\n  var urlError = function() {\n    throw new Error('A \"url\" property or function must be specified');\n  };\n\n  // Wrap an optional error callback with a fallback error event.\n  var wrapError = function(model, options) {\n    var error = options.error;\n    options.error = function(resp) {\n      if (error) error(model, resp, options);\n      model.trigger('error', model, resp, options);\n    };\n  };\n\n  return Backbone;\n\n}));\n","/**\n * Backbone Forms v0.13.0\n *\n * Copyright (c) 2013 Charles Davison, Pow Media Ltd\n *\n * License and more information at:\n * http://github.com/powmedia/backbone-forms\n */\n;(function(root) {\n\n  //DEPENDENCIES\n  //CommonJS\n  if (typeof exports !== 'undefined' && typeof require !== 'undefined') {\n    var $ = root.jQuery || root.Zepto || root.ender || require('jquery'),\n        _ = root._ || require('underscore'),\n        Backbone = root.Backbone || require('backbone');\n  }\n\n  //Browser\n  else {\n    var $ = root.jQuery,\n        _ = root._,\n        Backbone = root.Backbone;\n  }\n\n\n  //SOURCE\n  //==================================================================================================\n//FORM\n//==================================================================================================\n\nvar Form = Backbone.View.extend({\n\n  /**\n   * Constructor\n   * \n   * @param {Object} [options.schema]\n   * @param {Backbone.Model} [options.model]\n   * @param {Object} [options.data]\n   * @param {String[]|Object[]} [options.fieldsets]\n   * @param {String[]} [options.fields]\n   * @param {String} [options.idPrefix]\n   * @param {Form.Field} [options.Field]\n   * @param {Form.Fieldset} [options.Fieldset]\n   * @param {Function} [options.template]\n   */\n  initialize: function(options) {\n    var self = this;\n\n    options = options || {};\n\n    //Find the schema to use\n    var schema = this.schema = (function() {\n      //Prefer schema from options\n      if (options.schema) return _.result(options, 'schema');\n\n      //Then schema on model\n      var model = options.model;\n      if (model && model.schema) {\n        return (_.isFunction(model.schema)) ? model.schema() : model.schema;\n      }\n\n      //Then built-in schema\n      if (self.schema) {\n        return (_.isFunction(self.schema)) ? self.schema() : self.schema;\n      }\n\n      //Fallback to empty schema\n      return {};\n    })();\n\n    //Store important data\n    _.extend(this, _.pick(options, 'model', 'data', 'idPrefix', 'templateData'));\n\n    //Override defaults\n    var constructor = this.constructor;\n    this.template = options.template || this.template || constructor.template;\n    this.Fieldset = options.Fieldset || this.Fieldset || constructor.Fieldset;\n    this.Field = options.Field || this.Field || constructor.Field;\n    this.NestedField = options.NestedField || this.NestedField || constructor.NestedField;\n\n    //Check which fields will be included (defaults to all)\n    var selectedFields = this.selectedFields = options.fields || _.keys(schema);\n\n    //Create fields\n    var fields = this.fields = {};\n\n    _.each(selectedFields, function(key) {\n      var fieldSchema = schema[key];\n      fields[key] = this.createField(key, fieldSchema);\n    }, this);\n\n    //Create fieldsets\n    var fieldsetSchema = options.fieldsets || [selectedFields],\n        fieldsets = this.fieldsets = [];\n\n    _.each(fieldsetSchema, function(itemSchema) {\n      this.fieldsets.push(this.createFieldset(itemSchema));\n    }, this);\n  },\n\n  /**\n   * Creates a Fieldset instance\n   *\n   * @param {String[]|Object[]} schema       Fieldset schema\n   *\n   * @return {Form.Fieldset}\n   */\n  createFieldset: function(schema) {\n    var options = {\n      schema: schema,\n      fields: this.fields\n    };\n\n    return new this.Fieldset(options);\n  },\n\n  /**\n   * Creates a Field instance\n   *\n   * @param {String} key\n   * @param {Object} schema       Field schema\n   *\n   * @return {Form.Field}\n   */\n  createField: function(key, schema) {\n    var options = {\n      form: this,\n      key: key,\n      schema: schema,\n      idPrefix: this.idPrefix\n    };\n\n    if (this.model) {\n      options.model = this.model;\n    } else if (this.data) {\n      options.value = this.data[key];\n    } else {\n      options.value = null;\n    }\n\n    var field = new this.Field(options);\n\n    this.listenTo(field.editor, 'all', this.handleEditorEvent);\n\n    return field;\n  },\n\n  /**\n   * Callback for when an editor event is fired.\n   * Re-triggers events on the form as key:event and triggers additional form-level events\n   *\n   * @param {String} event\n   * @param {Editor} editor\n   */\n  handleEditorEvent: function(event, editor) {\n    //Re-trigger editor events on the form\n    var formEvent = editor.key+':'+event;\n\n    this.trigger.call(this, formEvent, this, editor, Array.prototype.slice.call(arguments, 2));\n\n    //Trigger additional events\n    switch (event) {\n      case 'change':\n        this.trigger('change', this);\n        break;\n\n      case 'focus':\n        if (!this.hasFocus) this.trigger('focus', this);\n        break;\n\n      case 'blur':\n        if (this.hasFocus) {\n          //TODO: Is the timeout etc needed?\n          var self = this;\n          setTimeout(function() {\n            var focusedField = _.find(self.fields, function(field) {\n              return field.editor.hasFocus;\n            });\n\n            if (!focusedField) self.trigger('blur', self);\n          }, 0);\n        }\n        break;\n    }\n  },\n\n  render: function() {\n    var self = this,\n        fields = this.fields;\n\n    //Render form\n    var $form = $($.trim(this.template(_.result(this, 'templateData'))));\n\n    //Render standalone editors\n    $form.find('[data-editors]').add($form).each(function(i, el) {\n      var $container = $(el),\n          selection = $container.attr('data-editors');\n\n      if (_.isUndefined(selection)) return;\n\n      //Work out which fields to include\n      var keys = (selection == '*')\n        ? self.selectedFields || _.keys(fields)\n        : selection.split(',');\n\n      //Add them\n      _.each(keys, function(key) {\n        var field = fields[key];\n\n        $container.append(field.editor.render().el);\n      });\n    });\n\n    //Render standalone fields\n    $form.find('[data-fields]').add($form).each(function(i, el) {\n      var $container = $(el),\n          selection = $container.attr('data-fields');\n\n      if (_.isUndefined(selection)) return;\n\n      //Work out which fields to include\n      var keys = (selection == '*')\n        ? self.selectedFields || _.keys(fields)\n        : selection.split(',');\n\n      //Add them\n      _.each(keys, function(key) {\n        var field = fields[key];\n\n        $container.append(field.render().el);\n      });\n    });\n\n    //Render fieldsets\n    $form.find('[data-fieldsets]').add($form).each(function(i, el) {\n      var $container = $(el),\n          selection = $container.attr('data-fieldsets');\n\n      if (_.isUndefined(selection)) return;\n\n      _.each(self.fieldsets, function(fieldset) {\n        $container.append(fieldset.render().el);\n      });\n    });\n\n    //Set the main element\n    this.setElement($form);\n    \n    //Set class\n    $form.addClass(this.className);\n\n    return this;\n  },\n\n  /**\n   * Validate the data\n   *\n   * @return {Object}       Validation errors\n   */\n  validate: function(options) {\n    var self = this,\n        fields = this.fields,\n        model = this.model,\n        errors = {};\n\n    options = options || {};\n\n    //Collect errors from schema validation\n    _.each(fields, function(field) {\n      var error = field.validate();\n      if (error) {\n        errors[field.key] = error;\n      }\n    });\n\n    //Get errors from default Backbone model validator\n    if (!options.skipModelValidate && model && model.validate) {\n      var modelErrors = model.validate(this.getValue());\n\n      if (modelErrors) {\n        var isDictionary = _.isObject(modelErrors) && !_.isArray(modelErrors);\n\n        //If errors are not in object form then just store on the error object\n        if (!isDictionary) {\n          errors._others = errors._others || [];\n          errors._others.push(modelErrors);\n        }\n\n        //Merge programmatic errors (requires model.validate() to return an object e.g. { fieldKey: 'error' })\n        if (isDictionary) {\n          _.each(modelErrors, function(val, key) {\n            //Set error on field if there isn't one already\n            if (fields[key] && !errors[key]) {\n              fields[key].setError(val);\n              errors[key] = val;\n            }\n\n            else {\n              //Otherwise add to '_others' key\n              errors._others = errors._others || [];\n              var tmpErr = {};\n              tmpErr[key] = val;\n              errors._others.push(tmpErr);\n            }\n          });\n        }\n      }\n    }\n\n    return _.isEmpty(errors) ? null : errors;\n  },\n\n  /**\n   * Update the model with all latest values.\n   *\n   * @param {Object} [options]  Options to pass to Model#set (e.g. { silent: true })\n   *\n   * @return {Object}  Validation errors\n   */\n  commit: function(options) {\n    //Validate\n    options = options || {};\n\n    var validateOptions = {\n        skipModelValidate: !options.validate\n    };\n\n    var errors = this.validate(validateOptions);\n    if (errors) return errors;\n\n    //Commit\n    var modelError;\n\n    var setOptions = _.extend({\n      error: function(model, e) {\n        modelError = e;\n      }\n    }, options);\n\n    this.model.set(this.getValue(), setOptions);\n    \n    if (modelError) return modelError;\n  },\n\n  /**\n   * Get all the field values as an object.\n   * Use this method when passing data instead of objects\n   *\n   * @param {String} [key]    Specific field value to get\n   */\n  getValue: function(key) {\n    //Return only given key if specified\n    if (key) return this.fields[key].getValue();\n\n    //Otherwise return entire form\n    var values = {};\n    _.each(this.fields, function(field) {\n      values[field.key] = field.getValue();\n    });\n\n    return values;\n  },\n\n  /**\n   * Update field values, referenced by key\n   *\n   * @param {Object|String} key     New values to set, or property to set\n   * @param val                     Value to set\n   */\n  setValue: function(prop, val) {\n    var data = {};\n    if (typeof prop === 'string') {\n      data[prop] = val;\n    } else {\n      data = prop;\n    }\n\n    var key;\n    for (key in this.schema) {\n      if (data[key] !== undefined) {\n        this.fields[key].setValue(data[key]);\n      }\n    }\n  },\n\n  /**\n   * Returns the editor for a given field key\n   *\n   * @param {String} key\n   *\n   * @return {Editor}\n   */\n  getEditor: function(key) {\n    var field = this.fields[key];\n    if (!field) throw new Error('Field not found: '+key);\n\n    return field.editor;\n  },\n\n  /**\n   * Gives the first editor in the form focus\n   */\n  focus: function() {\n    if (this.hasFocus) return;\n\n    //Get the first field\n    var fieldset = this.fieldsets[0],\n        field = fieldset.getFieldAt(0);\n\n    if (!field) return;\n\n    //Set focus\n    field.editor.focus();\n  },\n\n  /**\n   * Removes focus from the currently focused editor\n   */\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    var focusedField = _.find(this.fields, function(field) {\n      return field.editor.hasFocus;\n    });\n\n    if (focusedField) focusedField.editor.blur();\n  },\n\n  /**\n   * Manages the hasFocus property\n   *\n   * @param {String} event\n   */\n  trigger: function(event) {\n    if (event === 'focus') {\n      this.hasFocus = true;\n    }\n    else if (event === 'blur') {\n      this.hasFocus = false;\n    }\n\n    return Backbone.View.prototype.trigger.apply(this, arguments);\n  },\n\n  /**\n   * Override default remove function in order to remove embedded views\n   *\n   * TODO: If editors are included directly with data-editors=\"x\", they need to be removed\n   * May be best to use XView to manage adding/removing views\n   */\n  remove: function() {\n    _.each(this.fieldsets, function(fieldset) {\n      fieldset.remove();\n    });\n\n    _.each(this.fields, function(field) {\n      field.remove();\n    });\n\n    return Backbone.View.prototype.remove.apply(this, arguments);\n  }\n\n}, {\n\n  //STATICS\n  template: _.template('\\\n    <form data-fieldsets></form>\\\n  ', null, this.templateSettings),\n\n  templateSettings: {\n    evaluate: /<%([\\s\\S]+?)%>/g, \n    interpolate: /<%=([\\s\\S]+?)%>/g, \n    escape: /<%-([\\s\\S]+?)%>/g\n  },\n\n  editors: {}\n\n});\n\n  \n//==================================================================================================\n//VALIDATORS\n//==================================================================================================\n\nForm.validators = (function() {\n\n  var validators = {};\n\n  validators.errMessages = {\n    required: 'Required',\n    regexp: 'Invalid',\n    email: 'Invalid email address',\n    url: 'Invalid URL',\n    match: _.template('Must match field \"<%= field %>\"', null, Form.templateSettings)\n  };\n  \n  validators.required = function(options) {\n    options = _.extend({\n      type: 'required',\n      message: this.errMessages.required\n    }, options);\n     \n    return function required(value) {\n      options.value = value;\n      \n      var err = {\n        type: options.type,\n        message: _.isFunction(options.message) ? options.message(options) : options.message\n      };\n      \n      if (value === null || value === undefined || value === false || value === '') return err;\n    };\n  };\n  \n  validators.regexp = function(options) {\n    if (!options.regexp) throw new Error('Missing required \"regexp\" option for \"regexp\" validator');\n  \n    options = _.extend({\n      type: 'regexp',\n      message: this.errMessages.regexp\n    }, options);\n    \n    return function regexp(value) {\n      options.value = value;\n      \n      var err = {\n        type: options.type,\n        message: _.isFunction(options.message) ? options.message(options) : options.message\n      };\n      \n      //Don't check empty values (add a 'required' validator for this)\n      if (value === null || value === undefined || value === '') return;\n\n      if (!options.regexp.test(value)) return err;\n    };\n  };\n  \n  validators.email = function(options) {\n    options = _.extend({\n      type: 'email',\n      message: this.errMessages.email,\n      regexp: /^[\\w\\-]{1,}([\\w\\-\\+.]{1,1}[\\w\\-]{1,}){0,}[@][\\w\\-]{1,}([.]([\\w\\-]{1,})){1,3}$/\n    }, options);\n    \n    return validators.regexp(options);\n  };\n  \n  validators.url = function(options) {\n    options = _.extend({\n      type: 'url',\n      message: this.errMessages.url,\n      regexp: /^(http|https):\\/\\/(([A-Z0-9][A-Z0-9_\\-]*)(\\.[A-Z0-9][A-Z0-9_\\-]*)+)(:(\\d+))?\\/?/i\n    }, options);\n    \n    return validators.regexp(options);\n  };\n  \n  validators.match = function(options) {\n    if (!options.field) throw new Error('Missing required \"field\" options for \"match\" validator');\n    \n    options = _.extend({\n      type: 'match',\n      message: this.errMessages.match\n    }, options);\n    \n    return function match(value, attrs) {\n      options.value = value;\n      \n      var err = {\n        type: options.type,\n        message: _.isFunction(options.message) ? options.message(options) : options.message\n      };\n      \n      //Don't check empty values (add a 'required' validator for this)\n      if (value === null || value === undefined || value === '') return;\n      \n      if (value !== attrs[options.field]) return err;\n    };\n  };\n\n\n  return validators;\n\n})();\n\n\n//==================================================================================================\n//FIELDSET\n//==================================================================================================\n\nForm.Fieldset = Backbone.View.extend({\n\n  /**\n   * Constructor\n   *\n   * Valid fieldset schemas:\n   *   ['field1', 'field2']\n   *   { legend: 'Some Fieldset', fields: ['field1', 'field2'] }\n   *\n   * @param {String[]|Object[]} options.schema      Fieldset schema\n   * @param {Object} options.fields           Form fields\n   */\n  initialize: function(options) {\n    options = options || {};\n\n    //Create the full fieldset schema, merging defaults etc.\n    var schema = this.schema = this.createSchema(options.schema);\n\n    //Store the fields for this fieldset\n    this.fields = _.pick(options.fields, schema.fields);\n    \n    //Override defaults\n    this.template = options.template || this.constructor.template;\n  },\n\n  /**\n   * Creates the full fieldset schema, normalising, merging defaults etc.\n   *\n   * @param {String[]|Object[]} schema\n   *\n   * @return {Object}\n   */\n  createSchema: function(schema) {\n    //Normalise to object\n    if (_.isArray(schema)) {\n      schema = { fields: schema };\n    }\n\n    //Add null legend to prevent template error\n    schema.legend = schema.legend || null;\n\n    return schema;\n  },\n\n  /**\n   * Returns the field for a given index\n   *\n   * @param {Number} index\n   *\n   * @return {Field}\n   */\n  getFieldAt: function(index) {\n    var key = this.schema.fields[index];\n\n    return this.fields[key];\n  },\n\n  /**\n   * Returns data to pass to template\n   *\n   * @return {Object}\n   */\n  templateData: function() {\n    return this.schema;\n  },\n\n  /**\n   * Renders the fieldset and fields\n   *\n   * @return {Fieldset} this\n   */\n  render: function() {\n    var schema = this.schema,\n        fields = this.fields;\n\n    //Render fieldset\n    var $fieldset = $($.trim(this.template(_.result(this, 'templateData'))));\n\n    //Render fields\n    $fieldset.find('[data-fields]').add($fieldset).each(function(i, el) {\n      var $container = $(el),\n          selection = $container.attr('data-fields');\n\n      if (_.isUndefined(selection)) return;\n\n      _.each(fields, function(field) {\n        $container.append(field.render().el);\n      });\n    });\n\n    this.setElement($fieldset);\n\n    return this;\n  },\n\n  /**\n   * Remove embedded views then self\n   */\n  remove: function() {\n    _.each(this.fields, function(field) {\n      field.remove();\n    });\n\n    Backbone.View.prototype.remove.call(this);\n  }\n  \n}, {\n  //STATICS\n\n  template: _.template('\\\n    <fieldset data-fields>\\\n      <% if (legend) { %>\\\n        <legend><%= legend %></legend>\\\n      <% } %>\\\n    </fieldset>\\\n  ', null, Form.templateSettings)\n\n});\n\n\n//==================================================================================================\n//FIELD\n//==================================================================================================\n\nForm.Field = Backbone.View.extend({\n\n  /**\n   * Constructor\n   * \n   * @param {Object} options.key\n   * @param {Object} options.form\n   * @param {Object} [options.schema]\n   * @param {Function} [options.schema.template]\n   * @param {Backbone.Model} [options.model]\n   * @param {Object} [options.value]\n   * @param {String} [options.idPrefix]\n   * @param {Function} [options.template]\n   * @param {Function} [options.errorClassName]\n   */\n  initialize: function(options) {\n    options = options || {};\n\n    //Store important data\n    _.extend(this, _.pick(options, 'form', 'key', 'model', 'value', 'idPrefix'));\n\n    //Create the full field schema, merging defaults etc.\n    var schema = this.schema = this.createSchema(options.schema);\n\n    //Override defaults\n    this.template = options.template || schema.template || this.constructor.template;\n    this.errorClassName = options.errorClassName || this.constructor.errorClassName;\n\n    //Create editor\n    this.editor = this.createEditor();\n  },\n\n  /**\n   * Creates the full field schema, merging defaults etc.\n   *\n   * @param {Object|String} schema\n   *\n   * @return {Object}\n   */\n  createSchema: function(schema) {\n    if (_.isString(schema)) schema = { type: schema };\n\n    //Set defaults\n    schema = _.extend({\n      type: 'Text',\n      title: this.createTitle()\n    }, schema);\n\n    //Get the real constructor function i.e. if type is a string such as 'Text'\n    schema.type = (_.isString(schema.type)) ? Form.editors[schema.type] : schema.type;\n\n    return schema;\n  },\n\n  /**\n   * Creates the editor specified in the schema; either an editor string name or\n   * a constructor function\n   *\n   * @return {View}\n   */\n  createEditor: function() {\n    var options = _.extend(\n      _.pick(this, 'schema', 'form', 'key', 'model', 'value'),\n      { id: this.createEditorId() }\n    );\n\n    var constructorFn = this.schema.type;\n\n    return new constructorFn(options);\n  },\n\n  /**\n   * Creates the ID that will be assigned to the editor\n   *\n   * @return {String}\n   */\n  createEditorId: function() {\n    var prefix = this.idPrefix,\n        id = this.key;\n\n    //Replace periods with underscores (e.g. for when using paths)\n    id = id.replace(/\\./g, '_');\n\n    //If a specific ID prefix is set, use it\n    if (_.isString(prefix) || _.isNumber(prefix)) return prefix + id;\n    if (_.isNull(prefix)) return id;\n\n    //Otherwise, if there is a model use it's CID to avoid conflicts when multiple forms are on the page\n    if (this.model) return this.model.cid + '_' + id;\n\n    return id;\n  },\n\n  /**\n   * Create the default field title (label text) from the key name.\n   * (Converts 'camelCase' to 'Camel Case')\n   *\n   * @return {String}\n   */\n  createTitle: function() {\n    var str = this.key;\n\n    //Add spaces\n    str = str.replace(/([A-Z])/g, ' $1');\n\n    //Uppercase first character\n    str = str.replace(/^./, function(str) { return str.toUpperCase(); });\n\n    return str;\n  },\n\n  /**\n   * Returns the data to be passed to the template\n   *\n   * @return {Object}\n   */\n  templateData: function() {\n    var schema = this.schema;\n\n    return {\n      help: schema.help || '',\n      title: schema.title,\n      fieldAttrs: schema.fieldAttrs,\n      editorAttrs: schema.editorAttrs,\n      key: this.key,\n      editorId: this.editor.id\n    };\n  },\n\n  /**\n   * Render the field and editor\n   *\n   * @return {Field} self\n   */\n  render: function() {\n    var schema = this.schema,\n        editor = this.editor;\n\n    //Only render the editor if Hidden\n    if (schema.type == Form.editors.Hidden) {\n      return this.setElement(editor.render().el);\n    }\n\n    //Render field\n    var $field = $($.trim(this.template(_.result(this, 'templateData'))));\n\n    if (schema.fieldClass) $field.addClass(schema.fieldClass);\n    if (schema.fieldAttrs) $field.attr(schema.fieldAttrs);\n\n    //Render editor\n    $field.find('[data-editor]').add($field).each(function(i, el) {\n      var $container = $(el),\n          selection = $container.attr('data-editor');\n\n      if (_.isUndefined(selection)) return;\n\n      $container.append(editor.render().el);\n    });\n\n    this.setElement($field);\n\n    return this;\n  },\n\n  /**\n   * Check the validity of the field\n   *\n   * @return {String}\n   */\n  validate: function() {\n    var error = this.editor.validate();\n\n    if (error) {\n      this.setError(error.message);\n    } else {\n      this.clearError();\n    }\n\n    return error;\n  },\n\n  /**\n   * Set the field into an error state, adding the error class and setting the error message\n   *\n   * @param {String} msg     Error message\n   */\n  setError: function(msg) {\n    //Nested form editors (e.g. Object) set their errors internally\n    if (this.editor.hasNestedForm) return;\n\n    //Add error CSS class\n    this.$el.addClass(this.errorClassName);\n\n    //Set error message\n    this.$('[data-error]').html(msg);\n  },\n\n  /**\n   * Clear the error state and reset the help message\n   */\n  clearError: function() {\n    //Remove error CSS class\n    this.$el.removeClass(this.errorClassName);\n\n    //Clear error message\n    this.$('[data-error]').empty();\n  },\n\n  /**\n   * Update the model with the new value from the editor\n   *\n   * @return {Mixed}\n   */\n  commit: function() {\n    return this.editor.commit();\n  },\n\n  /**\n   * Get the value from the editor\n   *\n   * @return {Mixed}\n   */\n  getValue: function() {\n    return this.editor.getValue();\n  },\n\n  /**\n   * Set/change the value of the editor\n   *\n   * @param {Mixed} value\n   */\n  setValue: function(value) {\n    this.editor.setValue(value);\n  },\n\n  /**\n   * Give the editor focus\n   */\n  focus: function() {\n    this.editor.focus();\n  },\n\n  /**\n   * Remove focus from the editor\n   */\n  blur: function() {\n    this.editor.blur();\n  },\n\n  /**\n   * Remove the field and editor views\n   */\n  remove: function() {\n    this.editor.remove();\n\n    Backbone.View.prototype.remove.call(this);\n  }\n\n}, {\n  //STATICS\n\n  template: _.template('\\\n    <div>\\\n      <label for=\"<%= editorId %>\"><%= title %></label>\\\n      <div>\\\n        <span data-editor></span>\\\n        <div data-error></div>\\\n        <div><%= help %></div>\\\n      </div>\\\n    </div>\\\n  ', null, Form.templateSettings),\n\n  /**\n   * CSS class name added to the field when there is a validation error\n   */\n  errorClassName: 'error'\n\n});\n\n\n//==================================================================================================\n//NESTEDFIELD\n//==================================================================================================\n\nForm.NestedField = Form.Field.extend({\n\n  template: _.template($.trim('\\\n    <div>\\\n      <span data-editor></span>\\\n      <% if (help) { %>\\\n        <div><%= help %></div>\\\n      <% } %>\\\n      <div data-error></div>\\\n    </div>\\\n  '), null, Form.templateSettings)\n\n});\n\n/**\n * Base editor (interface). To be extended, not used directly\n *\n * @param {Object} options\n * @param {String} [options.id]         Editor ID\n * @param {Model} [options.model]       Use instead of value, and use commit()\n * @param {String} [options.key]        The model attribute key. Required when using 'model'\n * @param {Mixed} [options.value]       When not using a model. If neither provided, defaultValue will be used\n * @param {Object} [options.schema]     Field schema; may be required by some editors\n * @param {Object} [options.validators] Validators; falls back to those stored on schema\n * @param {Object} [options.form]       The form\n */\nForm.Editor = Form.editors.Base = Backbone.View.extend({\n\n  defaultValue: null,\n\n  hasFocus: false,\n\n  initialize: function(options) {\n    var options = options || {};\n\n    //Set initial value\n    if (options.model) {\n      if (!options.key) throw new Error(\"Missing option: 'key'\");\n\n      this.model = options.model;\n\n      this.value = this.model.get(options.key);\n    }\n    else if (options.value !== undefined) {\n      this.value = options.value;\n    }\n\n    if (this.value === undefined) this.value = this.defaultValue;\n\n    //Store important data\n    _.extend(this, _.pick(options, 'key', 'form'));\n\n    var schema = this.schema = options.schema || {};\n\n    this.validators = options.validators || schema.validators;\n\n    //Main attributes\n    this.$el.attr('id', this.id);\n    this.$el.attr('name', this.getName());\n    if (schema.editorClass) this.$el.addClass(schema.editorClass);\n    if (schema.editorAttrs) this.$el.attr(schema.editorAttrs);\n  },\n\n  /**\n   * Get the value for the form input 'name' attribute\n   *\n   * @return {String}\n   *\n   * @api private\n   */\n  getName: function() {\n    var key = this.key || '';\n\n    //Replace periods with underscores (e.g. for when using paths)\n    return key.replace(/\\./g, '_');\n  },\n\n  /**\n   * Get editor value\n   * Extend and override this method to reflect changes in the DOM\n   *\n   * @return {Mixed}\n   */\n  getValue: function() {\n    return this.value;\n  },\n\n  /**\n   * Set editor value\n   * Extend and override this method to reflect changes in the DOM\n   *\n   * @param {Mixed} value\n   */\n  setValue: function(value) {\n    this.value = value;\n  },\n\n  /**\n   * Give the editor focus\n   * Extend and override this method\n   */\n  focus: function() {\n    throw new Error('Not implemented');\n  },\n  \n  /**\n   * Remove focus from the editor\n   * Extend and override this method\n   */\n  blur: function() {\n    throw new Error('Not implemented');\n  },\n\n  /**\n   * Update the model with the current value\n   *\n   * @param {Object} [options]              Options to pass to model.set()\n   * @param {Boolean} [options.validate]    Set to true to trigger built-in model validation\n   *\n   * @return {Mixed} error\n   */\n  commit: function(options) {\n    var error = this.validate();\n    if (error) return error;\n\n    this.listenTo(this.model, 'invalid', function(model, e) {\n      error = e;\n    });\n    this.model.set(this.key, this.getValue(), options);\n\n    if (error) return error;\n  },\n\n  /**\n   * Check validity\n   *\n   * @return {Object|Undefined}\n   */\n  validate: function() {\n    var $el = this.$el,\n        error = null,\n        value = this.getValue(),\n        formValues = this.form ? this.form.getValue() : {},\n        validators = this.validators,\n        getValidator = this.getValidator;\n\n    if (validators) {\n      //Run through validators until an error is found\n      _.every(validators, function(validator) {\n        error = getValidator(validator)(value, formValues);\n\n        return error ? false : true;\n      });\n    }\n\n    return error;\n  },\n\n  /**\n   * Set this.hasFocus, or call parent trigger()\n   *\n   * @param {String} event\n   */\n  trigger: function(event) {\n    if (event === 'focus') {\n      this.hasFocus = true;\n    }\n    else if (event === 'blur') {\n      this.hasFocus = false;\n    }\n\n    return Backbone.View.prototype.trigger.apply(this, arguments);\n  },\n\n  /**\n   * Returns a validation function based on the type defined in the schema\n   *\n   * @param {RegExp|String|Function} validator\n   * @return {Function}\n   */\n  getValidator: function(validator) {\n    var validators = Form.validators;\n\n    //Convert regular expressions to validators\n    if (_.isRegExp(validator)) {\n      return validators.regexp({ regexp: validator });\n    }\n    \n    //Use a built-in validator if given a string\n    if (_.isString(validator)) {\n      if (!validators[validator]) throw new Error('Validator \"'+validator+'\" not found');\n      \n      return validators[validator]();\n    }\n\n    //Functions can be used directly\n    if (_.isFunction(validator)) return validator;\n\n    //Use a customised built-in validator if given an object\n    if (_.isObject(validator) && validator.type) {\n      var config = validator;\n      \n      return validators[config.type](config);\n    }\n    \n    //Unkown validator type\n    throw new Error('Invalid validator: ' + validator);\n  }\n});\n\n/**\n * Text\n * \n * Text input with focus, blur and change events\n */\nForm.editors.Text = Form.Editor.extend({\n\n  tagName: 'input',\n\n  defaultValue: '',\n\n  previousValue: '',\n\n  events: {\n    'keyup':    'determineChange',\n    'keypress': function(event) {\n      var self = this;\n      setTimeout(function() {\n        self.determineChange();\n      }, 0);\n    },\n    'select':   function(event) {\n      this.trigger('select', this);\n    },\n    'focus':    function(event) {\n      this.trigger('focus', this);\n    },\n    'blur':     function(event) {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function(options) {\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    var schema = this.schema;\n\n    //Allow customising text type (email, phone etc.) for HTML5 browsers\n    var type = 'text';\n\n    if (schema && schema.editorAttrs && schema.editorAttrs.type) type = schema.editorAttrs.type;\n    if (schema && schema.dataType) type = schema.dataType;\n\n    this.$el.attr('type', type);\n  },\n\n  /**\n   * Adds the editor to the DOM\n   */\n  render: function() {\n    this.setValue(this.value);\n\n    return this;\n  },\n\n  determineChange: function(event) {\n    var currentValue = this.$el.val();\n    var changed = (currentValue !== this.previousValue);\n\n    if (changed) {\n      this.previousValue = currentValue;\n\n      this.trigger('change', this);\n    }\n  },\n\n  /**\n   * Returns the current editor value\n   * @return {String}\n   */\n  getValue: function() {\n    return this.$el.val();\n  },\n\n  /**\n   * Sets the value of the form element\n   * @param {String}\n   */\n  setValue: function(value) {\n    this.$el.val(value);\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$el.focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$el.blur();\n  },\n\n  select: function() {\n    this.$el.select();\n  }\n\n});\n\n/**\n * TextArea editor\n */\nForm.editors.TextArea = Form.editors.Text.extend({\n\n  tagName: 'textarea',\n\n  /**\n   * Override Text constructor so type property isn't set (issue #261)\n   */\n  initialize: function(options) {\n    Form.editors.Base.prototype.initialize.call(this, options);\n  }\n\n});\n\n/**\n * Password editor\n */\nForm.editors.Password = Form.editors.Text.extend({\n\n  initialize: function(options) {\n    Form.editors.Text.prototype.initialize.call(this, options);\n\n    this.$el.attr('type', 'password');\n  }\n\n});\n\n/**\n * NUMBER\n * \n * Normal text input that only allows a number. Letters etc. are not entered.\n */\nForm.editors.Number = Form.editors.Text.extend({\n\n  defaultValue: 0,\n\n  events: _.extend({}, Form.editors.Text.prototype.events, {\n    'keypress': 'onKeyPress',\n    'change': 'onKeyPress'\n  }),\n\n  initialize: function(options) {\n    Form.editors.Text.prototype.initialize.call(this, options);\n\n    var schema = this.schema;\n\n    this.$el.attr('type', 'number');\n\n    if (!schema || !schema.editorAttrs || !schema.editorAttrs.step) {\n      // provide a default for `step` attr,\n      // but don't overwrite if already specified\n      this.$el.attr('step', 'any');\n    }\n  },\n\n  /**\n   * Check value is numeric\n   */\n  onKeyPress: function(event) {\n    var self = this,\n        delayedDetermineChange = function() {\n          setTimeout(function() {\n            self.determineChange();\n          }, 0);\n        };\n\n    //Allow backspace\n    if (event.charCode === 0) {\n      delayedDetermineChange();\n      return;\n    }\n\n    //Get the whole new value so that we can prevent things like double decimals points etc.\n    var newVal = this.$el.val()\n    if( event.charCode != undefined ) {\n      newVal = newVal + String.fromCharCode(event.charCode);\n    }\n\n    var numeric = /^[0-9]*\\.?[0-9]*?$/.test(newVal);\n\n    if (numeric) {\n      delayedDetermineChange();\n    }\n    else {\n      event.preventDefault();\n    }\n  },\n\n  getValue: function() {\n    var value = this.$el.val();\n\n    return value === \"\" ? null : parseFloat(value, 10);\n  },\n\n  setValue: function(value) {\n    value = (function() {\n      if (_.isNumber(value)) return value;\n\n      if (_.isString(value) && value !== '') return parseFloat(value, 10);\n\n      return null;\n    })();\n\n    if (_.isNaN(value)) value = null;\n\n    Form.editors.Text.prototype.setValue.call(this, value);\n  }\n\n});\n\n/**\n * Hidden editor\n */\nForm.editors.Hidden = Form.editors.Text.extend({\n\n  defaultValue: '',\n\n  initialize: function(options) {\n    Form.editors.Text.prototype.initialize.call(this, options);\n\n    this.$el.attr('type', 'hidden');\n  },\n\n  focus: function() {\n\n  },\n\n  blur: function() {\n\n  }\n\n});\n\n/**\n * Checkbox editor\n *\n * Creates a single checkbox, i.e. boolean value\n */\nForm.editors.Checkbox = Form.editors.Base.extend({\n\n  defaultValue: false,\n\n  tagName: 'input',\n\n  events: {\n    'click':  function(event) {\n      this.trigger('change', this);\n    },\n    'focus':  function(event) {\n      this.trigger('focus', this);\n    },\n    'blur':   function(event) {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function(options) {\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    this.$el.attr('type', 'checkbox');\n  },\n\n  /**\n   * Adds the editor to the DOM\n   */\n  render: function() {\n    this.setValue(this.value);\n\n    return this;\n  },\n\n  getValue: function() {\n    return this.$el.prop('checked');\n  },\n\n  setValue: function(value) {\n    if (value) {\n      this.$el.prop('checked', true);\n    }else{\n      this.$el.prop('checked', false);\n    }\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$el.focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$el.blur();\n  }\n\n});\n\n/**\n * Select editor\n *\n * Renders a <select> with given options\n *\n * Requires an 'options' value on the schema.\n *  Can be an array of options, a function that calls back with the array of options, a string of HTML\n *  or a Backbone collection. If a collection, the models must implement a toString() method\n */\nForm.editors.Select = Form.editors.Base.extend({\n\n  tagName: 'select',\n\n  events: {\n    'change': function(event) {\n      this.trigger('change', this);\n    },\n    'focus':  function(event) {\n      this.trigger('focus', this);\n    },\n    'blur':   function(event) {\n      this.trigger('blur', this);\n    }\n  },\n\n  initialize: function(options) {\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    if (!this.schema || !this.schema.options) throw new Error(\"Missing required 'schema.options'\");\n  },\n\n  render: function() {\n    this.setOptions(this.schema.options);\n\n    return this;\n  },\n\n  /**\n   * Sets the options that populate the <select>\n   *\n   * @param {Mixed} options\n   */\n  setOptions: function(options) {\n    var self = this;\n\n    //If a collection was passed, check if it needs fetching\n    if (options instanceof Backbone.Collection) {\n      var collection = options;\n\n      //Don't do the fetch if it's already populated\n      if (collection.length > 0) {\n        this.renderOptions(options);\n      } else {\n        collection.fetch({\n          success: function(collection) {\n            self.renderOptions(options);\n          }\n        });\n      }\n    }\n\n    //If a function was passed, run it to get the options\n    else if (_.isFunction(options)) {\n      options(function(result) {\n        self.renderOptions(result);\n      }, self);\n    }\n\n    //Otherwise, ready to go straight to renderOptions\n    else {\n      this.renderOptions(options);\n    }\n  },\n\n  /**\n   * Adds the <option> html to the DOM\n   * @param {Mixed}   Options as a simple array e.g. ['option1', 'option2']\n   *                      or as an array of objects e.g. [{val: 543, label: 'Title for object 543'}]\n   *                      or as a string of <option> HTML to insert into the <select>\n   *                      or any object\n   */\n  renderOptions: function(options) {\n    var $select = this.$el,\n        html;\n\n    html = this._getOptionsHtml(options);\n\n    //Insert options\n    $select.html(html);\n\n    //Select correct option\n    this.setValue(this.value);\n  },\n\n  _getOptionsHtml: function(options) {\n    var html;\n    //Accept string of HTML\n    if (_.isString(options)) {\n      html = options;\n    }\n\n    //Or array\n    else if (_.isArray(options)) {\n      html = this._arrayToHtml(options);\n    }\n\n    //Or Backbone collection\n    else if (options instanceof Backbone.Collection) {\n      html = this._collectionToHtml(options);\n    }\n\n    else if (_.isFunction(options)) {\n      var newOptions;\n\n      options(function(opts) {\n        newOptions = opts;\n      }, this);\n\n      html = this._getOptionsHtml(newOptions);\n    //Or any object\n    }else{\n      html=this._objectToHtml(options);\n    }\n\n    return html;\n  },\n\n\n  getValue: function() {\n    return this.$el.val();\n  },\n\n  setValue: function(value) {\n    this.$el.val(value);\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$el.focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$el.blur();\n  },\n\n  /**\n   * Transforms a collection into HTML ready to use in the renderOptions method\n   * @param {Backbone.Collection}\n   * @return {String}\n   */\n  _collectionToHtml: function(collection) {\n    //Convert collection to array first\n    var array = [];\n    collection.each(function(model) {\n      array.push({ val: model.id, label: model.toString() });\n    });\n\n    //Now convert to HTML\n    var html = this._arrayToHtml(array);\n\n    return html;\n  },\n  /**\n   * Transforms an object into HTML ready to use in the renderOptions method\n   * @param {Object}\n   * @return {String}\n   */\n  _objectToHtml: function(obj) {\n    //Convert object to array first\n    var array = [];\n    for(var key in obj){\n      if( obj.hasOwnProperty( key ) ) {\n        array.push({ val: key, label: obj[key] });\n      }\n    }\n\n    //Now convert to HTML\n    var html = this._arrayToHtml(array);\n\n    return html;\n  },\n\n\n\n  /**\n   * Create the <option> HTML\n   * @param {Array}   Options as a simple array e.g. ['option1', 'option2']\n   *                      or as an array of objects e.g. [{val: 543, label: 'Title for object 543'}]\n   * @return {String} HTML\n   */\n  _arrayToHtml: function(array) {\n    var html = [];\n\n    //Generate HTML\n    _.each(array, function(option) {\n      if (_.isObject(option)) {\n        if (option.group) {\n          html.push('<optgroup label=\"'+option.group+'\">');\n          html.push(this._getOptionsHtml(option.options))\n          html.push('</optgroup>');\n        } else {\n          var val = (option.val || option.val === 0) ? option.val : '';\n          html.push('<option value=\"'+val+'\">'+option.label+'</option>');\n        }\n      }\n      else {\n        html.push('<option>'+option+'</option>');\n      }\n    }, this);\n\n    return html.join('');\n  }\n\n});\n\n/**\n * Radio editor\n *\n * Renders a <ul> with given options represented as <li> objects containing radio buttons\n *\n * Requires an 'options' value on the schema.\n *  Can be an array of options, a function that calls back with the array of options, a string of HTML\n *  or a Backbone collection. If a collection, the models must implement a toString() method\n */\nForm.editors.Radio = Form.editors.Select.extend({\n\n  tagName: 'ul',\n\n  events: {\n    'change input[type=radio]': function() {\n      this.trigger('change', this);\n    },\n    'focus input[type=radio]': function() {\n      if (this.hasFocus) return;\n      this.trigger('focus', this);\n    },\n    'blur input[type=radio]': function() {\n      if (!this.hasFocus) return;\n      var self = this;\n      setTimeout(function() {\n        if (self.$('input[type=radio]:focus')[0]) return;\n        self.trigger('blur', self);\n      }, 0);\n    }\n  },\n\n  getValue: function() {\n    return this.$('input[type=radio]:checked').val();\n  },\n\n  setValue: function(value) {\n    this.$('input[type=radio]').val([value]);\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    var checked = this.$('input[type=radio]:checked');\n    if (checked[0]) {\n      checked.focus();\n      return;\n    }\n\n    this.$('input[type=radio]').first().focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$('input[type=radio]:focus').blur();\n  },\n\n  /**\n   * Create the radio list HTML\n   * @param {Array}   Options as a simple array e.g. ['option1', 'option2']\n   *                      or as an array of objects e.g. [{val: 543, label: 'Title for object 543'}]\n   * @return {String} HTML\n   */\n  _arrayToHtml: function (array) {\n    var html = [];\n    var self = this;\n\n    _.each(array, function(option, index) {\n      var itemHtml = '<li>';\n      if (_.isObject(option)) {\n        var val = (option.val || option.val === 0) ? option.val : '';\n        itemHtml += ('<input type=\"radio\" name=\"'+self.getName()+'\" value=\"'+val+'\" id=\"'+self.id+'-'+index+'\" />');\n        itemHtml += ('<label for=\"'+self.id+'-'+index+'\">'+option.label+'</label>');\n      }\n      else {\n        itemHtml += ('<input type=\"radio\" name=\"'+self.getName()+'\" value=\"'+option+'\" id=\"'+self.id+'-'+index+'\" />');\n        itemHtml += ('<label for=\"'+self.id+'-'+index+'\">'+option+'</label>');\n      }\n      itemHtml += '</li>';\n      html.push(itemHtml);\n    });\n\n    return html.join('');\n  }\n\n});\n\n/**\n * Checkboxes editor\n *\n * Renders a <ul> with given options represented as <li> objects containing checkboxes\n *\n * Requires an 'options' value on the schema.\n *  Can be an array of options, a function that calls back with the array of options, a string of HTML\n *  or a Backbone collection. If a collection, the models must implement a toString() method\n */\nForm.editors.Checkboxes = Form.editors.Select.extend({\n\n  tagName: 'ul',\n\n  groupNumber: 0,\n\n  events: {\n    'click input[type=checkbox]': function() {\n      this.trigger('change', this);\n    },\n    'focus input[type=checkbox]': function() {\n      if (this.hasFocus) return;\n      this.trigger('focus', this);\n    },\n    'blur input[type=checkbox]':  function() {\n      if (!this.hasFocus) return;\n      var self = this;\n      setTimeout(function() {\n        if (self.$('input[type=checkbox]:focus')[0]) return;\n        self.trigger('blur', self);\n      }, 0);\n    }\n  },\n\n  getValue: function() {\n    var values = [];\n    this.$('input[type=checkbox]:checked').each(function() {\n      values.push($(this).val());\n    });\n    return values;\n  },\n\n  setValue: function(values) {\n    if (!_.isArray(values)) values = [values];\n    this.$('input[type=checkbox]').val(values);\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$('input[type=checkbox]').first().focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$('input[type=checkbox]:focus').blur();\n  },\n\n  /**\n   * Create the checkbox list HTML\n   * @param {Array}   Options as a simple array e.g. ['option1', 'option2']\n   *                      or as an array of objects e.g. [{val: 543, label: 'Title for object 543'}]\n   * @return {String} HTML\n   */\n  _arrayToHtml: function (array) {\n    var html = [];\n    var self = this;\n\n    _.each(array, function(option, index) {\n      var itemHtml = '<li>';\n\t\t\tvar close = true;\n      if (_.isObject(option)) {\n        if (option.group) {\n          var originalId = self.id;\n          self.id += \"-\" + self.groupNumber++; \n          itemHtml = ('<fieldset class=\"group\"> <legend>'+option.group+'</legend>');\n          itemHtml += (self._arrayToHtml(option.options));\n          itemHtml += ('</fieldset>');\n          self.id = originalId;\n\t\t\t\t\tclose = false;\n        }else{\n          var val = (option.val || option.val === 0) ? option.val : '';\n          itemHtml += ('<input type=\"checkbox\" name=\"'+self.getName()+'\" value=\"'+val+'\" id=\"'+self.id+'-'+index+'\" />');\n          itemHtml += ('<label for=\"'+self.id+'-'+index+'\">'+option.label+'</label>');\n        }\n      }\n      else {\n        itemHtml += ('<input type=\"checkbox\" name=\"'+self.getName()+'\" value=\"'+option+'\" id=\"'+self.id+'-'+index+'\" />');\n        itemHtml += ('<label for=\"'+self.id+'-'+index+'\">'+option+'</label>');\n      }\n\t\t\tif(close){\n\t\t\t\titemHtml += '</li>';\n\t\t\t}\n      html.push(itemHtml);\n    });\n\n    return html.join('');\n  }\n\n});\n\n/**\n * Object editor\n *\n * Creates a child form. For editing Javascript objects\n *\n * @param {Object} options\n * @param {Form} options.form                 The form this editor belongs to; used to determine the constructor for the nested form\n * @param {Object} options.schema             The schema for the object\n * @param {Object} options.schema.subSchema   The schema for the nested form\n */\nForm.editors.Object = Form.editors.Base.extend({\n  //Prevent error classes being set on the main control; they are internally on the individual fields\n  hasNestedForm: true,\n\n  initialize: function(options) {\n    //Set default value for the instance so it's not a shared object\n    this.value = {};\n\n    //Init\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    //Check required options\n    if (!this.form) throw new Error('Missing required option \"form\"');\n    if (!this.schema.subSchema) throw new Error(\"Missing required 'schema.subSchema' option for Object editor\");\n  },\n\n  render: function() {\n    //Get the constructor for creating the nested form; i.e. the same constructor as used by the parent form\n    var NestedForm = this.form.constructor;\n\n    //Create the nested form\n    this.nestedForm = new NestedForm({\n      schema: this.schema.subSchema,\n      data: this.value,\n      idPrefix: this.id + '_',\n      Field: NestedForm.NestedField\n    });\n\n    this._observeFormEvents();\n\n    this.$el.html(this.nestedForm.render().el);\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  },\n\n  getValue: function() {\n    if (this.nestedForm) return this.nestedForm.getValue();\n\n    return this.value;\n  },\n\n  setValue: function(value) {\n    this.value = value;\n\n    this.render();\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.nestedForm.focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.nestedForm.blur();\n  },\n\n  remove: function() {\n    this.nestedForm.remove();\n\n    Backbone.View.prototype.remove.call(this);\n  },\n\n  validate: function() {\n    return this.nestedForm.validate();\n  },\n\n  _observeFormEvents: function() {\n    if (!this.nestedForm) return;\n    \n    this.nestedForm.on('all', function() {\n      // args = [\"key:change\", form, fieldEditor]\n      var args = _.toArray(arguments);\n      args[1] = this;\n      // args = [\"key:change\", this=objectEditor, fieldEditor]\n\n      this.trigger.apply(this, args);\n    }, this);\n  }\n\n});\n\n/**\n * NestedModel editor\n *\n * Creates a child form. For editing nested Backbone models\n *\n * Special options:\n *   schema.model:   Embedded model constructor\n */\nForm.editors.NestedModel = Form.editors.Object.extend({\n  initialize: function(options) {\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    if (!this.form) throw new Error('Missing required option \"form\"');\n    if (!options.schema.model) throw new Error('Missing required \"schema.model\" option for NestedModel editor');\n  },\n\n  render: function() {\n    //Get the constructor for creating the nested form; i.e. the same constructor as used by the parent form\n    var NestedForm = this.form.constructor;\n\n    var data = this.value || {},\n        key = this.key,\n        nestedModel = this.schema.model;\n\n    //Wrap the data in a model if it isn't already a model instance\n    var modelInstance = (data.constructor === nestedModel) ? data : new nestedModel(data);\n\n    this.nestedForm = new NestedForm({\n      model: modelInstance,\n      idPrefix: this.id + '_',\n      fieldTemplate: 'nestedField'\n    });\n\n    this._observeFormEvents();\n\n    //Render form\n    this.$el.html(this.nestedForm.render().el);\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  },\n\n  /**\n   * Update the embedded model, checking for nested validation errors and pass them up\n   * Then update the main model if all OK\n   *\n   * @return {Error|null} Validation error or null\n   */\n  commit: function() {\n    var error = this.nestedForm.commit();\n    if (error) {\n      this.$el.addClass('error');\n      return error;\n    }\n\n    return Form.editors.Object.prototype.commit.call(this);\n  }\n\n});\n\n/**\n * Date editor\n *\n * Schema options\n * @param {Number|String} [options.schema.yearStart]  First year in list. Default: 100 years ago\n * @param {Number|String} [options.schema.yearEnd]    Last year in list. Default: current year\n *\n * Config options (if not set, defaults to options stored on the main Date class)\n * @param {Boolean} [options.showMonthNames]  Use month names instead of numbers. Default: true\n * @param {String[]} [options.monthNames]     Month names. Default: Full English names\n */\nForm.editors.Date = Form.editors.Base.extend({\n\n  events: {\n    'change select':  function() {\n      this.updateHidden();\n      this.trigger('change', this);\n    },\n    'focus select':   function() {\n      if (this.hasFocus) return;\n      this.trigger('focus', this);\n    },\n    'blur select':    function() {\n      if (!this.hasFocus) return;\n      var self = this;\n      setTimeout(function() {\n        if (self.$('select:focus')[0]) return;\n        self.trigger('blur', self);\n      }, 0);\n    }\n  },\n\n  initialize: function(options) {\n    options = options || {};\n\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    var Self = Form.editors.Date,\n        today = new Date();\n\n    //Option defaults\n    this.options = _.extend({\n      monthNames: Self.monthNames,\n      showMonthNames: Self.showMonthNames\n    }, options);\n\n    //Schema defaults\n    this.schema = _.extend({\n      yearStart: today.getFullYear() - 100,\n      yearEnd: today.getFullYear()\n    }, options.schema || {});\n\n    //Cast to Date\n    if (this.value && !_.isDate(this.value)) {\n      this.value = new Date(this.value);\n    }\n\n    //Set default date\n    if (!this.value) {\n      var date = new Date();\n      date.setSeconds(0);\n      date.setMilliseconds(0);\n\n      this.value = date;\n    }\n\n    //Template\n    this.template = options.template || this.constructor.template;\n  },\n\n  render: function() {\n    var options = this.options,\n        schema = this.schema;\n\n    var datesOptions = _.map(_.range(1, 32), function(date) {\n      return '<option value=\"'+date+'\">' + date + '</option>';\n    });\n\n    var monthsOptions = _.map(_.range(0, 12), function(month) {\n      var value = (options.showMonthNames)\n          ? options.monthNames[month]\n          : (month + 1);\n\n      return '<option value=\"'+month+'\">' + value + '</option>';\n    });\n\n    var yearRange = (schema.yearStart < schema.yearEnd)\n      ? _.range(schema.yearStart, schema.yearEnd + 1)\n      : _.range(schema.yearStart, schema.yearEnd - 1, -1);\n\n    var yearsOptions = _.map(yearRange, function(year) {\n      return '<option value=\"'+year+'\">' + year + '</option>';\n    });\n\n    //Render the selects\n    var $el = $($.trim(this.template({\n      dates: datesOptions.join(''),\n      months: monthsOptions.join(''),\n      years: yearsOptions.join('')\n    })));\n\n    //Store references to selects\n    this.$date = $el.find('[data-type=\"date\"]');\n    this.$month = $el.find('[data-type=\"month\"]');\n    this.$year = $el.find('[data-type=\"year\"]');\n\n    //Create the hidden field to store values in case POSTed to server\n    this.$hidden = $('<input type=\"hidden\" name=\"'+this.key+'\" />');\n    $el.append(this.$hidden);\n\n    //Set value on this and hidden field\n    this.setValue(this.value);\n\n    //Remove the wrapper tag\n    this.setElement($el);\n    this.$el.attr('id', this.id);\n    this.$el.attr('name', this.getName());\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  },\n\n  /**\n   * @return {Date}   Selected date\n   */\n  getValue: function() {\n    var year = this.$year.val(),\n        month = this.$month.val(),\n        date = this.$date.val();\n\n    if (!year || !month || !date) return null;\n\n    return new Date(year, month, date);\n  },\n\n  /**\n   * @param {Date} date\n   */\n  setValue: function(date) {\n    this.$date.val(date.getDate());\n    this.$month.val(date.getMonth());\n    this.$year.val(date.getFullYear());\n\n    this.updateHidden();\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$('select').first().focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$('select:focus').blur();\n  },\n\n  /**\n   * Update the hidden input which is maintained for when submitting a form\n   * via a normal browser POST\n   */\n  updateHidden: function() {\n    var val = this.getValue();\n\n    if (_.isDate(val)) val = val.toISOString();\n\n    this.$hidden.val(val);\n  }\n\n}, {\n  //STATICS\n  template: _.template('\\\n    <div>\\\n      <select data-type=\"date\"><%= dates %></select>\\\n      <select data-type=\"month\"><%= months %></select>\\\n      <select data-type=\"year\"><%= years %></select>\\\n    </div>\\\n  ', null, Form.templateSettings),\n\n  //Whether to show month names instead of numbers\n  showMonthNames: true,\n\n  //Month names to use if showMonthNames is true\n  //Replace for localisation, e.g. Form.editors.Date.monthNames = ['Janvier', 'Fevrier'...]\n  monthNames: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December']\n});\n\n/**\n * DateTime editor\n *\n * @param {Editor} [options.DateEditor]           Date editor view to use (not definition)\n * @param {Number} [options.schema.minsInterval]  Interval between minutes. Default: 15\n */\nForm.editors.DateTime = Form.editors.Base.extend({\n\n  events: {\n    'change select':  function() {\n      this.updateHidden();\n      this.trigger('change', this);\n    },\n    'focus select':   function() {\n      if (this.hasFocus) return;\n      this.trigger('focus', this);\n    },\n    'blur select':    function() {\n      if (!this.hasFocus) return;\n      var self = this;\n      setTimeout(function() {\n        if (self.$('select:focus')[0]) return;\n        self.trigger('blur', self);\n      }, 0);\n    }\n  },\n\n  initialize: function(options) {\n    options = options || {};\n\n    Form.editors.Base.prototype.initialize.call(this, options);\n\n    //Option defaults\n    this.options = _.extend({\n      DateEditor: Form.editors.DateTime.DateEditor\n    }, options);\n\n    //Schema defaults\n    this.schema = _.extend({\n      minsInterval: 15\n    }, options.schema || {});\n\n    //Create embedded date editor\n    this.dateEditor = new this.options.DateEditor(options);\n\n    this.value = this.dateEditor.value;\n\n    //Template\n    this.template = options.template || this.constructor.template;\n  },\n\n  render: function() {\n    function pad(n) {\n      return n < 10 ? '0' + n : n;\n    }\n\n    var schema = this.schema;\n\n    //Create options\n    var hoursOptions = _.map(_.range(0, 24), function(hour) {\n      return '<option value=\"'+hour+'\">' + pad(hour) + '</option>';\n    });\n\n    var minsOptions = _.map(_.range(0, 60, schema.minsInterval), function(min) {\n      return '<option value=\"'+min+'\">' + pad(min) + '</option>';\n    });\n\n    //Render time selects\n    var $el = $($.trim(this.template({\n      hours: hoursOptions.join(),\n      mins: minsOptions.join()\n    })));\n\n    //Include the date editor\n    $el.find('[data-date]').append(this.dateEditor.render().el);\n\n    //Store references to selects\n    this.$hour = $el.find('select[data-type=\"hour\"]');\n    this.$min = $el.find('select[data-type=\"min\"]');\n\n    //Get the hidden date field to store values in case POSTed to server\n    this.$hidden = $el.find('input[type=\"hidden\"]');\n\n    //Set time\n    this.setValue(this.value);\n\n    this.setElement($el);\n    this.$el.attr('id', this.id);\n    this.$el.attr('name', this.getName());\n\n    if (this.hasFocus) this.trigger('blur', this);\n\n    return this;\n  },\n\n  /**\n   * @return {Date}   Selected datetime\n   */\n  getValue: function() {\n    var date = this.dateEditor.getValue();\n\n    var hour = this.$hour.val(),\n        min = this.$min.val();\n\n    if (!date || !hour || !min) return null;\n\n    date.setHours(hour);\n    date.setMinutes(min);\n\n    return date;\n  },\n\n  /**\n   * @param {Date}\n   */\n  setValue: function(date) {\n    if (!_.isDate(date)) date = new Date(date);\n\n    this.dateEditor.setValue(date);\n\n    this.$hour.val(date.getHours());\n    this.$min.val(date.getMinutes());\n\n    this.updateHidden();\n  },\n\n  focus: function() {\n    if (this.hasFocus) return;\n\n    this.$('select').first().focus();\n  },\n\n  blur: function() {\n    if (!this.hasFocus) return;\n\n    this.$('select:focus').blur();\n  },\n\n  /**\n   * Update the hidden input which is maintained for when submitting a form\n   * via a normal browser POST\n   */\n  updateHidden: function() {\n    var val = this.getValue();\n    if (_.isDate(val)) val = val.toISOString();\n\n    this.$hidden.val(val);\n  },\n\n  /**\n   * Remove the Date editor before removing self\n   */\n  remove: function() {\n    this.dateEditor.remove();\n\n    Form.editors.Base.prototype.remove.call(this);\n  }\n\n}, {\n  //STATICS\n  template: _.template('\\\n    <div class=\"bbf-datetime\">\\\n      <div class=\"bbf-date-container\" data-date></div>\\\n      <select data-type=\"hour\"><%= hours %></select>\\\n      :\\\n      <select data-type=\"min\"><%= mins %></select>\\\n    </div>\\\n  ', null, Form.templateSettings),\n\n  //The date editor to use (constructor function, not instance)\n  DateEditor: Form.editors.Date\n});\n\n\n\n  //Metadata\n  Form.VERSION = '0.13.0';\n\n\n  //Exports\n  Backbone.Form = Form;\n  if (typeof exports !== 'undefined') exports = Form;\n\n})(window || global || this);\n","var Location = Backbone.Model.extend({\n\n  idAttribute: '_id',\n\n  toString: function(){\n    return this.get('name');\n  }\n\n});\n","var Request = Backbone.Model.extend({\n\n  schema: {\n    type: {\n      type: 'Select',\n      options: function (callback) {\n        var types = new Types;\n        types.fetch({\n          success: function (coll, models) {\n            callback(types);\n          }\n        });\n      }\n    },\n    location: {\n      type: 'Select',\n      options: function (callback) {\n        var locations = new Locations;\n        locations.fetch({\n          success: function (coll, models) {\n            callback(locations);\n          }\n        });\n      },\n      validators: ['required']\n    },\n    description: {\n      validators: ['required']\n    },\n    urgent: {\n      type: 'Radio',\n      options: {\n        false: 'No',\n        true: 'Yes'\n      }\n    },\n    created: {\n      type: 'Hidden'\n    }\n  },\n\n  idAttribute: '_id',\n  url: '/request',\n\n  initialize: function () {\n    this.on('change', function (model) {\n      model.save();\n    });\n  }\n\n});\n","var Role = Backbone.Model.extend({\n\n  toString: function(){\n    return this.get('name');\n  }\n\n});\n","var Type = Backbone.Model.extend({\n\n  idAttribute: '_id',\n\n  toString: function(){\n    return this.get('name');\n  }\n\n});\n","var User = Backbone.Model.extend({\n\n  // schema: {\n  //   name: {\n  //     validators: ['required']\n  //   },\n  //   email: {\n  //     dataType: 'email',\n  //     validators: ['required', 'email']\n  //   },\n  //   phone: {\n  //     dataType: 'tel'\n  //   },\n  //   role: {\n  //     type: 'Select',\n  //     options: new Roles()\n  //   }\n  // },\n\n  schema: {\n    username: {\n      validators: ['required']\n    }\n  },\n\n  urlRoot: 'user',\n  idAttribute: '_id',\n  synced: false,\n\n  initialize: function () {\n    var self = this;\n    // get user from backend\n    this.fetch({\n      success: function (model) {\n        self.set(model.attributes);\n        self.synced = true;\n      },\n      error: function () {\n        self.synced = true;\n        asapp.redirect('/login.html');\n      }\n    });\n  },\n\n  isSynced: function () {\n    return this.synced;\n  },\n\n  login: function (callback) {\n    var self = this;\n    this.save(null, {\n      success: function (model) {\n        if (model.id) {\n          self.set(model.attributes);\n          callback();\n        } else {\n          callback('login failed');\n        }\n      },\n      error: function () {\n        console.error('login error');\n      }\n    });\n  }\n\n});\n","\nvar Locations = Backbone.Collection.extend({\n\n  model: Location,\n  url: '/locations',\n\n  initialize: function () {\n    this.fetch();\n  }\n\n});\n","\nvar Requests = Backbone.Collection.extend({\n\n  model: Request,\n  url: '/requests',\n  el: '#page-monitor',\n\n  initialize: function () {\n    var self = this;\n    this.on('add', function (model) {\n      var view = new MonitorView({\n        model: model,\n        collection: self\n      });\n      $(self.el).find('tbody').append(view.render().el);\n    });\n  }\n\n});\n","\nvar Roles = Backbone.Collection.extend({\n\n  model: Role,\n  \n  initialize: function(){\n    this.add([\n      {\n        id: 1,\n        name: 'Room Manager'\n      },\n      {\n        id: 2,\n        name: 'AV'\n      }\n    ]);\n  }\n  \n});\n","\nvar Types = Backbone.Collection.extend({\n\n  model: Type,\n  url: '/types',\n\n});\n","var LoginView = Backbone.View.extend({\n\n  el: '#page-login',\n\n  render: function(){\n\n    var form = new Backbone.Form({\n      model: asapp.user\n    }).render();\n\n    form.$el.append('<input type=\"submit\" value=\"Login\">');\n\n    this.$el.find('.bbform').html(form.el);\n\n    form.$el.submit(function (event) {\n      event.preventDefault();\n      var err = form.commit({\n        validate: true\n      });\n      if (err) {\n        console.error(err);\n      } else {\n        asapp.user.login(function (err) {\n          if (err) {\n            console.error(err);\n            return;\n          }\n          asapp.redirect('request.html');\n        });\n      }\n    });\n\n    return this;\n\n  }\n\n});\n","var MonitorView = Backbone.View.extend({\n\n  tagName: 'tr',\n  // template: _.template('<th>09:25</th><td><%- location %></td><td><%- name %></td><td><%- problem %></td><td><%- description %></td><td></td>'),\n  template: _.template('<td><%- new Date(created).toLocaleDateString() %> <%- new Date(created).toLocaleTimeString() %></td><td><%- location.name %></td><td><%- user.username %></td><td><%- type.name %></td><td><%- description %></td><td><%- status.name %></td>'),\n\n  render: function () {\n    this.$el.html(this.template(this.model.attributes));\n    return this;\n  }\n\n});\n","var ProfileView = Backbone.View.extend({\n  \n  el: '#form-profile',\n\n  render: function(){\n\n    var form = new Backbone.Form({\n      model: asapp.user\n    }).render();\n    \n    form.$el.append('<input type=\"submit\" value=\"Save\">');\n\n    this.$el.html(form.el);\n\n    form.$el.submit(function (event) {\n      event.preventDefault();\n      var err = form.commit({\n        validate: true\n      });\n      if (err) {\n        // console.error(err);\n      } else {\n        console.log(asapp.user.attributes);\n      }\n    });\n\n    return this;\n\n  }\n\n});\n","var RequestView = Backbone.View.extend({\n\n  el: '#page-request',\n\n  render: function () {\n\n    var self = this;\n\n    var form = new Backbone.Form({\n      model: self.model\n    }).render();\n\n    form.$el.append('<input type=\"submit\" value=\"Save\">');\n    this.$el.find('.bbform').html(form.el);\n\n    form.$el.submit(function (event) {\n      event.preventDefault();\n      var err = form.commit({\n        validate: true\n      });\n      if (err) {\n        // console.error(err);\n      } else {\n        self.collection.add(self.model);\n      }\n    });\n\n    return this;\n\n  }\n\n});\n","\n// when jQuery Mobile has finished loading\njQuery(document).on('mobileinit', function(){\n\n  console.log('JQM ready');\n\n  $(document).on('pagecontainerbeforeshow', function (event) {\n    if (asapp.user.isSynced() && !asapp.user.id && document.location.pathname !== '/login.html') {\n      event.preventDefault();\n      asapp.redirect('/login.html');\n    }\n  });\n\n  $(document).on('pagecontainershow', function () {\n    // notify Backbone about our whereabouts\n    asapp.router.navigate(document.location.pathname, {\n      trigger: true\n    });\n  });\n\n});\n\n\n// global\nvar asapp = {\n\n  redirect: function (page) {\n    $(':mobile-pagecontainer').pagecontainer('change', page);\n  }\n\n};\n\n// when DOM has finished loading\njQuery(function ($) {\n\n  console.log('DOM ready');\n\n  Backbone.$ = $;\n\n  asapp.user = new User();\n  asapp.requests = new Requests();\n  asapp.router = new Router();\n\n  Backbone.history.start({\n    pushState: true\n  });\n\n});\n","\nvar Router = Backbone.Router.extend({\n\n  routes: {\n    'login.html': 'login',\n    'request.html': 'request',\n    'monitor.html': 'monitor',\n    'settings.html': 'settings'\n  },\n\n  initialize: function () {\n    this.bind('all', function (route) {\n      // after BB view rendering, rerender JQM\n      $(':mobile-pagecontainer').pagecontainer('getActivePage').trigger('create');\n    });\n  },\n\n  login: function(){\n    (new LoginView()).render();\n  },\n\n  request: function () {\n    var view = new RequestView({\n      collection: asapp.requests,\n      model: new asapp.requests.model()\n    });\n    view.render();\n  },\n\n  monitor: function(){\n    asapp.requests.fetch();\n  },\n\n  settings: function(){\n    var view = new ProfileView();\n    view.render();\n  }\n\n});\n"]}